"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[7599],{85688:function(t,e,n){var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.TtWid=void 0;var i=function(t){function e(e){return e.needFid=!1,t.call(this,e)||this}return o(e,t),e}(n(99192).TtWidCore);e.TtWid=i},99192:function(t,e,n){var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.TtWidCore=void 0;var a=s(n(65738)),u=n(62412),c={timeout:3e3,withCredentials:!0,headers:{"content-type":"application/x-www-form-urlencoded"}},l=function(){function t(t,e){void 0===e&&(e=null),this.host="",void 0===t.union&&(t.union=!0),void 0===t.needFid&&(t.needFid=!0),t.host&&(this.host=t.host),this.firebaseClient=e,t&&t.headers&&(t.headers["content-type"]="application/x-www-form-urlencoded",c.headers=t.headers,delete t.headers),t&&t.timeout&&(c.timeout=t.timeout,delete t.timeout),this.options=t}return Object.defineProperty(t.prototype,"setFirebaseClient",{set:function(t){this.firebaseClient=t},enumerable:!1,configurable:!0}),t.prototype.checkWebId=function(t){var e,n;return o(this,void 0,void 0,(function(){var o,s,l,d,f,h,p,_,v,b;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,12,,13]),o=t||u.CookieReadConfigEnum.COOKIE_READ_DEFAULT,s="",this.options.needFid?(l=null===(e=this.firebaseClient)||void 0===e?void 0:e.getfid)?[3,2]:[4,null===(n=this.firebaseClient)||void 0===n?void 0:n.getInstanceId()]:[3,3];case 1:l=i.sent(),i.label=2;case 2:s=l||"",i.label=3;case 3:return[4,a.default.post("".concat(this.host,"/ttwid/check/"),r(r({},this.options),{fid:s,migrate_priority:o}),c)];case 4:if(d=i.sent(),f=d.data,p=(h=void 0===f?null:f)||d,!(h&&h.status_code>1001))return[3,11];_=h.migrate_info,i.label=5;case 5:return i.trys.push([5,10,,11]),this.options.union?[4,this.registerUnionWebId({migrate_info:_,fid:s})]:[3,7];case 6:return v=i.sent(),p=v,[3,9];case 7:return[4,this.registerOpenWebId({migrate_info:_,fid:s})];case 8:v=i.sent(),p=v,i.label=9;case 9:return[3,11];case 10:return b=i.sent(),console.error("ttwid register error",b,b.message),[2,h||d];case 11:return[2,p];case 12:throw i.sent();case 13:return[2]}}))}))},t.prototype.checkWebIdFromTea=function(){return o(this,void 0,void 0,(function(){var t,e,n,r,o;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),t=localStorage&&localStorage.getItem("__tea_cache_tokens_".concat(this.options.aid))||"",e=t&&JSON.parse(t)||{},n=e.web_id,(r=void 0===n?"":n)&&(o=new Date(Date.now()+864e5).toUTCString(),document.cookie="_tea_web_id=".concat(r,"; expires=").concat(o,"; path=/;")),[4,this.checkWebId(u.CookieReadConfigEnum.COOKIE_READ_TEA_PRIOR)];case 1:return[2,i.sent()];case 2:throw i.sent();case 3:return[2]}}))}))},t.prototype.registerUnionWebId=function(t,e){return o(this,void 0,void 0,(function(){var n,o,s,u,l,d,f,h,p,_,v,b;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,6,,7]),n=this.options,o=n.unionHost,s=void 0===o?"":o,u=n.cbUrlProtocol,l=void 0===u?"":u,[4,a.default.post("".concat(s,"/ttwid/union/register/"),r(r({},this.options),t),c)];case 1:if(d=i.sent(),f=d.data,!(h=void 0===f?null:f)||!h.redirect_url)return[3,5];i.label=2;case 2:return i.trys.push([2,4,,5]),p=h.redirect_url,l&&p&&(p=p.replace(/^https?/,l)),[4,a.default.get(p,c)];case 3:return _=i.sent(),e?[2,e(null,_.data||{})]:[2,_.data||{}];case 4:return v=i.sent(),e?[2,e(v,h||{})]:[2,h];case 5:if(e)return[2,e(new Error("ttwid union register error"))];throw new Error("ttwid union register error");case 6:if(b=i.sent(),e)return[2,e(b)];throw b;case 7:return[2]}}))}))},t.prototype.registerOpenWebId=function(t){return o(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,a.default.post("".concat(this.host,"/ttwid/register/"),r(r({},this.options),t),c)];case 1:return[2,e.sent().data];case 2:throw e.sent();case 3:return[2]}}))}))},t.prototype.getInstanceId=function(){var t;return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,(null===(t=this.firebaseClient)||void 0===t?void 0:t.getInstanceId())||""]}))}))},t.prototype.deleteInstallation=function(){var t;return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,null===(t=this.firebaseClient)||void 0===t?void 0:t.deleteInstallation()]}))}))},t}();e.TtWidCore=l},62412:(t,e)=>{var n;Object.defineProperty(e,"__esModule",{value:!0}),e.CookieReadConfigEnum=void 0,(n=e.CookieReadConfigEnum||(e.CookieReadConfigEnum={}))[n.COOKIE_READ_DEFAULT=0]="COOKIE_READ_DEFAULT",n[n.COOKIE_READ_TEA_PRIOR=1]="COOKIE_READ_TEA_PRIOR"}}]);