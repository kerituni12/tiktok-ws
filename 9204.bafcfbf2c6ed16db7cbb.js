"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[9204],{53701:(e,t,r)=>{r.d(t,{a:()=>a,k:()=>i});var n=r(93608);const i=e=>{n.f.event("video_data_size",e)},a=e=>{n.f.event("basic_player_cdn_cost",e)}},96462:(e,t,r)=>{r.d(t,{bp:()=>g,OK:()=>c,O5:()=>h,he:()=>f,sK:()=>b,SO:()=>k,vb:()=>v,Ck:()=>P,rX:()=>p,vk:()=>C});var n,i,a,o,l,s,d=r(44137);!function(e){e[e.HaveNothing=0]="HaveNothing",e[e.HaveMetaData=1]="HaveMetaData",e[e.HaveCurrentData=2]="HaveCurrentData",e[e.HaveFutureData=3]="HaveFutureData",e[e.HaveEnoughData=4]="HaveEnoughData"}(n||(n={})),function(e){e[e.Public=0]="Public",e[e.Self=1]="Self",e[e.Friend=2]="Friend"}(i||(i={})),function(e){e[e.PlayStop=0]="PlayStop",e[e.ResumePlaying=1]="ResumePlaying"}(a||(a={})),function(e){e.FeedRequest="feed_request",e.FeedRequestResponse="feed_request_response"}(o||(o={})),function(e){e.LoadMore="load_more"}(l||(l={})),function(e){e.PlayQuality="video_play_quality",e.PlayEnded="video_play_end",e.PlayFailed="video_play_failed",e.BlockStart="video_block_start",e.Block="video_block",e.Request="video_request",e.RequestResponse="video_request_response",e.FirstFrame="first_feed_show_time"}(s||(s={}));const u={0:"one_column",1:"three_column",2:"browser_mode",3:"swiper_mode",4:"video_detail",6:"pip",5:"fullscreen",7:"creator_tab",8:"mini_player",9:"immersive_player"},c=e=>e&&Array.isArray(e)?e.map((e=>{var t;return null!==(t=e.GearName)&&void 0!==t?t:"unknown"})):null,p=e=>e&&Array.isArray(e)?e.map((e=>`${e.QualityType}:${e.Bitrate}`)):null,v=()=>({cpu_core:"undefined"==typeof navigator?0:navigator.hardwareConcurrency,memory_size:"undefined"==typeof navigator?0:navigator.deviceMemory,HEVC_supported:(0,d.X)()?1:0}),h=e=>void 0!==e&&e.length>0?1e3*Math.round(e.end(0)-e.start(0)):0,y=(e,t)=>e?2:t?1:0,m=(e="")=>{if(!e)return"";const t=e.match(/https?:\/\/([^/]+)\//i);let r="";return(null==t?void 0:t[1])&&(r=t[1]),r},g=e=>{if(!e||"string"!=typeof e)return 0;let t=0;try{const r=new RegExp("(\\?|&)expire=([^&]*)(&|$)"),n=e.match(r);if(null!==n)t=parseInt(n[2],10);else{const r=e.split("/");r.length>5&&8===r[4].length&&(t=parseInt(r[4],16))}return t>0?t<parseInt(String((new Date).getTime()/1e3),10)?1:2:0}catch(e){return 0}},f=e=>{var t;const{id:r,authorId:n,playMode:i,forFriend:a=!1,secret:o=!1,play_url:l,awemeType:s,picCnt:d,playlist_id:c="",popup_type:p="",size:v=-1}=e;return{group_id:r,author_id:n,play_mode:null!==(t=u[i])&&void 0!==t?t:"others",logo_type:"",item_status:y(a,o),play_url:l,host:m(l),aweme_type:null!=s?s:0,pic_cnt:d,playlist_id:c,popup_type:p,size:v}},_=(e,t)=>{const r=(e=>!e||/^(\d)*p$/i.test(`${e}`))(t);return r?e&&t?`${e}_${t}`:`unknownQuality_fromServer_${e}_${t}`:t},b=e=>{const{bitrate:t=-1,format:r="",codecType:n="",encodedType:i="",videoQuality:a="",definition:o="",encodeUserTag:l="",originalDefinition:s=""}=e;return{video_bitrate:t,video_format:r,codec_format:n,encoded_type:i,bitrate_quality:a,video_quality:String(_(a,o)),video_encodeUserTag:l,original_definition:s}},k=e=>{const{preload_size:t=-1,preload_time:r=-1,video_type:n="mp4",player_type:i="defaultPlayer"}=e;return{preload_size:t,preload_time:r,player_type:i,video_type:n}},P=e=>{const{totalWatchCount:t,foruWatchCount:r}=e;return{watch_count_total:t,watch_count_foru:r}};let S="-1";const T=["avc1.42E01E, mp4a.40.2","avc1.58A01E, mp4a.40.2","avc1.4D401E, mp4a.40.2","avc1.64001E, mp4a.40.2","avc1.42E01E","mp4v.20.8","avc1.42E01E, mp4a.40.2","avc1.58A01E, mp4a.40.2","avc1.4D401E, mp4a.40.2","avc1.64001E, mp4a.40.2","mp4v.20.8, mp4a.40.2","mp4v.20.240, mp4a.40.2"];function C(){try{const e={isSupport:!1,mime:""};if("undefined"==typeof document)return"0";if("-1"!==S&&"-2"!==S)return S;let t=document.createElement("video");"function"==typeof t.canPlayType&&T.map((r=>{"probably"===(null==t?void 0:t.canPlayType(`video/mp4; codecs="${r}"`))&&(e.isSupport=!0,e.mime+=`||${r}`)}));const r=e.isSupport?"1":"0";return S=r,t=null,r}catch(e){return"-2"}}},96959:(e,t,r)=>{r.d(t,{Cd:()=>c,re:()=>p});var n=r(93608),i=r(38739),a=r(96462);const o={isPause:null,isVideoLoaded:!1,isFirstPlayReported:!1,isFirstPlayEndReported:!1,isInPlaybackStage:!1,triggerPlayTimestamp:0,firstTriggerPlayTimestamp:0,loadStartTimestamp:0,blockStartTimestamp:0,blockStartProgress:0,playingStartTimestamp:0,pauseStartTimestamp:0,totalPauseDuration:0,volume:0,muted:!0,mutedStateChange:!1,videoSourceLoadTime:0,cacheDuration:0,cacheSize:0,dataPlayerType:0,playSize:0,cdnSizeVideo:0,frameInfo:{drop_frame:0,total_play_frame:-1,drop_frame_rate:-1,drop_frame_duration:0}},l={currentSrc:"",duration:0,error:null,currentTime:0,readyState:0,buffered:{start:()=>0,end:()=>0,length:0},volume:0,muted:!0,mutedStateChange:!1};let s=1,d="",u="";const c=e=>{d=e};class p{constructor(){this.innerStates=Object.assign({},o),this.innerVideoAttributeStates=Object.assign({},l),this.isFirstFrameReported=!1,this.resetState=()=>{this.innerStates=Object.assign({},o),d="",this.isFirstFrameReported=!1,this.innerVideoAttributeStates=Object.assign({},l)},this.resetStateWhenSlideChange=()=>{this.innerStates=Object.assign({},o),this.innerVideoAttributeStates=Object.assign({},l)},this.reset=(e,t)=>{d!==e&&(this.playEndEvent(t),this.blockEndEvent(Object.assign(Object.assign({},t),{endType:0})),this.innerStates=Object.assign({},o))},this.resetWhenSlideChange=e=>{this.playEndEvent(Object.assign(Object.assign({},e),this.innerVideoAttributeStates)),this.blockEndEvent(Object.assign(Object.assign(Object.assign({},e),{endType:0}),this.innerVideoAttributeStates)),this.innerVideoAttributeStates=Object.assign({},l)},this.updateFrameInfo=e=>{this.innerStates.frameInfo=e},this.handlePlay=()=>{this.innerStates.triggerPlayTimestamp=Date.now();const{firstTriggerPlayTimestamp:e}=this.innerStates;e||(this.innerStates.firstTriggerPlayTimestamp=Date.now())},this.handlePause=e=>{const{id:t}=e,{playingStartTimestamp:r,isPause:n}=this.innerStates;t&&r&&!n&&(this.innerStates.pauseStartTimestamp=Date.now()),this.innerStates.isPause=!0},this.handleTimeUpdate=e=>{const{triggerPlayTimestamp:t,isFirstPlayReported:r,pauseStartTimestamp:i,videoSourceLoadTime:o,loadStartTimestamp:l}=this.innerStates,{currentTime:s=0,duration:c=0,codecType:p,volume:v=0,muted:h=!0,bitrateInfo:y,buffered:m,currentSrc:g,error:f,readyState:_}=e;if(this.innerVideoAttributeStates.duration=c,this.innerVideoAttributeStates.currentTime=s,this.innerVideoAttributeStates.buffered=m,this.innerVideoAttributeStates.currentSrc=g,this.innerVideoAttributeStates.error=f,this.innerVideoAttributeStates.readyState=_,!(s<=0)){if(!r&&0!==t){const r=Date.now()-t-1e3*s,i=Date.now()-l,m=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(0,a.he)(e)),(0,a.sK)(e)),(0,a.SO)(e)),(0,a.Ck)(e)),(0,a.vb)()),{duration:r>0?Math.round(r):0,video_duration:Math.round(1e3*c),is_bytevc1:(null!=p?p:"").indexOf("h265")>-1?1:0,muted:h?1:0,bitrate_set:(0,a.OK)(y),quality_bitrate:(0,a.rX)(y),duration_from_load:Math.round(i),duration_with_load:Math.round(r+o),is_same:d===u?1:0});n.f.event("video_play_quality",m),u=d,this.innerStates.isFirstPlayReported=!0,this.innerStates.playingStartTimestamp=Date.now(),this.innerStates.volume=v,this.innerStates.muted=h}if(this.innerStates.mutedStateChange=this.innerStates.mutedStateChange||this.innerStates.muted!==h,this.innerStates.muted=h,!this.isFirstFrameReported&&performance&&this.firstFrameEvent(),this.innerStates.isPause){const e=i?Date.now()-i:0;this.innerStates.totalPauseDuration+=e}this.blockEndEvent(Object.assign(Object.assign({},e),{endType:1})),this.innerStates.isInPlaybackStage=!0,this.innerStates.isPause=!1}},this.handleEnded=()=>{this.innerStates.isInPlaybackStage=!1},this.handleError=e=>{const{isVideoLoaded:t,isInPlaybackStage:r}=this.innerStates,{error:i,codecType:o="",duration:l,play_url:s}=e,{code:d=0,message:u=""}=null!=i?i:{},c=s?(0,a.bp)(s):-1,p=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(0,a.he)(e)),(0,a.sK)(e)),(0,a.Ck)(e)),(0,a.vb)()),{error_code:String(d),error_info:u,is_bytevc1:o.indexOf("h265")>-1?1:0,duration:null!=l?l:0,isExpired:c,isSupportMP4:(0,a.vk)(),is_before:t&&r?0:1});n.f.event("video_play_failed",p)},this.handleWaiting=e=>{const{currentTime:t=0,duration:r=0}=e,{isInPlaybackStage:i,blockStartTimestamp:o,isPause:l}=this.innerStates;if(0!==t&&t!==r&&i&&!1===l&&0===o){const r=Object.assign(Object.assign(Object.assign({},(0,a.he)(e)),(0,a.Ck)(e)),(0,a.vb)());n.f.event("video_block_start",r),this.innerStates.blockStartTimestamp=Date.now(),this.innerStates.blockStartProgress=1e3*t}},this.handleLoadStart=e=>{const t=Object.assign(Object.assign(Object.assign(Object.assign({},(0,a.he)(e)),(0,a.Ck)(e)),(0,a.vb)()),(0,i.Mp)(e));n.f.event("video_request",t),this.innerStates.loadStartTimestamp=Date.now()},this.handleLoadedData=e=>{this.responseEvent(e),this.innerStates.isVideoLoaded=!0},this.firstFrameEvent=()=>{const e=performance.timeOrigin,t={feed_total:e?Math.round(Date.now()-e):-1};n.f.event("first_feed_show_time",t),this.isFirstFrameReported=!0}}updateNativePlayerCDNCache(e,t){this.innerStates.cacheDuration=e,this.innerStates.cacheSize=t}msePlayerCacheUpdate(e){void 0!==e&&(this.innerStates.cdnSizeVideo+=e)}updatePlayerType(e){this.innerStates.dataPlayerType=e}blockEndEvent(e){const{currentTime:t=0,codecType:r,endType:i,should_filter:o=!1,droppedRate:l}=e,{blockStartTimestamp:s,blockStartProgress:d,isInPlaybackStage:u,isVideoLoaded:c}=this.innerStates;if(c&&u&&0!==s&&(1e3*t!==d||0===i)){const u=Date.now()-s-(1e3*t-d),c=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(0,a.he)(e)),(0,a.sK)(e)),(0,a.SO)(e)),(0,a.vb)()),{duration:u>=0?Math.round(u):0,is_bytevc1:(null!=r?r:"").indexOf("h265")>-1?1:0,end_type:i,position:Math.round(1e3*t),should_filter:o?"1":"0",droppedRate:l});n.f.event("video_block",c),this.innerStates.blockStartTimestamp=0}}responseEvent(e){const{loadStartTimestamp:t}=this.innerStates,{error:r,videoQuality:o,definition:l,play_url:s,codecType:d}=e,u=s?(0,a.bp)(s):-1,c=Date.now()-t;this.innerStates.videoSourceLoadTime=c;const p=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(0,a.he)(e)),(0,a.vb)()),(0,a.Ck)(e)),{error_code:String(null==r?void 0:r.code),duration:c,is_success:r?"0":"1",video_quality:o&&l?`${o}_${l}`:""}),(0,i.Mp)(e)),{isExpired:u,isSupportMP4:(0,a.vk)(),is_bytevc1:(null!=d?d:"").indexOf("h265")>-1?1:0});n.f.event("video_request_response",p)}playEndEvent(e){const{isFirstPlayReported:t,isFirstPlayEndReported:r,playingStartTimestamp:i,totalPauseDuration:o,firstTriggerPlayTimestamp:l,volume:d,frameInfo:u}=this.innerStates,{bitrate:c}=e;if(!r&&i){const{buffered:r,duration:p=0,currentTime:v=0,readyState:h,volume:y=0,muted:m,codecType:g}=e,f=i?Date.now()-i-o:0,_=c?c/8*((f>1e3*p?1e3*p:f)/1e3):-1,b=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(0,a.he)(e)),(0,a.sK)(e)),(0,a.SO)(e)),(0,a.vb)()),{is_success:t?"1":"0",video_duration:isNaN(p)?0:Math.round(1e3*p),play_duration:Math.round(1e3*v),buffering:(null!=h?h:0)<=2?1:0,duration:f>=0?Math.round(f):0,wait_duration:i>0?0:Date.now()-l,cur_cache_duration:(0,a.O5)(r),local_time_ms:Date.now(),volume_level:Number(y.toFixed(4)),volume_change:t?Number((y-d).toFixed(4)):0,muted:m?1:0,click_mute:this.innerStates.mutedStateChange?m?2:1:0,session_order:s++,play_size:Math.round(_),data_player_type:this.innerStates.dataPlayerType,cache_size:1===this.innerStates.dataPlayerType?-10:Math.round(this.innerStates.cacheSize),cache_duration:1===this.innerStates.dataPlayerType?-10:Math.round(this.innerStates.cacheDuration),cdn_size_video:this.innerStates.cdnSizeVideo}),u),{is_bytevc1:(null!=g?g:"").indexOf("h265")>-1?1:0});n.f.event("video_play_end",b),this.innerStates.isFirstPlayEndReported=!0}}}},92701:(e,t,r)=>{r.d(t,{Hg:()=>n,cU:()=>i});const n=({hevcTest:e,bitrateInfo:t,videoOrder:r,downgradeUrl:n,backupDomain:i=!1,codec:a="h264"})=>{var o;const{h264:l=[],h265:s=[]}=((e,t)=>{const r={};let n=e;return t&&(n=((e,t)=>{try{const r=(t,r)=>t[e[0].property]!==r[e[0].property]?"Bitrate"===e[0].property?"desc"===e[0].order?r.Bitrate-t.Bitrate:t.Bitrate-r.Bitrate:e[0].detail.indexOf(t[e[0].property])>=0&&e[0].detail.indexOf(r[e[0].property])>=0?e[0].detail.indexOf(t[e[0].property])-e[0].detail.indexOf(r[e[0].property]):e[0].detail.indexOf(t[e[0].property])>=0?-1:1:t[e[1].property]!==r[e[1].property]?"Bitrate"===e[1].property?"desc"===e[1].order?r.Bitrate-t.Bitrate:t.Bitrate-r.Bitrate:e[1].detail.indexOf(t[e[1].property])>=0&&e[1].detail.indexOf(r[e[1].property])>=0?e[1].detail.indexOf(t[e[1].property])-e[1].detail.indexOf(r[e[1].property]):e[1].detail.indexOf(t[e[1].property])>=0?-1:1:1;return t&&t.length>0?[...t].sort(r):void 0}catch(e){return void console.error("bitrateInfo is empty")}})(t,e)),n?(n.forEach((e=>{let{CodecType:t}=e;t.startsWith("h265")&&(t="h265"),r[t]||(r[t]=[]),r[t].push(e)})),r):r})(t,r),{qualityType:d=20,hevcQualityType:u=28}=e;let c=null,p="",v="h264";if(function(e,t,r){return e.length>0&&t&&"h265"===r}(s,e.open,a)&&(c=(({hevcQualityType:e,h265:t})=>{if(t){const r=e||28;t.sort(((e,t)=>e.Bitrate-t.Bitrate));const n=t.find((e=>e.QualityType===r));if(n)return n;if(t.length>0)return t[0]}return null})({hevcQualityType:u,h265:s})),c?v="h265":c=(({qualityType:e,h264:t})=>{if(t&&t.length>0){const r=e||20;t.sort(((e,t)=>e.Bitrate-t.Bitrate));let n=t.find((e=>e.QualityType===r));return n||(n=t[0]),n}return null})({qualityType:d,h264:l}),c){const e=(null===(o=c.PlayAddr)||void 0===o?void 0:o.UrlList)||[];if(e.length>0)return p=e.length>1&&i?e[1]:e[0],{src:p,bitrate:c.Bitrate||0,definition:c.GearName||"",codecType:v,finalBitrateInfo:[c]}}return{bitrate:0,definition:"",src:null!=n?n:"",codecType:"h264",finalBitrateInfo:void 0}},i=e=>{const t=[],r=[];return e&&e.forEach((e=>{const n={qualityType:e.QualityType,gearName:e.GearName};e.CodecType.indexOf("h265")>=0?r.push(n):t.push(n)})),{h264Set:t,h265Set:r}}},91021:(e,t,r)=>{r.d(t,{Ah:()=>p,JX:()=>o,ZQ:()=>c,as:()=>l});var n=r(58632),i=r(7672);let a=3,o=class{constructor(){this.preloadQueue=[],this.preloadStartIndex=-1,this.currentPage="",this.preloadUrlsPool=new Set,this.setPreloadQueue=e=>{e.length&&(this.preloadQueue=null!=e?e:[],e.forEach((({id:e})=>{e&&this.preloadUrlsPool.add(e)})))},this.setPreloadIndex=e=>{e>=0&&(this.preloadStartIndex=e)},this.getPreloadUrls=()=>{const{preloadStartIndex:e}=this;return this.preloadQueue.slice(e+1,e+a+1)},this.getPreloadedPool=()=>this.preloadUrlsPool,this.reset=()=>{this.preloadQueue=[],this.preloadStartIndex=-1,this.preloadUrlsPool.clear()},this.setCurrentPage=e=>{this.currentPage=e||"unknown"},this.clearAllVideoCaches=()=>{this.currentPage&&this.preloadUrlsPool.clear()}}};o=(0,n.__decorate)([(0,i._)()],o);const l=e=>{a=e},s={byteLength:-1,duration:-1,type:-1,vid:"unknown"};class d{constructor(){this.preloadVideoId="",this.preloadVideoCache=s,this.setPreloadCacheInfo=(e,t)=>{e&&t&&e!==this.preloadVideoId&&(this.preloadVideoId=e,this.preloadVideoCache=t)},this.getPreloadCacheInfo=e=>e&&this.preloadVideoId&&e===this.preloadVideoId?this.preloadVideoCache:s}}let u=null;const c=()=>(u||(u=new d),u),p={playerReuse:0,playerPreload:{vid:"v0",maxQueueCount:3,preloadMaxCacheCount:5,preloadTime:10,segmentMinDuration:10,minBufferLength:10,startPreloadControl:!1,startPreloadMinBuffer:0,startPreloadMinPosTime:0},hevcIgnoreEnv:0,hevcResultLocal:0,bitrateSelect:{vid:"v0",selector:"default",qualityType:20,hevcQualityType:14},playerUpgrade:{vid:"v0",playerType:"XG"},playerH265Soft:{vid:"v0",enableSoftwareH265:0},playerOpenMse:0}},63508:(e,t,r)=>{var n;r.d(t,{Az:()=>i,Wu:()=>o,uJ:()=>a}),function(e){e[e.NIL=-255]="NIL",e[e.UnknownError=-1]="UnknownError",e[e.Ok=0]="Ok",e[e.ReportLiveFailed=90002]="ReportLiveFailed",e[e.VerifyCode=1e4]="VerifyCode",e[e.VideoLikeFreq=2150]="VideoLikeFreq",e[e.VideoLikeFreq2=2210]="VideoLikeFreq2",e[e.VideoUnavailableDeleted=2054]="VideoUnavailableDeleted",e[e.AdVideoUnavailableChange=2752]="AdVideoUnavailableChange",e[e.CommentBanCode=22]="CommentBanCode",e[e.CommentLikePermissionDisable=3002043]="CommentLikePermissionDisable",e[e.SearchSensitiveCode=403]="SearchSensitiveCode",e[e.SearchYoungCode=203]="SearchYoungCode",e[e.SmsInvalidNumber=-1]="SmsInvalidNumber",e[e.SmsSlideVerify=-4]="SmsSlideVerify",e[e.FypVideoListLimit=10404]="FypVideoListLimit",e[e.ClientPageError=450]="ClientPageError",e[e.LiveNeedLogin=10119]="LiveNeedLogin",e[e.SharkBlock=10114]="SharkBlock",e[e.SharkSlide=10113]="SharkSlide",e[e.NetError=10111]="NetError",e[e.ServerErrorNot500=10101]="ServerErrorNot500",e[e.VideoRisk=10228]="VideoRisk",e[e.VideoRMask=10229]="VideoRMask",e[e.VideoRiskMask=10230]="VideoRiskMask",e[e.VideoNeedRecheck=10227]="VideoNeedRecheck",e[e.VideoUnshelveByMusic=10220]="VideoUnshelveByMusic",e[e.VideoNotExist=10204]="VideoNotExist",e[e.VideoAbnormal=10215]="VideoAbnormal",e[e.VideoLowAgeM=10213]="VideoLowAgeM",e[e.VideoLowAgeT=10214]="VideoLowAgeT",e[e.VideoFirstReviewUnshelve=10217]="VideoFirstReviewUnshelve",e[e.VideoPrivateByUser=10216]="VideoPrivateByUser",e[e.VideoGeofenceBlock=10231]="VideoGeofenceBlock",e[e.VideoPhoto=10239]="VideoPhoto",e[e.VideoFriendsOnly=10240]="VideoFriendsOnly",e[e.VideoDeleted=10241]="VideoDeleted",e[e.VideoUserBlockedByAuthor=10242]="VideoUserBlockedByAuthor",e[e.HashtagNotExist=10205]="HashtagNotExist",e[e.HashtagUnshelve=10212]="HashtagUnshelve",e[e.HashtagSensitivityWord=10211]="HashtagSensitivityWord",e[e.HashtagBlackList=10209]="HashtagBlackList",e[e.UserInboxFollowBan=24]="UserInboxFollowBan",e[e.UserNotExist=10202]="UserNotExist",e[e.UserBan=10221]="UserBan",e[e.UserPrivate=10222]="UserPrivate",e[e.UserNotLogin=10102]="UserNotLogin",e[e.UserFtc=10223]="UserFtc",e[e.UserUniqueSensitivity=10225]="UserUniqueSensitivity",e[e.QuestionNotAvailable=10236]="QuestionNotAvailable",e[e.MusicNotExist=10203]="MusicNotExist",e[e.MusicUnshelve=10218]="MusicUnshelve",e[e.MusicNoCopyright=10219]="MusicNoCopyright",e[e.MusicUnavailable=202001]="MusicUnavailable",e[e.GameNotExist=10224]="GameNotExist",e[e.LiveNotExist=10210]="LiveNotExist",e[e.GoLiveRoomBaned=10018]="GoLiveRoomBaned",e[e.GoLiveBaned=4003035]="GoLiveBaned",e[e.LiveRoomPrepare=30019]="LiveRoomPrepare",e[e.LiveRoomEnd=30003]="LiveRoomEnd",e[e.LiveRoomBan=30012]="LiveRoomBan",e[e.LiveNoGatedAuth=4003043]="LiveNoGatedAuth",e[e.LiveNoAgeGatedAuth=4003110]="LiveNoAgeGatedAuth",e[e.LivePaidEvent=4003072]="LivePaidEvent",e[e.LiveSubscriberOnly=4003135]="LiveSubscriberOnly",e[e.LiveSuicideCase=2403]="LiveSuicideCase",e[e.LiveSensitiveTitle=50004]="LiveSensitiveTitle",e[e.LiveRoomBaned=10018]="LiveRoomBaned",e[e.LiveEnterRoomNeedLogin=20003]="LiveEnterRoomNeedLogin",e[e.LiveAccountUnderRiskControl=20063]="LiveAccountUnderRiskControl",e[e.LiveHitBanStrategy=30009]="LiveHitBanStrategy",e[e.LiveOBSAccessRecalled=4003105]="LiveOBSAccessRecalled",e[e.EffectNotExist=10208]="EffectNotExist",e[e.PlaylistNotExist=10233]="PlaylistNotExist",e[e.PlaylistInTrill=10234]="PlaylistInTrill",e[e.VideoPlaylistUnavailable=10243]="VideoPlaylistUnavailable",e[e.VideoPlaylistIsEmpty=10244]="VideoPlaylistIsEmpty",e[e.PrivateAccountLimitByBC=3026002]="PrivateAccountLimitByBC"}(n||(n={}));const i=e=>{if(isNaN(e))return"00:00";const t=Math.floor(e/3600),r=(t<10?"0":"")+t.toString(),n=`0${Math.floor(e/60%60)}`.slice(-2),i=`0${Math.floor(e%60)}`.slice(-2);return 0===t?`${n}:${i}`:`${r}:${n}:${i}`},a=(new Map([[2,"adapt_lowest_1080p"],[3,"adapt_lower_1080p"],[4,"adapt_1080p"],[7,"adapt_lowest_1440p"],[10,"normal_720p"],[11,"low_720p"],[12,"adapt_high_720p"],[13,"adapt_higher_720p"],[14,"adapt_lower_720p"],[15,"adapt_lowest_720p"],[16,"higher_720p"],[17,"highest_720p"],[18,"adapt_720p"],[19,"adapt_low_720p"],[191,"lower_720p"],[20,"normal_540p"],[21,"adapt_lower_540p"],[22,"adapt_high_540p"],[23,"adapt_higher_540p"],[24,"lower_540p"],[25,"lowest_540p"],[26,"higher_540p"],[27,"highest_540p"],[28,"adapt_540p"],[29,"adapt_lowest_540p"],[291,"adapt_low_540p"],[30,"normal_480p"],[31,"low_480p"],[32,"high_480p"],[33,"medium_480p"],[34,"lower_480p"],[35,"lowest_480p"],[36,"higher_480p"],[37,"highest_480p"],[38,"adapt_480p"],[39,"adapt_lower_480p"],[391,"adapt_high_480p"],[40,"normal_360p"],[41,"low_360p"],[42,"high_360p"],[43,"medium_360p"],[44,"lower_360p"],[45,"lowest_360p"],[46,"higher_360p"],[47,"highest_360p"],[48,"adapt_360p"],[49,"adapt_lowest_360p"],[50,"adapt_high_360p"]]),"use-credentials"),o="PRELOAD_INFO"},43097:(e,t,r)=>{r.d(t,{VL:()=>l,qW:()=>o});var n=r(31209);const i=(0,r(43723).p)("videoActualResolutionState@tiktok/webapp-atoms",{actualResolution:""}),{useAtomService:a,useServiceState:o,useServiceDispatchers:l,getStaticApi:s}=(0,n.i)(i,((e,t)=>({setVideoActualResolution(e){t(i,(t=>Object.assign(Object.assign({},t),{actualResolution:e})))}})))},72263:(e,t,r)=>{r.d(t,{A:()=>n});var n=new(r(85135).A)},40650:(e,t,r)=>{r.d(t,{R:()=>a});var n=r(40099);const i=300;function a(e,t){const{onClick:r,onDoubleClick:a,onIntervalAction:o}=e(),l=(0,n.useRef)(0),s=(0,n.useRef)(!1);return(0,n.useCallback)((e=>{l.current&&window.clearTimeout(l.current),s.current?null==a||a(e):(null==o||o(),s.current=!0,window.setTimeout((()=>{s.current=!1}),i),l.current=window.setTimeout((()=>{null==r||r(e)}),i))}),t)}},30662:(e,t,r)=>{r.d(t,{tG:()=>s});var n,i,a=r(58632),o=r(7672),l=r(93608);!function(e){e.Share="livesdk_share",e.Report="livesdk_live_user_report",e.ReportSuccess="livesdk_report_success",e.ChatClose="livesdk_comment_close",e.HoverUserCardShow="livesdk_user_card_show",e.Follow="livesdk_follow",e.Take="livesdk_live_action",e.SetupPopShow="livesdk_live_tab_popup_show",e.AnchorEnterRoom="livesdk_anchor_enter_room",e.Show="livesdk_live_show",e.ClickEntrance="livesdk_rec_live_play",e.Unfollow="livesdk_unfollow"}(n||(n={})),function(e){e.LiveCover="live_cover",e.SuggestedOthersPhoto="suggested_others_photo",e.NextIconClick="next_icon_click",e.Others="others",e.VideoHeadBrowser="video_head_browser",e.Creator="creator",e.VideoHead="video_head",e.LiveHead="live_head",e.OthersPhoto="others_photo",e.ClickOneColumnUser="click_main_btn",e.TopLiveCell="top_live_cell",e.VideoLiveCell="video_live_cell",e.FollowingTop="top_window",e.FollowingPreview="live_cover_preview"}(i||(i={}));let s=class{constructor(){this.handleLiveEntranceShow=e=>{l.f.event("livesdk_live_show",e)},this.handleLiveEntranceClick=e=>{l.f.event("livesdk_rec_live_play",e)},this.handleLiveStreamEntranceClick=e=>{l.f.event("livesdk_live_action",Object.assign({live_type:"third_party"},e))}}};s=(0,a.__decorate)([(0,o._)()],s)},64116:(e,t,r)=>{r.d(t,{Az:()=>i,Dr:()=>n,H4:()=>o});const n=e=>10229===e||10230===e,i=e=>{if(isNaN(e))return"00:00";const t=Math.floor(e/3600),r=(t<10?"0":"")+t.toString(),n=`0${Math.floor(e/60%60)}`.slice(-2),i=`0${Math.floor(e%60)}`.slice(-2);return 0===t?`${n}:${i}`:`${r}:${n}:${i}`},a=new Map([[2,"adapt_lowest_1080p"],[3,"adapt_lower_1080p"],[4,"adapt_1080p"],[7,"adapt_lowest_1440p"],[10,"normal_720p"],[11,"low_720p"],[12,"adapt_high_720p"],[13,"adapt_higher_720p"],[14,"adapt_lower_720p"],[15,"adapt_lowest_720p"],[16,"higher_720p"],[17,"highest_720p"],[18,"adapt_720p"],[19,"adapt_low_720p"],[191,"lower_720p"],[20,"normal_540p"],[21,"adapt_lower_540p"],[22,"adapt_high_540p"],[23,"adapt_higher_540p"],[24,"lower_540p"],[25,"lowest_540p"],[26,"higher_540p"],[27,"highest_540p"],[28,"adapt_540p"],[29,"adapt_lowest_540p"],[291,"adapt_low_540p"],[30,"normal_480p"],[31,"low_480p"],[32,"high_480p"],[33,"medium_480p"],[34,"lower_480p"],[35,"lowest_480p"],[36,"higher_480p"],[37,"highest_480p"],[38,"adapt_480p"],[39,"adapt_lower_480p"],[391,"adapt_high_480p"],[40,"normal_360p"],[41,"low_360p"],[42,"high_360p"],[43,"medium_360p"],[44,"lower_360p"],[45,"lowest_360p"],[46,"higher_360p"],[47,"highest_360p"],[48,"adapt_360p"],[49,"adapt_lowest_360p"],[50,"adapt_high_360p"]]),o=(e,t)=>{if(!e)return t;if(String(e).indexOf("xgpreload_config")>-1)return e;if(!a.has(Number(e))){const t=String(e).match(/^([a-zA-Z]*)+_([0-9]+)_0$/i);return t?`${t[1]}_${t[2]}p`:`unknown_${e}`}return a.get(Number(e))}},4538:(e,t,r)=>{r.d(t,{i:()=>_});var n,i=r(58632),a=r(24643),o=r(25616),l=r(75431),s=r(62186),d=r(72153),u=r(92846);!function(e){e[e.UserFeed=0]="UserFeed",e[e.Feed=1]="Feed",e[e.Browser=2]="Browser",e[e.List=3]="List",e[e.UserPage=4]="UserPage",e[e.Search=5]="Search",e[e.RecommendList=6]="RecommendList"}(n||(n={}));const c="1800ms",p=(0,l.i7)({"0%":{transform:"scale(.95)"},"50%":{transform:"scale(.9)"},"100%":{transform:"scale(.95)"}}),v=(0,l.i7)({"0%":{transform:"scale(1)"},"40%":{transform:"scale(1.15)"},"45%":{transform:"scale(1.16)"},"95%":{transform:"scale(1)"},"100%":{transform:"scale(1)"}}),h=(0,s.default)("svg",{target:"e1vl87hj0"})({position:"absolute"},"label:SvgRoundCircle;"),y=(0,s.default)("div",{target:"e1vl87hj1"})({position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},(({isAnimating:e})=>e?{":after":{content:'""',position:"absolute",left:1,top:1,right:1,bottom:1,borderRadius:"50%",border:"1px solid rgba(255, 119, 146, .5)",animation:`${v} ${c} ease-out infinite`,boxShadow:"0 -0.5px 0.5px 0.5px rgba(255,119,146,.5)"}}:null),"label:DivContainer;"),m=(0,s.default)(u.e,{target:"e1vl87hj2"})((({enable:e,theme:{colors:t},isAnimating:r})=>[{borderColor:t.LineSecondary,borderWidth:"0.5px",cursor:e?"pointer":"unset",backgroundColor:"rgba(136, 136, 136, 0.5)"},r?{animation:`${p} ${c} ease-out infinite`,animationDelay:".9s"}:null]),"label:StyledAvatar;"),g=(0,s.default)("span",{target:"e1vl87hj3"})((({theme:e,isOnTop:t=!1,isBiggerBadge:r=!1})=>[(0,d.zy)({theme:e,typography:"P4",fontWeight:"bold",color:"ConstTextInverse"}),{position:"absolute",background:"linear-gradient(131.17deg, #FF1764 0%, #ED3495 94.15%)",top:t?"-6px":"unset",left:"50%",transform:"translateX(-50%)",wordBreak:"keep-all",zIndex:1},r?{height:"26px",lineHeight:"21px",padding:"1px 8px",bottom:t?"unset":"-8px",border:`2px solid ${e.colors.BGPrimary}`,borderRadius:"5px"}:{height:"15px",lineHeight:"16px",padding:"0 4px",bottom:t?"unset":"-2px",borderRadius:"2px"}]),"label:SpanLiveBadge;"),f=function({size:e=48}){return(0,a.jsxs)(h,{width:e,height:e,viewBox:`0 0 ${e} ${e}`,fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,a.jsx)("circle",{cx:e/2,cy:e/2,r:e/2-.75,stroke:"url(#paint0_linear)",strokeWidth:"1.5"}),(0,a.jsx)("defs",{children:(0,a.jsxs)("linearGradient",{id:"paint0_linear",x1:-20.9902*e/48,y1:24*e/48,x2:27.0098*e/48,y2:65.9805*e/48,gradientUnits:"userSpaceOnUse",children:[(0,a.jsx)("stop",{stopColor:"#FF1764"}),(0,a.jsx)("stop",{offset:"1",stopColor:"#ED3495"})]})})]})},_=function(e){var{className:t,needAnimation:r=!1,isShowLive:n=!0,size:l=32,isShowLiveTag:s=!0,isTagShowingOnTop:d=!1,e2eTag:u,isBiggerBadge:c}=e,p=(0,i.__rest)(e,["className","needAnimation","isShowLive","size","isShowLiveTag","isTagShowingOnTop","e2eTag","isBiggerBadge"]);const v=(0,o.s)(),h=n&&r,_=n?l-6:l,b=h?l-4:l;return(0,a.jsxs)(y,{isAnimating:h,className:t,"data-e2e":u,style:{width:l,height:l},children:[n&&(0,a.jsx)(f,{size:b}),(0,a.jsx)(m,Object.assign({isAnimating:h,enable:!0,size:_},p)),n&&s&&(0,a.jsx)(g,{isOnTop:d,isBiggerBadge:c,children:v("LIVE")})]})}},60492:(e,t,r)=>{r.d(t,{m:()=>y});var n=r(40099),i=r(18499),a=r(53764),o=r(24643),l=r(75431),s=r(62186),d=r(38017);const u=(0,s.default)("div",{target:"exhfy940"})({pointerEvents:"none",position:"fixed",zIndex:1e3},"label:DivDoubleTapContainer;"),c=(0,l.i7)({"0%":{opacity:"1",transform:"scale(1.18)"},"14%":{opacity:"1",transform:"scale(.9)"},"21%":{opacity:"1",transform:"scale(1)"},"58%":{opacity:"1",transform:"scale(1)"},"100%":{opacity:"0",transform:"scale(1.93)"}}),p=(0,s.default)(d.A,{target:"exhfy941"})({animation:`${c} 1400ms`,width:"120px",height:"120px"},"label:StyledLikeIcon;");var v=r(67518);const h=function({x:e,y:t,styledCache:r}){const n=Math.floor(61*Math.random()-30),i=(0,o.jsx)(u,{style:{left:e-60,top:t-60,transform:`rotate(${n}deg)`},children:(0,o.jsx)(p,{})});return r?(0,o.jsxs)(v.C,{value:r,children:[" ",i," "]}):i};class y{constructor(e,t,r=document,n=void 0){this.x=e,this.y=t,this.documentObj=r,this.styledCache=n,this.el=this.documentObj.createElement("div")}emit(){var e;try{(null!==(e=this.documentObj[null===a.e||void 0===a.e?void 0:a.e.fullscreenElement])&&void 0!==e?e:this.documentObj.body).appendChild(this.el),(0,i.render)((0,n.createElement)(h,{x:this.x,y:this.y,styledCache:this.styledCache}),this.el),window.setTimeout((()=>{this.destroy()}),1400)}catch(e){console.error(e)}}destroy(){var e;try{(0,i.unmountComponentAtNode)(this.el),(null!==(e=this.documentObj[null===a.e||void 0===a.e?void 0:a.e.fullscreenElement])&&void 0!==e?e:this.documentObj.body).removeChild(this.el)}catch(e){console.error(e)}}}},1096:(e,t,r)=>{r.d(t,{H:()=>s});var n=r(24643),i=r(57432),a=r.n(i),o=r(40099),l=r(61853);const s=({width:e=160,height:t=160,loop:r=!1,onComplete:i=a(),autoplay:s=!0,animationData:d,customStyle:u={}})=>{const c=(0,o.useMemo)((()=>({loop:r,autoplay:s,animationData:d,rendererSettings:{preserveAspectRatio:"xMidYMid slice"}})),[d,s,r]),p=(0,o.useMemo)((()=>[{eventName:"complete",callback:i}]),[i]);return(0,n.jsx)(l.J,{width:e,height:t,options:c,eventListeners:p,customStyle:u})}},61853:(e,t,r)=>{r.d(t,{J:()=>d});var n=r(24643),i=r(17715),a=r.n(i),o=r(40099);function l(e){let t;return t="number"==typeof e?`${e}px`:e||"100%",t}const s=(0,r(62186).default)("div",{target:"e1b0r8240"})((({width:e,height:t})=>({width:l(e),height:l(t),overflow:"hidden",margin:"0 auto",outline:"none"})),"label:DivContainer;"),d=(0,o.memo)((function(e){const{width:t,height:r,className:i,options:l,eventListeners:d=[],lottieRef:u,containerRef:c,customStyle:p={}}=e,v=(0,o.useRef)(null),h=(0,o.useRef)(null);return(0,o.useEffect)((()=>(h.current=a().loadAnimation(Object.assign({container:v.current,renderer:"svg"},l)),u&&(u.current=h.current),()=>{var e;null===(e=h.current)||void 0===e||e.destroy(),h.current=null,u&&(u.current=null)})),[l]),(0,o.useEffect)((()=>(d.forEach((({eventName:e,callback:t})=>{var r;null===(r=h.current)||void 0===r||r.addEventListener(e,t)})),()=>{d.forEach((({eventName:e,callback:t})=>{var r;null===(r=h.current)||void 0===r||r.removeEventListener(e,t)}))})),[d]),(0,n.jsx)(s,{width:t,height:r,className:i,style:p,ref:e=>{v.current=e,c&&(c.current=e)}})}))},51664:(e,t,r)=>{r.d(t,{AL:()=>v,Fu:()=>p,r$:()=>c});var n=r(58632),i=r(41271),a=r(73580),o=r(40099),l=r(93608),s=r(72688),d=r(30662),u=r(50970);function c(e){const t=(0,i.P)(u.L,{dependencies:[],selector:e=>{var t;return null===(t=e.appContext)||void 0===t?void 0:t.user}});return{isShowLive:(0,o.useMemo)((()=>Boolean((null==e?void 0:e.roomId)&&"0"!==(null==e?void 0:e.roomId)&&(null==t?void 0:t.uid)!==e.id)),[null==t?void 0:t.uid,null==e?void 0:e.id,null==e?void 0:e.roomId]),src:null==e?void 0:e.avatarThumb,uniqueId:null==e?void 0:e.uniqueId,pureLivePath:e?(0,s.G2o)({uniqueId:null==e?void 0:e.uniqueId,secUid:null==e?void 0:e.secUid}):""}}function p({reportTrigger:e,user:t,enterMethod:r,autoReport:n,reportValidator:i,once:s,liveExtraParams:u}){const c=(0,a.Nj)(d.tG),[p,h]=(0,o.useState)(!1),y=(0,o.useMemo)((()=>{var e,n;return Object.assign({anchor_id:null!==(e=null==t?void 0:t.id)&&void 0!==e?e:"",follow_status:null!==(n=null==t?void 0:t.relation)&&void 0!==n?n:-1,room_id:null==t?void 0:t.roomId,enter_from_merge:l.f.commonParams.page_name,enter_method:r,action_type:"click"},u)}),[r,u,null==t?void 0:t.id,null==t?void 0:t.relation,null==t?void 0:t.roomId]),m=(0,o.useCallback)((()=>{p&&s||(c.handleLiveEntranceShow(y),h(!0))}),[p,c,s,y]);return(0,o.useEffect)((()=>{n&&e&&i()&&m()}),[e]),{handleExposure:m,teaParams:v({user:t,enterMethod:r}),reportParams:y}}function v(e){var{user:t,enterMethod:r}=e,i=(0,n.__rest)(e,["user","enterMethod"]);return(0,o.useMemo)((()=>{var e,n,a;return Object.assign({anchor_id:null!==(e=null==t?void 0:t.id)&&void 0!==e?e:"",follow_status:null!==(n=null==t?void 0:t.relation)&&void 0!==n?n:-1,room_id:null==t?void 0:t.roomId,enter_from_merge:l.f.commonParams.page_name,enter_from:l.f.commonParams.page_name,action_type:"click",enter_method:r,to_user_id:null!==(a=null==t?void 0:t.id)&&void 0!==a?a:""},i)}),[t,r,i])}},536:(e,t,r)=>{r.d(t,{D:()=>o});var n=r(60484),i=r(49057),a=r(71281);const o=()=>{var e;const{abTestVersion:t}=(0,n.L$)((0,i.W)((()=>["abTestVersion"]),[]));return{enableMiniPlayer:"v0"!==(null!==(e=(0,a.qt)(t,"enable_mini_player"))&&void 0!==e?e:"v0")}}},80131:(e,t,r)=>{r.d(t,{r:()=>S,M:()=>P});var n=r(24643),i=r(41271),a=r(40099),o=r(25616),l=r(62047),s=r(57432),d=r.n(s);const u=JSON.parse('{"v":"5.9.6","fr":60,"ip":0,"op":35,"w":40,"h":20,"nm":"Lottie_ic_forward","ddd":0,"assets":[],"layers":[{"ddd":0,"ind":1,"ty":4,"nm":"“ic_forward","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":4,"s":[90],"e":[90]},{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":8,"s":[90],"e":[50]},{"t":19}],"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":1,"k":[{"i":{"x":0.2,"y":1},"o":{"x":0.4,"y":0},"t":0,"s":[25,10,0],"e":[32,10,0],"to":[1.167,0,0],"ti":[-1.167,0,0]},{"t":14}],"ix":2,"l":2},"a":{"a":0,"k":[4,7,0],"ix":1,"l":2},"s":{"a":0,"k":[100,100,100],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0.107,0],[0.081,0.081],[0,0],[-0.163,0.162],[0,0],[0,0],[-0.163,0.163],[0,0],[-0.107,0],[-0.082,-0.082],[0,0],[0.163,-0.163],[0,0]],"o":[[-0.107,0],[0,0],[-0.163,-0.162],[0,0],[0,0],[-0.163,-0.163],[0,0],[0.081,-0.082],[0.107,0],[0,0],[0.163,0.163],[0,0],[-0.082,0.081]],"v":[[-2.83,6.667],[-3.125,6.545],[-3.714,5.955],[-3.714,5.366],[1.651,0],[-3.714,-5.366],[-3.714,-5.955],[-3.125,-6.544],[-2.83,-6.667],[-2.536,-6.544],[3.714,-0.294],[3.714,0.295],[-2.536,6.545]],"c":true},"ix":2},"nm":"路径 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[1,0.999998743394,1,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"填充 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[3.836,7.333],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"变换"}],"nm":"组 1","np":4,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":35,"st":0,"ct":1,"bm":0},{"ddd":0,"ind":2,"ty":4,"nm":"“ic_forward”轮廓 3","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.833],"y":[1]},"o":{"x":[0.436],"y":[0]},"t":4,"s":[50],"e":[50]},{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":14,"s":[50],"e":[90]},{"t":25}],"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":1,"k":[{"i":{"x":0.2,"y":1},"o":{"x":0.4,"y":0},"t":6,"s":[18,10,0],"e":[25,10,0],"to":[1.167,0,0],"ti":[-1.167,0,0]},{"t":20}],"ix":2,"l":2},"a":{"a":0,"k":[4,7,0],"ix":1,"l":2},"s":{"a":0,"k":[100,100,100],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0.107,0],[0.081,0.081],[0,0],[-0.163,0.162],[0,0],[0,0],[-0.163,0.163],[0,0],[-0.107,0],[-0.082,-0.082],[0,0],[0.163,-0.163],[0,0]],"o":[[-0.107,0],[0,0],[-0.163,-0.162],[0,0],[0,0],[-0.163,-0.163],[0,0],[0.081,-0.082],[0.107,0],[0,0],[0.163,0.163],[0,0],[-0.082,0.081]],"v":[[-2.83,6.667],[-3.125,6.545],[-3.714,5.955],[-3.714,5.366],[1.651,0],[-3.714,-5.366],[-3.714,-5.955],[-3.125,-6.544],[-2.83,-6.667],[-2.536,-6.544],[3.714,-0.294],[3.714,0.295],[-2.536,6.545]],"c":true},"ix":2},"nm":"路径 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[1,0.999998743394,1,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"填充 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[3.836,7.333],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"变换"}],"nm":"组 1","np":4,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":35,"st":0,"ct":1,"bm":0}],"markers":[]}');var c=r(1096);const p=({width:e=40,height:t=20,loop:r=!0,onComplete:i=d(),autoplay:a=!0})=>(0,n.jsx)(c.H,{width:e,height:t,onComplete:i,autoplay:a,loop:r,animationData:u});var v=r(60445),h=r(75431),y=r(62186),m=r(72153);const g=(0,h.i7)({"0%":{opacity:0},"5%":{opacity:1},"100%":{opacity:1}}),f=(0,y.default)("div",{target:"e1jh5nxw0"})({position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"144px",height:"144px",display:"flex",justifyContent:"center",alignItems:"center",zIndex:5},"label:DivAnimationIconWrapper;"),_=(0,y.default)(f,{target:"e1jh5nxw1"})((({theme:{colors:e},isBack:t})=>({width:"300px",top:"unset",bottom:"81px",transform:"translate(-50%, 0)",height:"40px",padding:"8px 16px",paddingInlineEnd:t?"16px":"8px",paddingInlineStart:t?"8px":"16px",display:"inline-flex",flexDirection:t?"row-reverse":"row",borderRadius:"8px",background:e.ConstBGInverse2,animation:`${g} 2000ms linear`})),"label:StyledAnimationWrapper;"),b=(0,y.default)("span",{target:"e1jh5nxw2"})((({theme:e})=>(0,m.zy)({theme:e,typography:"P3",fontFamily:"TikTokFont",fontWeight:"semiBold",color:"ConstTextInverse2"})),"label:SpanForwardText;"),k=(0,y.default)("div",{target:"e1jh5nxw3"})((({isBack:e=!1,theme:{direction:t}})=>({width:"40px",height:"20px",display:"flex",justifyContent:"center",alignItems:"center",transform:`rotateZ(${e?"rtl"===t?0:180:"rtl"===t?180:0}deg)`,marginInlineStart:e?"unset":"-8px",marginInlineEnd:e?"-8px":"unset"})),"label:DivSeekAnimationWrapper;");function P(e){const t=(0,o.s)(),r="backward"===e;return(0,a.useMemo)((()=>"none"!==e?(0,n.jsxs)(_,{isBack:r,children:[(0,n.jsx)(b,{children:t("forward"===e?"pc_web_skip_forward_5_sec":"pc_web_skip_backward_5_sec",{number:l.S})}),(0,n.jsx)(k,{isBack:r,children:(0,n.jsx)(p,{loop:!0})})]}):null),[r,e,t])}const S=()=>{const{seekType:e}=(0,i.P)(v.aL,{selector:e=>({seekType:e.seekType}),dependencies:[]});return{seekingTips:P(e)}}},42357:(e,t,r)=>{r.d(t,{e:()=>o});var n=r(38259),i=r(57432),a=r.n(i);const o=(0,n.$)("CoreContentContext@tiktok/fe-shared")({armCoreContentEvent:a()})},95628:(e,t,r)=>{r.d(t,{e:()=>m});var n,i=r(58632),a=r(24643),o=r(40099),l=r(97208),s=r(67353),d=r(92701),u=r(53701),c=r(1967),p=r(42983),v=r(75248),h=r(72263);!function(e){e.NoInteract="failed because the user didn't interact with the document first.",e.SafariNoInteract="The request is not allowed by the user agent or the platform in the current context"}(n||(n={}));const y=e=>({buffered:null==e?void 0:e.buffered,currentSrc:null==e?void 0:e.currentSrc,currentTime:null==e?void 0:e.currentTime,duration:null==e?void 0:e.duration,readyState:null==e?void 0:e.readyState,error:null==e?void 0:e.error,volume:null==e?void 0:e.volume,muted:null==e?void 0:e.muted}),m=(0,o.memo)((0,o.forwardRef)((function(e,t){var{src:r,playProgress:n,horizontal:m,muteSetting:g,onUnmount:f,onEnded:_,onWaiting:b,disableDownload:k=!0,itemMute:P=!1,metrics:S=null,bitrate:T,hevcTest:C,bitrateInfo:w}=e,x=(0,i.__rest)(e,["src","playProgress","horizontal","muteSetting","onUnmount","onEnded","onWaiting","disableDownload","itemMute","metrics","bitrate","hevcTest","bitrateInfo"]);const E=(0,o.useRef)(null),R=(0,o.useRef)(!1),{mute:M,volume:A,playing:I}=(0,p.O2)(g),{setMute:L}=(0,v.S4)(),j=(0,o.useRef)({time:-1,size:-1}),O=(0,o.useMemo)((()=>{if((0,l.fU)())return{url:r,codecType:"h264"};const e=null===s.bt||void 0===s.bt?void 0:s.bt.useHevc("desktop"),t=null!=C?C:s.bt.hevcTest;if(t.open=e&&t.open,!w||0===(null==w?void 0:w.length))return{url:r,codecType:"h264"};const{src:n,codecType:i}=(0,d.Hg)({hevcTest:t,bitrateInfo:w,downgradeUrl:r,backupDomain:!0});return{url:n,codecType:i}}),[w,r]);(0,o.useImperativeHandle)(t,(()=>{const e=E.current;return{play:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){try{yield null==e?void 0:e.play()}catch(e){}})),pause:()=>{try{h.A.emit("video_pause",{itemId:null!=r?r:""}),null==e||e.pause()}catch(e){}},seek:t=>{if(e){h.A.emit("video_seek",{itemId:null!=r?r:""});const{duration:n}=e;e.currentTime=n*t}},seekTime:t=>{e&&(e.currentTime=t)},onSeeked:t=>{null==e||e.addEventListener("seeked",t)},onSeeking:t=>{null==e||e.addEventListener("seeking",t)},onTimeUpdate:t=>{null==e||e.addEventListener("timeupdate",(()=>{var r,n;const i=null!==(r=e.currentTime)&&void 0!==r?r:0,a=null!==(n=e.duration)&&void 0!==n?n:0;t(i/a,i,a)}))},onCanPlay:t=>{null==e||e.addEventListener("canplay",t)},getPlayerAttributes:()=>y(e)}}));const V=(0,o.useCallback)(((e=0)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var t,r,n;if(!(e>=3))try{yield null===(t=E.current)||void 0===t?void 0:t.play()}catch(t){const i=null!==(r=null==t?void 0:t.message)&&void 0!==r?r:"";(null!==(n=i.match("failed because the user didn't interact with the document first."))&&void 0!==n?n:i.match("The request is not allowed by the user agent or the platform in the current context"))?(L(!0),setTimeout((()=>{V(e+1)}),0)):V(e+1)}}))),[L]);(0,o.useEffect)((()=>{E.current&&(E.current.volume=A)}),[A]),(0,o.useEffect)((()=>{V(),E.current&&Math.abs(E.current.currentTime-n)>.2&&(E.current.currentTime=n)}),[n,V]),(0,o.useEffect)((()=>{var e;I?R.current&&(R.current=!1,V()):(R.current=!0,null===(e=E.current)||void 0===e||e.pause())}),[I,V]),(0,o.useEffect)((()=>{const e=E.current;return()=>{j.current.time>0&&j.current.size>0&&(0,u.a)({time:j.current.time,size:j.current.size}),null==f||f(y(e))}}),[]);const B=(0,o.useCallback)((e=>{e.preventDefault()}),[]);(0,o.useEffect)((()=>{const e=E.current;return k&&(null==e||e.addEventListener("contextmenu",B)),()=>{null==e||e.removeEventListener("contextmenu",B)}}),[E,B,k]);const D=(0,o.useCallback)((e=>{null==b||b(e)}),[b]),F=(0,o.useCallback)((e=>{null==_||_(e),V(),h.A.emit("video_replay",{itemId:null!=r?r:""})}),[_,V,r]),U=(0,o.useCallback)((()=>{if(E.current){const e=E.current;if(T&&T>0){let t=0;for(let r=0;r<e.buffered.length;r++)t+=e.buffered.end(r)-e.buffered.start(r);const r=t*T/8;j.current={time:t,size:r}}}}),[T]);return(0,a.jsx)(c.CZ,Object.assign({horizontal:m,ref:E,src:O.url},x,{muted:P||M,playsInline:!0,autoPlay:!0,onEnded:F,onWaiting:D,onProgress:U}))})))},32098:(e,t,r)=>{r.d(t,{K:()=>o});var n=r(93341),i=r(90341),a=r(40099);const o=e=>{const{updateGlobalVVCount:t}=(0,n.nr)(),r=(0,i.eu)(),o=(0,a.useCallback)((()=>{t(e)}),[t,e]),l=(0,a.useCallback)((()=>{(4===e||2===e&&r)&&t(e)}),[t,e]);return(0,a.useMemo)((()=>({handleBreakCount:o,handleVvCountOnEnd:l})),[e])}},48180:(e,t,r)=>{r.d(t,{o:()=>F});var n=r(24643),i=r(40099),a=r(73580),o=r(41271),l=r(34099),s=r(57431),d=r(38739),u=r(15343),c=r(12323),p=r(43485),v=r(90118),h=r(11654),y=r(63438),m=r(33805),g=r(90341),f=r(75248),_=r(88920),b=r(93341),k=r(35323),P=r(93987),S=r(97086),T=r(53438),C=r(67169),w=r(49057),x=r(42357),E=r(99282),R=r(32545),M=r(2853),A=r(52333),I=r(32098),L=r(72263),j=r(99147),O=r(26740),V=r(43097);let B=null,D=null;const F=(0,i.memo)((0,i.forwardRef)((function({id:e,url:t,index:r,mode:F,horizontal:U,muted:N,duration:q,playbackRate:H=1,e2eTag:Q,bitrateInfo:$,bitrate:z,autoPlay:W=!0,autoReplay:G=!0,containerStyle:K,onVideoPause:Y,onVideoPlaying:Z,onVideoPlay:J,onResolutionReady:X,onVideoEnded:ee,onVideoError:te,onTimeUpdate:re,onVolumeChange:ne,onVideoCanPlay:ie,posterConfig:ae,teaConfig:oe,videoQualityConfig:le,fetchPriority:se="auto",subtitleList:de,curSubtitle:ue,onSubtitleCallback:ce,renderState:pe=c.R.ACTIVE},ve){var he,ye,me;const ge=(0,i.useRef)(null),fe=(0,i.useRef)(!0),_e=(0,g.J3)(),{setMute:be,setVolume:ke,setCanAutoPlay:Pe}=(0,f.S4)(),Se=(0,f.ol)(),Te=null!==(he=null==oe?void 0:oe.playMode)&&void 0!==he?he:F;B||(B=(0,l.V)()),D||(D=(0,s.x)());const Ce=(0,a.Nj)(d.Gs),we=(0,a.Nj)(u.AU),xe=(0,a.Nj)(h.V$),{armCoreContentEvent:Ee}=(0,i.useContext)(x.e),Re=(0,i.useCallback)((()=>{null==Ee||Ee(),xe.reportActualFMP(),j.e.handleActualFMP()}),[Ee,xe]),Me=N||y.T5[F].forceMute,Ae=(0,f.i3)(),Ie=1===F?Me:Me||Ae,Le=(0,f.R4)(),je=(0,b.w)(r,F,e);(0,O.w)({isCurrentVideo:je,index:r,mode:F});const Oe=[c.R.ACTIVE,c.R.BACKUP,c.R.RETAIN].includes(pe)&&0===Te,Ve=(0,i.useMemo)((()=>(0,S.fU)()?"":(0,m.N2)(window.location.pathname)),[]),Be=null!==(ye=(0,g.eu)())&&void 0!==ye&&ye,{actualResolution:De}=(0,V.qW)(),Fe=(0,b.fD)(),Ue=(0,f.i3)(),Ne=(0,T.Hs)(e),qe=(0,T.yy)(e,r),He=(0,E.WH)(e),Qe=(0,_.HL)(),$e=(0,i.useMemo)((()=>{let e;return e={isAutoScroll:Be,resolution:De,is_auto_resolution:Fe,mute:Ue,itemMute:N,videoDimensionParams:Ne,videoContentParams:qe,playModeForTea:Te,pathId:Ve,vqscore:le&&le.vqscore?le.vqscore:0,claTeaParams:He},e}),[Be,De,Fe,Ue,N,Ne,Te,Ve,le,qe,He]),ze=(0,o.P)(A.k);p._.updateItems(ze),(0,i.useEffect)((()=>{p._.updateItems(ze)}),[ze]),(0,i.useEffect)((()=>{je&&(0,k.uQ)(P.Y.PlayerMounted)}),[je]);const[We,Ge]=(0,i.useState)(!1),Ke=(0,C.jj)();(0,i.useEffect)((()=>{ge&&ge.current&&(Ke&&W||8===F?ge.current.play():(ge.current.pause(),je&&!Ke&&Ce.triggerPause({enter_method:"switch_tab",playMode:Te})))}),[W,Ke,je,Te,F]);const Ye=B,{region:Ze,wid:Je,user:Xe,isTTP:et,odinId:tt}=D||{},{abTestVersion:rt}=null!==(me=(0,w.W)((()=>["abTestVersion"]),[]))&&void 0!==me?me:{},nt=(0,_.iM)("desktop"),it=(0,_.Yu)(),at=(0,_.pd)("desktop"),ot=(0,_.ZC)(),lt=(0,i.useMemo)((()=>{var e;return{tea:{channel:Ye.teaChannel,domain:Ye.tea,type:null!==(e=Ye.teaChannelType)&&void 0!==e?e:"tcpy"},region:Ze,webId:Je,uid:(null==Xe?void 0:Xe.uid)||tt||Je,isLogin:!!Xe,abTestVersion:rt?`${rt.versionName},${at}`:at,hevcAbTestVersion:at,vIndex:null!=r?r:-1,isTTP:et}}),[Ye,Je,Ze,Xe,rt,at,et]);(0,i.useImperativeHandle)(ve,(()=>({play:e=>{var t;null===(t=ge.current)||void 0===t||t.play(),e&&Ce.triggerResume({enter_method:"click_resume",playMode:Te})},pause:()=>{var t;null===(t=ge.current)||void 0===t||t.pause(),L.A.emit("video_pause",{itemId:e,playMode:F})},seek:t=>{var r,n;let i=0;const a=null===(r=ge.current)||void 0===r?void 0:r.getAttributes();a&&(i=a.duration),null===(n=ge.current)||void 0===n||n.seek(i*t),L.A.emit("video_seek",{itemId:e,playMode:F})},seekTime:e=>{var t;null===(t=ge.current)||void 0===t||t.seek(e)},getFullscreen:e=>{var t;null===(t=ge.current)||void 0===t||t.enterFullscreen(e)},exitFullscreen:e=>{var t;null===(t=ge.current)||void 0===t||t.exitFullscreen(e)},updatePlayer:e=>{var t;null===(t=ge.current)||void 0===t||t.updatePlayer(e)},changeResolution:e=>{var t;null===(t=ge.current)||void 0===t||t.changeResolution(e)},getResolutionInfo:()=>{var e;return null===(e=ge.current)||void 0===e?void 0:e.getResolutionInfo()},replay:()=>{var e;null===(e=ge.current)||void 0===e||e.replay()},get currentTime(){var e;const t=null===(e=ge.current)||void 0===e?void 0:e.getAttributes();return t?t.currentTime:0},get duration(){var e;const t=null===(e=ge.current)||void 0===e?void 0:e.getAttributes();return t?t.duration:0},get currentCanPlay(){return je&&We}})),[We,je,Te]);const{loading:st,handleCanPlayWithLoading:dt,handlePauseWithLoading:ut,handlePlayingWithLoading:ct,handleWaitingWithLoading:pt}=(0,C.iJ)({isCurrentVideo:je}),vt=(0,i.useCallback)((e=>{dt(),Ge(!0),null==ie||ie(e),Se&&ge&&ge.current&&fe.current&&(ge.current.seek(Se),fe.current=!1)}),[dt,ie,Se]),ht=(0,i.useCallback)((()=>{var e,t,r;const n=null===(e=ge.current)||void 0===e?void 0:e.getAttributes(),i=null!==(t=null==n?void 0:n.currentTime)&&void 0!==t?t:0,a=null!==(r=null==n?void 0:n.duration)&&void 0!==r?r:0;let o=0;a&&(o=i/a),null==re||re(o,i,a),j.e.handleFirstFrameVideo()}),[re]),yt=(0,i.useCallback)(((e,t)=>{null==ne||ne(e,t)}),[ne,be,ke]),mt=(0,i.useCallback)((e=>{var t;null==te||te(e),_e.setPlayerError();const r=null===(t=ge.current)||void 0===t?void 0:t.getAttributes();if(r){let e=-1,t="";const n=r.readyState,i=r.networkState;r.error&&(e=r.error.code,t=r.error.message),xe.emitEvent("video_playback_error",{code:e},{errorMessage:t,errorCode:String(e),readyState:String(n),networkState:String(i)})}}),[te,xe]),gt=(0,i.useCallback)((e=>{ut(),null==Y||Y(e)}),[Y,ut]),{handleVvCountOnEnd:ft,handleBreakCount:_t}=(0,I.K)(F),bt=(0,i.useCallback)((()=>{_t()}),[]),kt=(0,i.useCallback)((t=>{ft(),null==ee||ee(t),G&&L.A.emit("video_replay",{itemId:e,playMode:F})}),[ee,G,e,F]),Pt=(0,i.useCallback)((e=>{ct(),null==Z||Z(e),Pe(!0)}),[Z,ct]),St=(0,i.useCallback)((()=>{pt()}),[pt]),Tt=(0,i.useCallback)((e=>{const{errorCode:t,errorMessage:r,logid:n}=e;xe.emitEvent("video_play_end",{count:1},{is_success:`${0===t}`,error_code:String(t),error_msg:r,logid:n})}),[xe]),Ct=U||2===F||3===F||4===F||6===F||5===F;return(0,n.jsxs)(M.Le,{horizontal:U,mode:F,style:K,children:[(null==ae?void 0:ae.poster)?(0,n.jsx)(M.R,{horizontal:Ct,mode:F,src:ae.poster,alt:ae.desc,loading:ae.lazyLoading?"lazy":"eager",style:ae.style,onLoad:Re,fetchPriority:se}):(null==ae?void 0:ae.videoCover)?(0,n.jsx)(R.x,{video:ae.videoCover,objectFit:Ct?"contain":"cover",style:ae.style,alt:ae.desc,onLoad:Re,fetchPriority:se}):null,(je||Oe)&&(0,n.jsxs)(M.Ec,{horizontal:Ct,"data-e2e":Q,children:[(0,n.jsx)(v.xk,{ref:ge,bitrateInfo:$,defaultBitrate:z,duration:q,autoplay:W,loop:G,oncanplay:vt,onplay:J,onwaiting:St,onended:kt,ontimeupdate:ht,onvolumechange:yt,onerror:mt,onpause:gt,onbreak:bt,onplaying:Pt,onVideoPlayEnd:Tt,onResolutionReady:X,teaParams:null==oe?void 0:oe.params,mode:F,id:e,volume:Le,muted:Ie,playbackRate:H,url:t,extraMetricsParams:$e,videoPlayReport:Ce,videoExperienceReport:we,appLoggerParams:lt,useHEVC:nt.open,hevcTest:nt,playbackAbTestInfo:Object.assign(Object.assign({},it),ot),subtitleList:de,curSubtitle:ue,onSubtitleCallback:ce,renderState:pe,onAutoplayPrevented:()=>{Qe&&Pe(!1)}}),st&&(0,n.jsx)(M.K3,{})]})]})})))},2853:(e,t,r)=>{r.d(t,{Ec:()=>l,K3:()=>s,Le:()=>a,R:()=>o});var n=r(62186),i=r(84827);const a=(0,n.default)("div",{target:"ec2xuek0"})((({horizontal:e,mode:t,theme:{colors:r}})=>[{width:"100%",height:"100%",overflow:"hidden",position:"relative",backgroundColor:r.BGPlaceholderDefault,backgroundSize:e?"contain":"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},2===t||1===t||3===t||5===t?{display:"flex",alignItems:"center",justifyContent:"center"}:null]),"label:DivContainer;"),o=(0,n.default)("img",{target:"ec2xuek1"})((({horizontal:e,mode:t,fetchPriority:r="auto"})=>2!==t&&3!==t&&4!==t&&5!==t?{width:"100%",height:"100%",objectFit:"cover",fetchPriority:r}:{width:"100%",height:"100%",objectFit:e?"contain":"cover",fetchPriority:r}),"label:ImgPoster;"),l=(0,n.default)("div",{target:"ec2xuek2"})((({horizontal:e=!0})=>({position:"absolute",left:0,top:0,width:"100%",height:"100%","& .tiktok-web-player":{width:"100%",height:"100%"},"& .xgplayer video":{display:"block",width:"100%",height:"100%",objectFit:e?"contain":"cover"},"& .tiktok-web-player video":{display:"block",width:"100%",height:"100%",objectFit:e?"contain":"cover"}})),"label:DivBasicPlayerWrapper;"),s=(0,n.default)(i.R,{target:"ec2xuek3"})({position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:3},"label:StyledLoading;")},36792:(e,t,r)=>{r.d(t,{K:()=>Ne});var n=r(24643),i=r(40099),a=r(88920),o=r(73580),l=r(38739),s=r(15343),d=r(96959);class u{constructor(e="webapp",{playReport:t,experienceReport:r}){this.project=e,this._platform="",this._url="",this._playMode=0,this._videoQualityHandleParams=null,this._videoPlayHandleParams=null,this._playbackAttributes=null,this.isIos=!1,this.isAndroid=!1,this.videoExperienceReport=r,this.videoPlayReport=t,this.videoQualityReport=new d.re,this.renderState=""}set platform(e){this._platform=e,this.isIos="ios"===this._platform,this.isAndroid="android"===this._platform}set playMode(e){this._playMode=e}set url(e){this._url=e}set videoQualityHandleParams(e){this._videoQualityHandleParams=e}set videoPlayHandleParams(e){this._videoPlayHandleParams=e}set playbackAttributes(e){this._playbackAttributes=e}updateMetricsParams({playbackAttribute:e,videoQualityParams:t}){e&&(this.playbackAttributes=e),t&&(this.videoQualityHandleParams=t)}onPlay(){}onPlaying(){this.videoExperienceReport.reportVideoInteract({endTime:Date.now(),videoSource:this._url})}onPause(){this._videoPlayHandleParams&&this._playbackAttributes&&this.videoPlayReport.handlePause(Object.assign(Object.assign({},this._videoPlayHandleParams),this._playbackAttributes))}onWaiting(){this._videoPlayHandleParams&&this._playbackAttributes&&this.videoPlayReport.handleWaiting(Object.assign(Object.assign({},this._videoPlayHandleParams),this._playbackAttributes))}onLoadStart(){}onLoadedData(){}onCanPlay(){this.videoExperienceReport.getCurrentPageReport()||(this.videoExperienceReport.reportVideoFirstScreen({endTime:Date.now(),videoSource:this._url}),this.videoExperienceReport.reportVideoAddition({endTime:Date.now(),videoSource:this._url}))}onCanPlayThrough(){this.isIos&&(this.videoExperienceReport.getCurrentPageReport()||(this.videoExperienceReport.reportVideoFirstScreen({endTime:Date.now(),videoSource:this._url}),this.videoExperienceReport.reportVideoAddition({endTime:Date.now(),videoSource:this._url})))}onTimeUpdate(){var e;this._videoQualityHandleParams&&this._videoPlayHandleParams&&this._playbackAttributes&&("webapp-mobile"===this.project?this.videoPlayReport.handleTimeUpdate(Object.assign(Object.assign(Object.assign({},this._videoPlayHandleParams),this._playbackAttributes),{render_state:this.renderState}),!0):this.videoPlayReport.handleTimeUpdate(Object.assign(Object.assign(Object.assign({},this._videoPlayHandleParams),this._playbackAttributes),{render_state:this.renderState}))),!this.videoExperienceReport.getFirstFrameReport()&&this._playbackAttributes&&this.videoExperienceReport.reportVideoFirstFrame(null!==(e=this._playbackAttributes.currentTime)&&void 0!==e?e:-1)}onError(){this._videoPlayHandleParams&&this.videoPlayReport.handleError(this._videoPlayHandleParams)}onEnded(){this._videoPlayHandleParams&&this.videoPlayReport.handleEnded(this._videoPlayHandleParams)}onSlideChange(e){var t,r;0!==(null!==(r=null===(t=this._playbackAttributes)||void 0===t?void 0:t.duration)&&void 0!==r?r:0)&&this._videoPlayHandleParams&&this.videoPlayReport.handlePlayTime(this._videoPlayHandleParams)}onUnmount(e){this.isIos||this.onSlideChange(e)}onProgress(e,t){}mseCDNCache(e){}pauseAction(e){this.videoPlayReport.triggerPause({enter_method:e,playMode:this.playMode})}setPlayerType(e){}setRenderState(e){this.renderState=e}updateFrameInfo(e){}}var c=r(75248),p=r(90341),v=r(97086),h=r(93341),y=r(11654),m=r(67169),g=r(60484),f=r(63438),_=r(32545),b=r(42357),k=r(95628),P=r(1967),S=r(99147),T=r(26740),C=r(43097);const w=(0,i.memo)((0,i.forwardRef)((function({poster:e,videoCover:t,lazyLoading:r=!0,horizontal:a,playUrl:d,id:w,teaParams:x,index:E,mode:R,itemMute:M,desc:A,topSearchQueryAfterViewWord:I,onVideoPause:L,onVideoEnded:j,onVideoError:O,e2eTag:V,onTimeUpdate:B,subtitleStruct:D,disableDownload:F=!0,posterStyle:U,bitrateInfo:N,fetchPriority:q="auto"},H){const{currentVideo:Q,autoResolution:$}=(0,h.MY)(),{actualResolution:z}=(0,C.qW)(),W=(0,c.ol)(),G=(0,p.eu)(),K=(0,i.useRef)(null),Y=(0,i.useRef)(null),Z=(0,o.Nj)(l.Gs),J=(0,o.Nj)(s.AU),[X,ee]=(0,i.useState)(!1),te=(0,o.Nj)(y.V$),re=(0,i.useMemo)((()=>(0,v.fU)()?null:new u("webapp-desktop",{playReport:Z,experienceReport:J})),[J,Z]),ne=(0,i.useCallback)((()=>{var e,t;null===(t=null===(e=K.current)||void 0===e?void 0:e.play)||void 0===t||t.call(e)}),[]),ie=(0,i.useCallback)((()=>{var e,t;null===(t=null===(e=K.current)||void 0===e?void 0:e.pause)||void 0===t||t.call(e)}),[]),ae=(0,i.useMemo)((()=>{if(!Q)return!1;const{id:e,index:t,mode:r}=Q;return e===w&&t===E&&r===R}),[w,E,R,Q]);(0,i.useEffect)((()=>{null==re||re.setPlayerType(2)}),[re]),(0,i.useImperativeHandle)(H,(()=>({play:e=>{ne(),Y.current=!0,e&&Z.triggerResume({enter_method:"click_resume",playMode:R})},pause:()=>{ie(),Y.current=!1,Z.triggerPause({enter_method:"click_pause",playMode:R,currentBackendSourceEventTracking:x.currentBackendSourceEventTracking})},seek:e=>{var t;null===(t=K.current)||void 0===t||t.seek(e)},seekTime:e=>{var t;null===(t=K.current)||void 0===t||t.seekTime(e)},onSeeked:e=>{var t;null===(t=K.current)||void 0===t||t.onSeeked(e)},onSeeking:e=>{var t;null===(t=K.current)||void 0===t||t.onSeeking(e)},onTimeUpdate:e=>{var t;null===(t=K.current)||void 0===t||t.onTimeUpdate(e)},getFullscreen:()=>{},exitFullscreen:()=>{},replay:()=>{ne(),Y.current=!0},updatePlayer:e=>{},changeResolution:e=>{},getResolutionInfo:()=>{},get currentTime(){var e,t;return null!==(t=null===(e=K.current)||void 0===e?void 0:e.getPlayerAttributes().currentTime)&&void 0!==t?t:0},get duration(){var e,t;return null!==(t=null===(e=K.current)||void 0===e?void 0:e.getPlayerAttributes().duration)&&void 0!==t?t:0},get currentCanPlay(){return ae&&X}})),[ne,ie,Z,R,ae,X,x.currentBackendSourceEventTracking]),(0,i.useEffect)((()=>{ae||ee(!1)}),[ae]);const oe=(0,m.jj)();(0,i.useEffect)((()=>{const e=null===Y.current||Y.current;oe&&e?ne():(ie(),ae&&!oe&&Z.triggerPause({enter_method:"switch_tab",playMode:R,currentBackendSourceEventTracking:x.currentBackendSourceEventTracking}))}),[oe,ne,ie,Z,ae,R,x.currentBackendSourceEventTracking]);const le=(0,i.useCallback)((()=>{var e;const t=(0,g.L$)(null===(e=K.current)||void 0===e?void 0:e.getPlayerAttributes()),{bitrate:r,author_id:n,format:i,encodedType:a,videoQuality:o,encodeUserTag:l,codecType:s,definition:u,secret:c,forFriend:p}=x;return Object.assign({id:w,authorId:n,playMode:R,bitrate:r,format:i,encodedType:a,videoQuality:o,encodeUserTag:l,codecType:s,definition:u,secret:c,forFriend:p,play_url:d},null!=t?t:{})}),[w,R,x,d]),se=(0,c.i3)(),de=(0,i.useMemo)((()=>{const{group_id:e="",author_id:t="",is_scheduled:r,search_id:n,search_keyword:i,search_result_id:a,question_id:o,collection_id:l,collection_name:s,isPaidPartnership:d,poi_id:u,is_sub_only_video:c,isPinnedItem:p,isReposted:v,currentBackendSourceEventTracking:h}=x||{};return{itemId:e,authorId:t,isScheduled:Boolean(r),autoplayStatus:1,searchId:n,searchKeyword:i,searchResultId:a,questionId:o,playMode:R,isMute:se,isAutoScroll:G,resolution:z,is_auto_resolution:$,collectionId:l,collectionName:s,isPaidPartnership:Boolean(d),poiId:u,isSubOnlyVideo:c,isCopyrightMuted:M,isPinnedItem:p,isReposted:v,currentBackendSourceEventTracking:h}}),[R,se,G,M,x,z,$]),ue=(0,i.useCallback)((()=>{var e;const{currentTime:t=0,duration:r=0}=(0,g.L$)(null===(e=K.current)||void 0===e?void 0:e.getPlayerAttributes());return Object.assign(Object.assign({},de),{currentTime:t,duration:r,index:E})}),[E,de]);(0,i.useEffect)((()=>{x&&re&&(re.videoPlayHandleParams=ue())}),[ue,re,x]);const{loading:ce,handleCanPlayWithLoading:pe,handleWaitingWithLoading:ve}=(0,m.iJ)({isCurrentVideo:ae}),he=(0,i.useCallback)((()=>{var e;null==re||re.updateMetricsParams({playbackAttribute:null===(e=K.current)||void 0===e?void 0:e.getPlayerAttributes(),videoQualityParams:le()}),pe(),ee(!0),null==re||re.onCanPlay()}),[le,re,pe]),ye=(0,i.useCallback)((()=>{var e,t;const{currentTime:r=0,duration:n=0}=(0,g.L$)(null===(e=K.current)||void 0===e?void 0:e.getPlayerAttributes());null==re||re.updateMetricsParams({playbackAttribute:Object.assign({},null===(t=K.current)||void 0===t?void 0:t.getPlayerAttributes()),videoQualityParams:le()}),null==re||re.onTimeUpdate(),null==B||B(r/n),S.e.handleFirstFrameVideo()}),[le,re,B]),me=(0,m.tW)(),ge=(0,i.useCallback)((e=>{var t;null==O||O(e),me(e),null==re||re.updateMetricsParams({playbackAttribute:null===(t=K.current)||void 0===t?void 0:t.getPlayerAttributes(),videoQualityParams:le()}),null==re||re.onError()}),[le,re,O,me]),fe=(0,i.useCallback)((()=>{var e;ve(),null==re||re.updateMetricsParams({playbackAttribute:null===(e=K.current)||void 0===e?void 0:e.getPlayerAttributes(),videoQualityParams:le()}),null==re||re.onWaiting()}),[le,re,ve]),_e=(0,i.useCallback)((e=>{var t;null==j||j(e),null==re||re.updateMetricsParams({playbackAttribute:null===(t=K.current)||void 0===t?void 0:t.getPlayerAttributes(),videoQualityParams:le()}),null==re||re.onEnded()}),[le,re,j]),be=(0,i.useCallback)((e=>{var t;null==re||re.updateMetricsParams({playbackAttribute:null===(t=K.current)||void 0===t?void 0:t.getPlayerAttributes(),videoQualityParams:le()}),null==re||re.onUnmount(Object.assign({},e))}),[le,re]);(0,i.useEffect)((()=>{ae||null==L||L({})}),[ae,L]);const ke=a||2===R||3===R||4===R||6===R||5===R,Pe=I?`${I}. ${A}`:A,{armCoreContentEvent:Se}=(0,i.useContext)(b.e),Te=(0,i.useCallback)((()=>{null==Se||Se(),te.reportActualFMP(),S.e.handleActualFMP()}),[Se,te]);return(0,T.w)({isCurrentVideo:ae,index:E,mode:R}),(0,n.jsxs)(P.Le,{horizontal:a,mode:R,children:[e?(0,n.jsx)(P.R,{horizontal:ke,mode:R,src:e,alt:Pe,loading:r?"lazy":"eager",style:U,onLoad:Te,fetchPriority:q}):t?(0,n.jsx)(_.x,{video:t,objectFit:ke?"contain":"cover",style:U,alt:Pe,onLoad:Te,fetchPriority:q}):null,ae&&(0,n.jsxs)(P.Ec,{"data-e2e":V,children:[(0,n.jsx)(k.e,{ref:K,horizontal:ke,muteSetting:M||f.T5[R].forceMute,defaultMute:f.T5[R].defaultMute,playProgress:null!=W?W:0,src:d,onUnmount:be,onTimeUpdate:ye,onError:ge,onCanPlay:he,onWaiting:fe,onEnded:_e,disableDownload:F,bitrate:x.bitrate,metrics:re,bitrateInfo:N}),ce&&(0,n.jsx)(P.K3,{}),4!==R&&6!==R||!D?null:(0,n.jsx)("track",{default:!0,kind:"subtitles",srcLang:D.language,src:D.url})]})]})})));var x=r(58632),E=r(46682),R=r(11917),M=r.n(R),A=r(57432),I=r.n(A),L=r(35323),j=r(93987),O=r(34099),V=r(57431),B=r(12323),D=r(74745),F=r(91021),U=r(2787),N=r(72263),q=r(93608),H=r(53701),Q=r(96462),$=r(97208),z=r(14511),W=r(92701),G=r(75420),K=r(78519);const Y=(e,t)=>{const r=[];return e.forEach(((e,n)=>{const i=((e,t,r)=>{if(!Array.isArray(e)||e.length<1)return;const n=[];return e.forEach((e=>{const t=(i=e.url)?Array.isArray(i)?i.map((e=>({src:e}))):"string"==typeof i?i:[]:[],r=e.codecType||"h264";var i;!t||Array.isArray(t)&&0===t.length||n.push({url:t,definition:e.definition,bitrate:e.bitrate,duration:e.duration,qualityType:e.qualityType,vtype:"MP4",codecType:r.includes("h265")?"h265":"h264"})})),{order:t,data:{vid:`TT-vCache-${e[0].id}`,payload:n,preloadTime:r,codecType:e[0].codecType}}})(e,n,t);i&&i.data.payload.length>0&&r.push(i)})),r};function Z(e,t,r){try{if(!e)return"";const{host:n}=new URL(e);return t.filter((e=>e===n)).length>0?"anonymous":r.filter((e=>e===n)).length>0?"use-credentials":""}catch(e){return""}}const J=e=>!!e,X={player_type:"playerType",video_play_mode:"videoPlayMode",preloader:"preloader",muted:"muted"};let ee=null;var te=r(63508);let re=null,ne=null,ie={group1:["v16-webapp.tiktok.com","v16m-webapp.tiktokcdn-us.com"],group2:["v16-webapp-prime.tiktok.com","v16-webapp-prime.us.tiktok.com","v19-webapp-prime.us.tiktok.com"]};function ae(e,t,r,n=0){const i=D.M.checkHevcResult(1===n);if(e&&!i.closePreload&&t.length>0){const r=Y(t,10);e.preloadResources(r)}}function oe(e,t){e&&e.updatePreloadCodec(t)}function le(e,t){const r=(null==e?void 0:e.length)||0,n=(null==e?void 0:e.filter((e=>"h264"===e.CodecType)))||[],i=[];return!e||r<1||0===n.length?i.push(function(e){const t=e.defaultDefinition||"default";return{codecType:"h264",url:e.url?[{src:e.url}]:[],vtype:"MP4",qualityType:e.qualityType||0,definition:t,bitrate:e.defaultBitrate||0,gearName:t}}(t)):e.forEach((e=>{var t,r,n,a,o,l;const s=(null===(t=e.PlayAddr)||void 0===t?void 0:t.UrlList)||[];var d;i.push({bitrate:e.Bitrate,size:(null===(r=e.PlayAddr)||void 0===r?void 0:r.DataSize)||0,width:(null===(n=e.PlayAddr)||void 0===n?void 0:n.Width)||0,height:(null===(a=e.PlayAddr)||void 0===a?void 0:a.Height)||0,fileId:(null===(o=e.PlayAddr)||void 0===o?void 0:o.FileHash)||"",uri:(null===(l=e.PlayAddr)||void 0===l?void 0:l.Uri)||"",codecType:(d=e.CodecType,d.includes("h265")?"h265":"h264"),gearName:e.GearName,definition:e.GearName,qualityType:e.QualityType,mvmaf:e.MVMAF||"",url:s.map((e=>({src:e}))),vtype:"MP4"})})),i}const se=e=>Z(e.url,ie.group1,ie.group2)===te.uJ?{credentials:"include"}:{};function de(e){return e===B.R.ACTIVE}function ue(e,t,...r){return e?function(e=[],t=0,r,n,i=0,a=!0,o,l,s,d,u,c,p,v,h,y,m,g){const{channelInfo:f,regionInfo:_}=D.M.getInstance(),b=(null==p?void 0:p.open)?"h265":"h264",k=n,P=le(e,{defaultBitrate:t,defaultDefinition:r,url:d}),{h264Set:S,h265Set:T}=(0,W.cU)(e);let C="";d&&(C=Z(d,ie.group1,ie.group2));const w=C===te.uJ?{credentials:"include"}:{},x={channel:null==f?void 0:f.channel,channel_domain:null==f?void 0:f.domain,channel_type:null==f?void 0:f.type},E=(null==_?void 0:_.region)||"",R=(null==_?void 0:_.wid)||"",M=(null==_?void 0:_.isLogin)||!1,A=(null==h?void 0:h.playerPreload)||{},I=(null==u?void 0:u.extInfo)||{},L=null==h?void 0:h.bitrateSelect,j={selector:(null==L?void 0:L.selector)||"default",selectConfig:(null==L?void 0:L.config)||{},quality:null==L?void 0:L.qualityType,hevcQuality:null==L?void 0:L.hevcQualityType};(0,$.Tb)("generatePlayerConfigTT",k,P,j);const O=D.a.getHevcDisableInfo();return{playerType:"NEW_TT",playerConfig:{autoplay:a,volume:l,muted:s,playbackRate:1,codecType:b,vtype:"MP4",mp4EncryptPlayer:{closeDowngrade:!1,minBufferLength:10,maxBufferLength:30,needPreloadRangeList:!0,needPreloadCheck:!0,needAutoBitrate:!0,removeBufferLen:60,resumePlayWaterLevel:0,segmentMinDuration:10,reqOptions:w,getRequestOptionsCallback:se},getRequestOptionsCallback:se},strategyConfig:{enableSubtitle:!0,enablePreloader:"0"!==(null==g?void 0:g.preloader),enableLogger:!0,preloaderConfig:Object.assign(Object.assign({minBufferLength:10,preloadCacheType:1,preloadMaxCacheCount:5,preloadTime:10,preloadSize:209715,segmentMinDuration:10,reqOptions:w},A),{getRequestOptionsCallback:se}),bitrateAdapter:Object.assign(Object.assign({},j),{hevcQuality:(null==p?void 0:p.hevcQualityType)||28,quality:(null==p?void 0:p.qualityType)||20,userSelectResolution:y||"auto"}),videoPlayMode:(null==g?void 0:g.videoPlayMode)||"AUTO"},videoInfo:{vid:k,groupId:k,vtype:"MP4",codecType:"h264",definition:r||"",bitrate:t,width:0,height:0,url:d,duration:i,bitrateList:P,vqscore:null!=c?c:0,mvmaf:"",volumeInfo:m},loggerParams:{lineAppId:1988,playerCoreVersion:"",codec_type:b,tag:D.M.pageName,preTag:D.M.prePageName,preSubtag:D.M.prePlayMode,subtag:D.M.playMode,vid:n,region:E,webId:R,uid:(null==_?void 0:_.uid)||R,isLogin:M,channelConfig:x,switchPlayerTime:v,bitrateSet:S,bitrateSetHevc:T,pIndex:(null==u?void 0:u.vIndex)||-1,ext:Object.assign(Object.assign(Object.assign({},I),O),{log_id:(null==o?void 0:o.log_id)||"",is_ad:(null==o?void 0:o.isAd)?1:0}),deviceScore:D.b.shortData,strategyVersion:K.v},envInfo:{tag:D.M.pageName,subtag:D.M.playMode,preTag:D.M.prePageName,preSubtag:D.M.prePlayMode,isLogin:M}}}(...r,t):function(e=[],t=0,r,n,i=0,a=!0,o,l,s,d,u,c,p,v,h,y,m,g){const{channelInfo:f,regionInfo:_}=D.M.getInstance(),b=d,k=(null==p?void 0:p.open)?"h265":"h264";let P="",S="",T="",C=!1;const w=t,x=`TT-vCache-${n}`,E=G.IH.getPreloadMeta(x);P=function(e){return(0,$.Tb)("getDefaultDefinition",e),e&&e.videoQuality&&e.definition?`${e.videoQuality}_${e.definition.substring(0,e.definition.length-1)}_0`:"unknown_definition_from_xgpreload_config"}(o);const R=le(e,{defaultBitrate:t,defaultDefinition:r,url:d}),{h264Set:M,h265Set:A}=(0,W.cU)(e),I=b;let L="";b&&(L=Z(b,ie.group1,ie.group2));const j=L===te.uJ?{credentials:"include"}:{},O={channel:null==f?void 0:f.channel,channel_domain:null==f?void 0:f.domain,channel_type:null==f?void 0:f.type};S=(null==_?void 0:_.region)||"",T=(null==_?void 0:_.wid)||"",C=(null==_?void 0:_.isLogin)||!1;const V=(null==h?void 0:h.playerPreload)||{},B=(null==u?void 0:u.extInfo)||{},F=null==h?void 0:h.bitrateSelect,U={selector:(null==F?void 0:F.selector)||"default",selectConfig:(null==F?void 0:F.config)||{},quality:null==F?void 0:F.qualityType,hevcQuality:null==F?void 0:F.hevcQualityType};(0,$.Tb)("generatePlayerConfig",x,R,U);const N=D.a.getHevcDisableInfo();return{enableSubtitle:!0,enablePreloader:"0"!==(null==g?void 0:g.preloader),enableLogger:!0,preloader:Object.assign(Object.assign({minBufferLength:10,preloadCacheType:1,preloadMaxCacheCount:5,preloadTime:10,preloadSize:209715,segmentMinDuration:10,reqOptions:j},V),{getRequestOptionsCallback:se}),mp4EncryptPlayer:{closeDowngrade:!1,minBufferLength:10,maxBufferLength:30,needPreloadRangeList:!0,needPreloadCheck:!("MSE"===(null==g?void 0:g.videoPlayMode)),needAutoBitrate:!0,removeBufferLen:60,resumePlayWaterLevel:0,segmentMinDuration:10,reqOptions:j,getRequestOptionsCallback:se},logger:{appId:548444,line_app_id:1988,playerCoreVersion:"",codec_type:k,tag:D.M.pageName,preTag:D.M.prePageName,preSubtag:D.M.prePlayMode,subtag:D.M.playMode,vid:n,region:S,webId:T,uid:(null==_?void 0:_.uid)||T,isLogin:C,channelConfig:O,switchPlayerTime:v,bitrateSet:M,bitrateSetHevc:A,pIndex:(null==u?void 0:u.vIndex)||-1,ext:Object.assign(Object.assign(Object.assign({},B),N),{log_id:(null==o?void 0:o.log_id)||"",is_ad:(null==o?void 0:o.isAd)?1:0}),deviceScore:D.b.shortData,strategyVersion:K.v},video:{codecType:k,defaultBitrate:w,defaultDefinition:P,definitionList:[],duration:i,autoplay:a,volume:null!=l?l:.7,muted:s||!1,vqscore:null!=c?c:0,mvmaf:"",volumeInfo:m},extra:{url:b,actualUrl:I,vid:x,ignores:["play","start"],reqAuth:L,closeMSE:"H5"===(null==g?void 0:g.videoPlayMode)||!J(E)},hevcResult:p,bitrateList:R,bitrateAdapter:Object.assign(Object.assign({},U),{hevcQuality:(null==p?void 0:p.hevcQualityType)||28,quality:(null==p?void 0:p.qualityType)||20,userSelectResolution:y||"auto"})}}(...r,t)}var ce,pe;!function(e){e.PlayQuality="video_play_quality",e.PlayEnded="video_play_end",e.PlayFailed="video_play_failed",e.BlockStart="video_block_start",e.Block="video_block",e.Request="video_request",e.RequestResponse="video_request_response",e.FirstFrame="first_feed_show_time"}(ce||(ce={})),function(e){e[e.Public=0]="Public",e[e.Self=1]="Self",e[e.Friend=2]="Friend"}(pe||(pe={}));const ve=(e=0)=>["one_column","three_column","browser_mode","swiper_mode","video_detail","pip","fullscreen","creator_tab","mini_player","immersive_player"][e],he=e=>e?e.map((e=>e.GearName||"")):null,ye=e=>e?e.map((e=>e.QualityType&&e.Bitrate?`${e.QualityType}:${e.Bitrate}`:"")).filter((e=>!!e)):null,me=e=>{if(!e)return 0;let t=0;for(let r=0;r<e.length;r++)t+=e.end(r)-e.start(r);return Math.round(1e3*t)},ge=new Map([[2,"adapt_lowest_1080p"],[3,"adapt_lower_1080p"],[4,"adapt_1080p"],[7,"adapt_lowest_1440p"],[10,"normal_720p"],[11,"low_720p"],[12,"adapt_high_720p"],[13,"adapt_higher_720p"],[14,"adapt_lower_720p"],[15,"adapt_lowest_720p"],[16,"higher_720p"],[17,"highest_720p"],[18,"adapt_720p"],[19,"adapt_low_720p"],[191,"lower_720p"],[20,"normal_540p"],[21,"adapt_lower_540p"],[22,"adapt_high_540p"],[23,"adapt_higher_540p"],[24,"lower_540p"],[25,"lowest_540p"],[26,"higher_540p"],[27,"highest_540p"],[28,"adapt_540p"],[29,"adapt_lowest_540p"],[291,"adapt_low_540p"],[30,"normal_480p"],[31,"low_480p"],[32,"high_480p"],[33,"medium_480p"],[34,"lower_480p"],[35,"lowest_480p"],[36,"higher_480p"],[37,"highest_480p"],[38,"adapt_480p"],[39,"adapt_lower_480p"],[391,"adapt_high_480p"],[40,"normal_360p"],[41,"low_360p"],[42,"high_360p"],[43,"medium_360p"],[44,"lower_360p"],[45,"lowest_360p"],[46,"higher_360p"],[47,"highest_360p"],[48,"adapt_360p"],[49,"adapt_lowest_360p"],[50,"adapt_high_360p"]]),fe={color:"#fff",backgroundColor:"#2a9d1f",position:"absolute",zIndex:2,top:"30px"},_e=(0,i.memo)((0,i.forwardRef)((function({containerId:e="",classList:t=[],player:r,bitrateInfo:n,oncanplay:a,onplay:o,onwaiting:l,onended:s,ontimeupdate:d,onloadstart:u,onloadeddata:c,onvolumechange:p,onVideoPlayEnd:v,onResolutionReady:h,onerror:y,onpause:m,onplaying:g,onbreak:f,subtitle:_,teaParams:b,videoDimensionParams:k,mode:P,id:S,containerRef:T,hitPreload:C},w){const x=(0,i.useMemo)((()=>{var e;let t={};if(!b)return t;const n=null==r?void 0:r.attributes;let i=0;b.forFriend&&(i=2),b.secret&&(i=1);let a="";if(n&&n.src){const e=/^(?:https?:\/\/)?([^\/\s:]+)/,t=n.src.match(e);a=t?t[1]:""}const o={group_id:S,author_id:b.author_id||"",play_mode:ve(P),logo_type:"unwatermarked",item_status:i,play_url:n?n.src:"",host:a,aweme_type:b.aweme_type||0,pic_cnt:b.pic_cnt||0,playlist_id:b.playlist_id||"",popup_type:b.popup_type||"",size:b.size,log_id:b.log_id||"none",is_ad:b.isAd,video_width:k?k.video_width:0,video_height:k?k.video_height:0,video_duration:k?k.video_duration:0},{dScore:l,netScore:s}=null!==(e=D.M.getDeviceScore())&&void 0!==e?e:{},d=function(){const e=re||ne;return null==e?void 0:e.device}();return t=Object.assign({},{cpu_core:(null==d?void 0:d.cpu)||0,memory_size:(null==d?void 0:d.memory)||0,HEVC_supported:(null==d?void 0:d.isHEVCSupported)?1:0,hardware_score:l,network_score:s},o),t}),[b,k,S,P]),E=(0,i.useRef)(0),R=(0,i.useCallback)((()=>r&&b?((e,t)=>{if(!e)return t;if("string"==typeof e&&e.indexOf("xgpreload_config")>-1)return e;const r=Number(e);if(!ge.has(r)){const t=String(e).match(/^([a-zA-Z]*)+_([0-9]+)_0$/i);return t?`${t[1]}_${t[2]}p`:`_${e}`}return ge.get(r)})((r.curDefinition||{}).definition,b.definition):null),[r,b]),M=(0,i.useCallback)((()=>r&&b&&(r.curDefinition||{}).bitrate||0),[r,b]),A=(0,i.useCallback)((()=>r&&b?(r.curDefinition||{}).codecType:null),[r,b]),I=(0,i.useCallback)((()=>{let e="";if(!b)return e;const t=R();return b.videoQuality&&t&&(e=`${b.videoQuality}_${t}`),e}),[b,R]),O=(0,i.useCallback)((()=>{const e={};if(b){const t=M(),n=A(),i=I(),a=(0,F.ZQ)(),o=(null==r?void 0:r.state)||"default";let l;S&&(l=a.getPreloadCacheInfo(S)),e.video_bitrate=t||b.bitrate,e.video_format=b.format,e.codec_format=n||"h264",e.encoded_type=b.encodedType,e.bitrate_quality=b.videoQuality,e.video_quality=i,e.video_encodeUserTag=b.encodeUserTag,e.original_definition=b.definition,e.preload_size=l?l.byteLength:-1,e.preload_time=l?Math.floor(l.duration):-1,e.player_type=r?r.type:"defaultPlayer",e.video_type="mp4",e.render_state=o}return e}),[b,R,M,A,I,S,r]),V=(0,i.useCallback)((()=>{let e=!1,t=A();return t||(t="h264"),e=!!t&&t.indexOf("h265")>-1,e}),[A]),N=(0,i.useCallback)((()=>{(0,L.uQ)(j.Y.VideoRequest),x&&1!==P&&q.f.event("video_request",Object.assign(Object.assign({},x),{render_state:(null==r?void 0:r.state)||""}))}),[x,P]),H=(0,i.useCallback)((e=>{if(!x||1===P)return;let t;(null==r?void 0:r.attributes)&&(t=r.attributes.error);const n=I(),i=V(),a=Object.assign({},{duration:Math.round(e.duration),error_code:t?String(t.code):"",is_success:t?"0":"1",video_quality:n,is_bytevc1:i?1:0,isExpired:2,isSupportMP4:Number((0,Q.vk)()),render_state:(null==r?void 0:r.state)||""},x);q.f.event("video_request_response",a)}),[x,V,I,P]),z=(0,i.useCallback)((()=>{if(!x||1===P||!r)return;const{attributes:e}=r;if(e){const{readyState:t,seeking:r}=e;E.current=t<1?1:r?2:0}q.f.event("video_block_start",Object.assign(Object.assign({},x),{block_type:E.current}))}),[x,P]),W=(0,i.useCallback)((e=>{if(!x||1===P||!r)return;const t=O(),n=V();let i,a=0;r.attributes&&(i=r.attributes.error,a=r.attributes.duration);let o=e.code||0,l=e.message||"";o<=0&&i&&(o=i.code,l=i.message);const s=Object.assign({},t,{error_code:String(o),error_info:l,is_bytevc1:n?1:0,duration:Math.round(1e3*a),isExpired:e.isExpired||0,isSupportMP4:Number((0,Q.vk)()),is_before:0===e.status?0:1,retry_c:e.retryCount||0,retry_l:e.retryList||[]},x);q.f.event("video_play_failed",s)}),[x,O,V,P]),G=(0,i.useCallback)((e=>{if(null==f||f(),!x||1===P)return;const t=O(),n=V();let i,a,o=0;const l=e.currentTime;let s=0,d=1,u=!1;const c=e.duration-e.pauseDuration;(null==r?void 0:r.attributes)&&(i=r.attributes.error,o=r.attributes.duration||0,s=r.attributes.readyState,a=r.attributes.buffered,d=r.attributes.volume,u=r.attributes.muted);const p=Math.min(c,1e3*o);let h=M();h<=0&&(h=b&&b.bitrate?b.bitrate:0);const y=h/8*(p/1e3),m=Object.assign({},t,{is_success:i?"0":"1",video_duration:Math.round(1e3*o),play_duration:Math.round(1e3*l),buffering:s<=2?1:0,duration:Math.round(c),wait_duration:0,cur_cache_duration:me(a),local_time_ms:Date.now(),volume_level:d,volume_change:0,muted:u?1:0,click_mute:0,session_order:0,play_size:Math.round(y),data_player_type:2,cache_size:0,cache_duration:0,cdn_size_video:0,is_bytevc1:n?1:0,drop_frame:0,total_play_frame:0,drop_frame_rate:0,drop_frame_duration:0},x),g=function(e){var t,r;const n={isFinish:0,pt:0,vt:0,firstframeDuration:100,errorCode:0,errorMessage:"",codecType:"h264",resolution:"",url:""},i=null===(r=null===(t=null==e?void 0:e.player)||void 0===t?void 0:t.plugins)||void 0===r?void 0:r.xgVodLogger;if(null==i?void 0:i.getFinalInfo){const e=i.getFinalInfo();return Object.assign(Object.assign({},n),e)}return n}(r),_=Object.assign(Object.assign({vid:S,playPos:Math.round(1e3*l),stayDuration:0,videoQuality:1},g),{logid:(null==b?void 0:b.log_id)||"nonw"});null==v||v(_),q.f.event("video_play_end",m)}),[x,O,V,M,b,P]),K=(0,i.useCallback)((e=>{if((0,L.uQ)(j.Y.VideoFirstFrame),!x||1===P)return;const t=Object.assign({},{feed_total:e.duration},x),r=(0,L.xt)();q.f.event("first_feed_show_time",Object.assign(Object.assign({},t),r))}),[x,P]),Y=(0,i.useCallback)((e=>{if(!x||1===P)return;let t=0,i=!1;(null==r?void 0:r.attributes)&&(t=r.attributes.duration,i=r.attributes.muted);const a=V(),o=O(),l=Object.assign({},o,{duration:Math.round(e.duration),is_bytevc1:a?1:0,video_duration:Math.round(1e3*t),muted:i?1:0,bitrate_set:he(n),quality_bitrate:ye(n),duration_from_load:Math.round((null==e?void 0:e.durationFromLoaded)||0),duration_with_load:Math.round((null==e?void 0:e.durationWithLoaded)||0),is_same:0,retry_c:e.retryCount||0,retry_l:e.retryList||[]},x);q.f.event("video_play_quality",l)}),[x,V,n,O,P]),Z=(0,i.useCallback)((e=>{if(!x||1===P||(null==r?void 0:r.state)!==B.R.ACTIVE)return;const t=O();let n=0;(null==r?void 0:r.attributes)&&(n=r.attributes.currentTime);const i=V(),a=Object.assign({},t,{duration:Math.round(e.duration),is_bytevc1:i?1:0,position:Math.round(1e3*n),should_filter:"0",droppedRate:0,end_type:0,block_type:E.current},x);q.f.event("video_block",a)}),[x,V,O,P]),J=(0,i.useCallback)((e=>{e.preventDefault()}),[]),X=(0,i.useCallback)((()=>{(0,L.uQ)(j.Y.VideoCanPlay),null==a||a()}),[a]),ee=(0,i.useCallback)((e=>{null==u||u(e)}),[u]),te=(0,i.useCallback)((e=>{null==c||c(e)}),[c]),ie=(0,i.useCallback)((e=>{null==o||o(e)}),[o]),ae=(0,i.useCallback)((e=>{null==l||l(e)}),[l]),oe=(0,i.useCallback)((e=>{null==s||s(e)}),[s]),le=(0,i.useCallback)((()=>{null==d||d()}),[d]),se=(0,i.useCallback)((e=>{null==y||y(e)}),[y]),de=(0,i.useCallback)((e=>{null==m||m(e)}),[m]),ue=(0,i.useCallback)((e=>{null==g||g(e)}),[g]),ce=(0,i.useCallback)((e=>{null==p||p(e)}),[p]),pe=(0,i.useCallback)((e=>{e.id=S,null==h||h(e)}),[h,S]);return(0,i.useEffect)((()=>()=>{(null==r?void 0:r.metrics)&&r.metrics.stop()}),[S]),(0,i.useEffect)((()=>{if(null==r?void 0:r.metrics)return r.metrics.bind("PlayEnded",G),()=>{r.metrics&&r.metrics.clear("PlayEnded")}}),[G]),(0,i.useEffect)((()=>{if(null==r?void 0:r.metrics)return r.metrics.on("VideoRequest",N),r.metrics.on("VideoRequestResponse",H),r.metrics.on("BlockStart",z),r.metrics.on("Block",Z),r.metrics.on("PlayQuality",Y),r.metrics.on("PlayFailed",W),r.metrics.on("FirstFrame",K),r.element&&r.element.addEventListener("contextmenu",J),r.event&&(r.event.on("canplay",X),r.event.on("play",ie),r.event.on("waiting",ae),r.event.on("ended",oe),r.event.on("timeupdate",le),r.event.on("error",se),r.event.on("pause",de),r.event.on("playing",ue),r.event.on("loadstart",ee),r.event.on("loadeddata",te),r.event.on("volumechange",ce),r.event.on("resolutionReady",pe)),()=>{r.metrics&&(r.metrics.off("VideoRequest",N),r.metrics.off("VideoRequestResponse",H),r.metrics.off("BlockStart",z),r.metrics.off("Block",Z),r.metrics.off("PlayQuality",Y),r.metrics.off("PlayFailed",W),r.metrics.off("FirstFrame",K),r.element&&r.element.removeEventListener("contextmenu",J),r.event&&(r.event.off("canplay",X),r.event.off("play",ie),r.event.off("waiting",ae),r.event.off("ended",oe),r.event.off("timeupdate",le),r.event.off("error",se),r.event.off("pause",de),r.event.off("playing",ue),r.event.off("loadstart",ee),r.event.off("loadeddata",te),r.event.off("volumechange",ce),r.event.off("resolutionReady",pe)))}}),[ie,X,ae,oe,le,se,de,ue,ee,te,N,H,z,Z,Y,W,K,J,a,u,c,pe]),(0,U.FD)("div",{id:e,className:t.join(" "),ref:T,children:[_?(0,U.Y)("track",{default:!0,kind:"subtitles",srcLang:_.language,src:_.url}):null,$.Zr>0?(0,U.FD)("div",{style:fe,children:[null==r?void 0:r.uuid,"_",null==r?void 0:r.state,"_before_",C?"hitPreload":""]}):null]})})));var be=r(67353);const ke={Chrome:{cpuCore:0,dScore:0,score:-2,gpuScore:0,hevcQualityType:14,checkLevel:2,pageNames:["video_detail","homepage_hot","homepage_follow","others_homepage","explore_page"],playModes:["video_detail","one_column","browser_mode","immersive_player","three_column"]},Edge:{cpuCore:0,dScore:0,score:-2,gpuScore:0,hevcQualityType:14,checkLevel:2,pageNames:["video_detail","homepage_hot","homepage_follow","others_homepage","explore_page"],playModes:["video_detail","one_column","browser_mode","immersive_player","three_column"]}},Pe={mp4Preloader:null,BitrateSelector:{defaultConfig:{}},ifAddMp4Preloader:!1},Se=e=>{q.f.event("video_mse_error",e)};const Te="PlayerLife",Ce="PlayerCall",we="autoplay_was_prevented";var xe;!function(e){e.NoInteract="failed because the user didn't interact with the document first.",e.SafariNoInteract="The request is not allowed by the user agent or the platform in the current context",e.AbortRequest="new load request"}(xe||(xe={}));const Ee=(e,t)=>{var r,n,i,a,o,l,s,d,u,c,p,v;const h=null!==(n=null===(r=null==e?void 0:e.element)||void 0===r?void 0:r.error)&&void 0!==n?n:null,y=null===(i=null==e?void 0:e.element)||void 0===i?void 0:i.buffered,m=null==e?void 0:e.currentTime,g=null==e?void 0:e.type,f=(null==e?void 0:e.curDefinition)||{};return{buffered:y,currentTime:m,ended:null===(a=null==e?void 0:e.element)||void 0===a?void 0:a.ended,currentSrc:null!=t?t:null===(o=null==e?void 0:e.element)||void 0===o?void 0:o.currentSrc,duration:null==e?void 0:e.duration,readyState:null===(l=null==e?void 0:e.element)||void 0===l?void 0:l.readyState,networkState:null===(s=null==e?void 0:e.element)||void 0===s?void 0:s.networkState,error:h?{code:null==h?void 0:h.code,message:null!==(u=null===(d=null==e?void 0:e.element)||void 0===d?void 0:d.error)&&void 0!==u?u:(null==h?void 0:h.message)||"UNKNOWN_ERROR_MESSAGE",MEDIA_ERR_ABORTED:1,MEDIA_ERR_NETWORK:2,MEDIA_ERR_DECODE:3,MEDIA_ERR_SRC_NOT_SUPPORTED:4}:null,playerType:g,volume:null==e?void 0:e.volume,muted:null==e?void 0:e.muted,videoBitrate:null==f?void 0:f.bitrate,videoQuality:null==f?void 0:f.definition,codecType:null!==(c=null==f?void 0:f.codecType)&&void 0!==c?c:"h264",play_url:null!==(v=null===(p=null==e?void 0:e.element)||void 0===p?void 0:p.currentSrc)&&void 0!==v?v:t}},Re=(0,i.memo)((0,i.forwardRef)((function({id:e,url:t,mode:r,muteSetting:n,playProgress:a,duration:o,playbackRate:l=1,onLoadStart:s,onLoadedData:u,onCanPlay:p,onPause:v,onPlay:y,onPlaying:m,onTimeUpdate:g,onWaiting:f,onEnded:_,onError:b,onUnmount:k,onVideoChange:P,onBreak:S,onVideoVolumeChange:T,onVideoPlayEnd:C,onAutoplayPrevented:w,onResolutionReady:E,userResolution:R,subtitleStruct:M,subtitleList:A,curSubtitle:I,onSubtitleCallback:O=e=>{},bitrateInfo:V,defaultDefinition:Q,preloadUrlsList:W,preloader:K,defaultBitrate:Y=-1,playerInitHost:Z,teaParams:J,autoPlay:le,autoReplay:ce=!0,size:pe,pathId:he="",metrics:ye,hevcTest:me={open:!1,qualityType:20,closePreload:!1},playbackAbTestInfo:ge=F.Ah,isTTP:fe,videoDimensionParams:xe,vIndex:Re=-1,extInfo:Me={},renderState:Ae=B.R.ACTIVE,volumeInfo:Ie},Le){const[je,Oe]=(0,i.useState)(null),Ve=(0,i.useRef)(null),Be=(0,i.useRef)((new Date).getTime()),De=(0,i.useRef)(!1),Fe=(0,i.useRef)(0),Ue=(0,i.useRef)(null),Ne=(0,i.useRef)(),qe=(0,i.useRef)(null),He=(0,i.useRef)(function(){if(ee)return ee;const e={playerType:"",videoPlayMode:"",preloader:""},t=(location.search||"").replace("?","").split("&");for(let r=0;r<t.length;r++){const n=t[r].split("=");void 0!==X[n[0]]&&(e[X[n[0]]]=n[1])}return ee=e,e}()),Qe=(0,i.useRef)(Ae),$e=(0,i.useRef)(!1),ze=(0,i.useRef)(null),We=(0,h.Ul)(),Ge=(0,i.useRef)(!1),Ke=(0,i.useRef)(null),[Ye,Ze]=(0,i.useState)(!1);(0,i.useEffect)((()=>{const{playerUpgrade:e,playerH265Soft:t}=ge;let r="XG";(null==t?void 0:t.enableSoftwareH265)||(r=(null==e?void 0:e.playerType)||He.current.playerType||"XG"),$e.current="NEW_TT"===r,ze.current=function(e){return e?(ne||(ne=new G.mx({enableReuse:!1,enableMultiple:!0,minBuffer:0,defaultMSE:!1})),ne):(re||(re=new G.SN({enableReuse:!1,enableMultiple:!0,minBuffer:0,defaultMSE:!1})),re)}($e.current)}),[]),function(e){e&&(ie=e)}(Z);const[Je,Xe]=(0,i.useState)(!1),et=(0,c.i3)(),tt=1===r?n:n||et;const rt=(0,c.R4)(),nt=(0,c.S4)().setMute,it=ve(r);D.M.playMode=it,D.M.pageName=he;const{hevcIgnoreEnv:at}=ge,ot=D.M.checkHevcResult(1===at),lt=(0,i.useCallback)(((e,t)=>{var n,i,a,o,l,s;const d={mode:r,pathId:he};if("MP4_2"===e){if(Ue.current)try{const e=null===(n=Ue.current)||void 0===n?void 0:n.element;Object.assign(d,{currentTime:null!==(i=null==e?void 0:e.currentTime)&&void 0!==i?i:0,codec:null!==(l=null===(o=null===(a=Ue.current)||void 0===a?void 0:a.curDefinition)||void 0===o?void 0:o.codecType)&&void 0!==l?l:"",duration:null!==(s=null==e?void 0:e.duration)&&void 0!==s?s:0})}catch(e){console.error("playCatch error")}!function(e,t){var r,n,i,a,o,l,s,d,u;const c={code:null!==(r=t.errorCode)&&void 0!==r?r:0,message:null!==(n=t.errorMessage)&&void 0!==n?n:"",httpCode:null!==(i=t.httpCode)&&void 0!==i?i:0,url:null!==(a=t.url)&&void 0!==a?a:"",type:e,responseMsg:"",xCache:"",via:"",mode:null!==(o=t.mode)&&void 0!==o?o:"",pathId:null!==(l=t.pathId)&&void 0!==l?l:"",currentTime:null!==(s=t.currentTime)&&void 0!==s?s:0,codec:null!==(d=t.codec)&&void 0!==d?d:"",duration:null!==(u=t.duration)&&void 0!==u?u:0};(null==t?void 0:t.response)?function(e){const t={responseMsg:""};return new Promise((r=>{try{e.headers.forEach(((e,r)=>{t[r.toLocaleLowerCase()]=e})),e.text().then((n=>{e.text=n;const i=n.toLocaleLowerCase(),a=/<body>(([\s\S])*?)<\/body>/.exec(i),o=document.createElement("div");o.innerHTML=a?a[1]:"";const l=o.children;let s="";for(let e=0;e<l.length;e++)s+=`${l[e].innerText}|`;t.responseMsg=s,r(t)})).catch((()=>{r(t)}))}catch(e){r(t)}}))}(t.response).then((t=>{var r,n,i;c.responseMsg=null!==(r=t.responseMsg)&&void 0!==r?r:"",c.xCache=null!==(n=t["x-cache"])&&void 0!==n?n:"",c.via=null!==(i=t.via)&&void 0!==i?i:"",console.info(`>>>>>${e} parseResponse`,c),Se(c)})).catch((()=>{c.code=-1e3,Se(c),console.info("parse response error")})):Se(c)}("running",Object.assign(t,d))}(0,be.AX)(t)&&oe(ze.current,"h264")}),[e,r,he,qe]),st=(0,i.useCallback)((()=>{null==w||w()}),[e,r,he]);(0,i.useEffect)((()=>{var e,t;(0,d.Cd)(null!==(e=null==We?void 0:We.id)&&void 0!==e?e:""),K.setPreloadIndex(null!==(t=null==We?void 0:We.index)&&void 0!==t?t:0)}),[We]),(0,i.useEffect)((()=>{const{hevcResultLocal:e}=ge;D.a.getInstance().needPersist=0===e,D.M.setHevcEffectiveConditions(ke)}),[]),(0,i.useEffect)((()=>{(0,$.Tb)(Ce,"changePreloadCodec",ot.open),oe(ze.current,ot.open?"h265":"h264"),G.Tz.updateConfig({hevcQuality:ot.hevcQualityType,quality:ot.qualityType})}),[e,ot.open,ot.openSrc]);const dt=(0,i.useCallback)((e=>{var t;const r=e.player;if(!r)return;const n=r.element;(0,be.y8)(n)&&((e=>{const{H264DefinitionList:t}=e.config;if(t&&t.length>0){const r=t[0];e.emit("playCatch","MP4_3",{errorCode:8200,message:"width and height is 0"}),e.setConfig({defaultBitrate:r.bitrate,defaultDefinition:r.definition,url:r.url,codecType:r.codecType}),e.src=r.url,e.play()}})(r),oe(ze.current,"h264")),null===(t=Ue.current)||void 0===t||t.off("loadedmetadata",dt)}),[e,r,he,qe]),ut=t=>{(0,$.Tb)(Ce,"handlerPreloadInfoReady",t),(0,F.ZQ)().setPreloadCacheInfo(e,t),Ze(!0)},ct=(0,i.useMemo)((()=>A&&A.length>0?A:[]),[A]),pt=(0,i.useMemo)((()=>W.length),[e,W]);(0,i.useEffect)((()=>{const{playerPreload:t,hevcIgnoreEnv:r}=ge,n="number"==typeof(i=(null==t?void 0:t.vid)||"v0")?i:"boolean"==typeof i?i?1:0:0===i.indexOf("v")&&2===i.length?parseInt(i[1],10):parseInt(i,10);var i;(0,$.Tb)(Te,"addPreloadList",e,W.map((e=>e[0].id))),n>0&&ae(ze.current,W,0,r)}),[e,pt]),(0,i.useEffect)((()=>{var e,t,r,n,i;ct.length>0?(Ne.current?Ne.current.setSubTitles(ct):(Ne.current=new G.SX({subTitlesList:ct}),null===(e=Ne.current)||void 0===e||e.on("update",(e=>{O(e)})),null===(t=Ne.current)||void 0===t||t.on("change",(e=>{O(e)})),null===(r=Ne.current)||void 0===r||r.on("error",(e=>{O(e)}))),Ue.current&&Ne.current.attach(null===(n=Ue.current)||void 0===n?void 0:n.element)):null===(i=Ne.current)||void 0===i||i.switchOff()}),[ct,e]),(0,i.useEffect)((()=>{var e,t;I?null===(t=Ne.current)||void 0===t||t.switch(I):null===(e=Ne.current)||void 0===e||e.switchOff()}),[I,e]),(0,i.useEffect)((()=>{Ue.current&&(null==ye||ye.setPlayerType(1))}),[ye,je]),(0,i.useEffect)((()=>{var t,r;(0,$.Tb)(Te,"renderState",null===(t=Ue.current)||void 0===t?void 0:t.uuid,e,Ae,tt,rt);let n=Ae;if(Ue.current){Ae===B.R.BACKUP&&(n=B.R.RETAIN);const e=ze.current;null==e||e.updatePlayer(Ue.current,n),de(Qe.current)&&le&&(Ue.current.play(),Ue.current.forceAutoplay=!1),n!==B.R.ACTIVE&&Ue.current.pause()}else Ae===B.R.RETAIN&&(n=B.R.BACKUP);(0,$.Tb)(Te,"renderStateChange",e,null===(r=Ue.current)||void 0===r?void 0:r.uuid,`renderState:${Ae} state:${n} muted:${tt} volume:${rt} autoplay:${le}`),Qe.current=n}),[Ae]),(0,i.useEffect)((()=>{var r;if(!je){be.bt.hevcTest=me;const n={vIndex:Re,extInfo:Object.assign(Object.assign({},Me),{log_id:(null==J?void 0:J.log_id)||"none",is_ad:(null==J?void 0:J.isAd)?1:0})},i=ue($e.current,He.current,V,Y,Q,e,o,le,J,rt,tt,t,n,0,ot,Be.current,ge,R,Ie);Ge.current=!1,Ke.current=null,Ve.current=i;const a=ze.current,l=a.usePlayer(i,Qe.current);a.mountDom(l,qe.current),ae(ze.current,W,0,ge.hevcIgnoreEnv),(0,$.Tb)(Te,"usePlayer",l.uuid,e,`autoPlay:${le} volume:${rt} mute:${tt} playMode:${it}`,i,it,he,ot),l.on("playCatch",lt),l.on("autoplay_was_prevented",st),l.on(te.Wu,ut),l&&(Ue.current=l,null===(r=Ne.current)||void 0===r||r.attach(l.player),Oe("xgplayer")),z.DS.setCustomTracker({event:(e,t)=>{q.f.event(e,t)}}),a.setCustomTracker({event:(e,t)=>{(0,$.Tb)("VodLogger",e,t),q.f.event(e,t)}})}}),[pe,e,t,r,K,nt,Q,fe]),(0,i.useEffect)((()=>{if(!je)return;const{mp4Preloader:e}=Pe;if(e){const t=e=>{var t,r;const n={task_type:2,cdn_size:e.len,cdn_speed:e.speed,project:"webapp-desktop",is_hevc:(null===(r=null===(t=Ue.current)||void 0===t?void 0:t.curDefinition)||void 0===r?void 0:r.codecType)||""};(0,H.k)(n),null==ye||ye.videoQualityReport.msePlayerCacheUpdate(e.len)};return e.on("real_time_speed",t),()=>{e.off("real_time_speed",t)}}}),[je,ye]),(0,i.useEffect)((()=>{var e;if(je&&Ue.current){const t=e=>{const t={task_type:1,cdn_size:e.cdn_size,cdn_speed:e.cdn_speed,project:"webapp-desktop"};(0,H.k)(t),null==ye||ye.videoQualityReport.msePlayerCacheUpdate(e.cdn_size)};return null===(e=Ue.current)||void 0===e||e.on("prf_data_size",t),()=>{var e;null===(e=Ue.current)||void 0===e||e.off("prf_data_size",t)}}}),[je,ye]);const vt=(0,i.useCallback)((e=>{null==y||y(e)}),[y]),ht=(0,c.VN)();(0,i.useImperativeHandle)(Le,(()=>{const n=Ue.current;return{play:()=>(0,x.__awaiter)(this,void 0,void 0,(function*(){var e,t;if((0,$.Tb)(Ce,"play",null===(e=Ue.current)||void 0===e?void 0:e.uuid,Qe.current,!de(Qe.current)),!Ue.current||!de(Qe.current))return Promise.resolve();try{yield null===(t=Ue.current)||void 0===t?void 0:t.play()}catch(e){console.info("Video play error: ",e)}})),pause:()=>{var t,n;(0,$.Tb)(Ce,"pause",null===(t=Ue.current)||void 0===t?void 0:t.uuid,Qe.current);try{null===(n=Ue.current)||void 0===n||n.pause(),N.A.emit("video_pause",{itemId:e,playMode:r})}catch(e){console.info("Video pause error: ",e)}},seek:t=>{if((0,$.Tb)(Ce,"seek",t),n){N.A.emit("video_seek",{itemId:e,playMode:r});const i=n.duration;i&&Ue.current&&Ue.current.seek(i*t)}},seekTime:e=>{null==n||n.seek(e)},onSeeked:e=>{null==n||n.on("seeked",e)},onSeeking:e=>{null==n||n.on("seeking",e)},onTimeUpdate:e=>{null==n||n.on("timeupdate",(()=>{var t,r;const i=null!==(t=null==n?void 0:n.currentTime)&&void 0!==t?t:0,a=null!==(r=null==n?void 0:n.duration)&&void 0!==r?r:0;e(i/a,i,a)}))},onCanPlay:e=>{null==n||n.on("canplay",e)},getFullscreen:e=>(0,x.__awaiter)(this,void 0,void 0,(function*(){yield null==n?void 0:n.enterFullscreen(e)})),exitFullscreen:e=>(0,x.__awaiter)(this,void 0,void 0,(function*(){yield null==n?void 0:n.exitFullscreen(e)})),getPlayerAttributes:()=>Ee(n,t),replay:()=>{(null==n?void 0:n.replay)&&(null==n||n.replay())},getPlaybackQuality:()=>{var e;return null===(e=null==n?void 0:n.element)||void 0===e?void 0:e.getVideoPlaybackQuality()},updatePlayer:e=>{var t;Ue.current&&(null===(t=ze.current)||void 0===t||t.updatePlayer(Ue.current,Ae))},changeResolution:e=>{var t;Ue.current&&(null===(t=ze.current)||void 0===t||t.changeResolution(Ue.current,e))},getResolutionInfo:()=>{var e;return Ue.current?null===(e=ze.current)||void 0===e?void 0:e.getResolutionInfo(Ue.current):null},get renderState(){return Qe.current}}}));const yt=(0,i.useCallback)(((e=0)=>(0,x.__awaiter)(this,void 0,void 0,(function*(){var t,r,n,i,a;if(de(Qe.current)&&!(e>=3))try{const e=null===(t=Ue.current)||void 0===t?void 0:t.player;(null==e?void 0:e.isCanplay)?yield null===(r=Ue.current)||void 0===r?void 0:r.play():null===(n=Ue.current)||void 0===n||n.on("canplay",(()=>(0,x.__awaiter)(this,void 0,void 0,(function*(){var e;de(Qe.current)&&(yield null===(e=Ue.current)||void 0===e?void 0:e.play())}))))}catch(t){const r=null!==(i=t.message)&&void 0!==i?i:"",n=r.indexOf("new load request")>-1,o=null!==(a=r.match("failed because the user didn't interact with the document first."))&&void 0!==a?a:r.match("The request is not allowed by the user agent or the platform in the current context");if(n)return;o?(nt(!0),setTimeout((()=>{yt(e+1)}),0)):yt(e+1)}}))),[nt]),mt=(0,i.useCallback)((()=>{var t,n;try{(null===(t=Ue.current)||void 0===t?void 0:t.replay)&&(null===(n=Ue.current)||void 0===n||n.replay()),N.A.emit("video_replay",{itemId:e,playMode:r})}catch(e){setTimeout((()=>{nt(!0)}),0)}}),[nt,e,r]);(0,i.useEffect)((()=>{je&&Ue.current&&(Ue.current.volume=rt,Ue.current.muted=tt,Ue.current.playbackRate=l,null==T||T(tt?0:rt))}),[je,tt,l,rt,T]),(0,i.useEffect)((()=>{const t=Ue.current;if(!je||!t||!de(Qe.current))return;const n="undefined"!=typeof document&&!document.hidden;le&&je&&(8===r||n)&&yt(),(0,$.Tb)("videoCanplay",e,t.uuid,t.currentTime,a,`videoCanplay:${Je} autoPlay:${le}`),4!==r&&t&&Math.abs(t.currentTime-a)>.2&&Je&&t.seek(a)}),[Je,le,a,yt,je,r]);const gt=(0,i.useCallback)((e=>{var t;(0,$.Tb)("callback handlePlayerWaiting",null===(t=Ue.current)||void 0===t?void 0:t.uuid),je&&(null==f||f(e))}),[je,f]),ft=(0,i.useCallback)((()=>{je&&(null==S||S())}),[je,S]),_t=(0,i.useCallback)((e=>{var t;(0,$.Tb)("callback handlePlayerEnded",null===(t=Ue.current)||void 0===t?void 0:t.uuid),je&&(null==_||_(e),ce&&mt())}),[je,_,mt,ce]),bt=(0,i.useCallback)((e=>{var t,r,n;(0,$.Tb)("callback handleLoadStart",null===(t=Ue.current)||void 0===t?void 0:t.uuid);const i=null===(r=Ue.current)||void 0===r?void 0:r.element,a=i?null==i?void 0:i.style.background:null;Ge.current&&(null===(n=null==Ue?void 0:Ue.current)||void 0===n?void 0:n.element)&&(Ke.current=a||"",Ue.current.element.style.background="#000"),null==s||s(e)}),[s]),kt=(0,i.useCallback)((e=>{var t;(0,$.Tb)("callback handleLoadedData",null===(t=Ue.current)||void 0===t?void 0:t.uuid),Ge.current=!0,null==u||u(e)}),[u]),Pt=(0,i.useCallback)((e=>{if(!Ue.current)return;const{volume:t,muted:r,uuid:n}=Ue.current;(0,$.Tb)("callback handlerVolumeChange",n,t,r),de(Qe.current)&&r&&nt(!0),null==T||T(r?0:t)}),[T]),St=(0,i.useCallback)((()=>{null==g||g()}),[g]),Tt=(0,i.useCallback)((e=>{null==b||b(e)}),[b]),Ct=(0,i.useCallback)((()=>{var e;null==p||p(),Xe(!0);const t=Ke.current;(null===(e=null==Ue?void 0:Ue.current)||void 0===e?void 0:e.element)&&null!==t&&(Ue.current.element.style.background=t,Ke.current=null)}),[p]),wt=(0,i.useCallback)((e=>{var t;(0,$.Tb)("callback handlePause",null===(t=Ue.current)||void 0===t?void 0:t.uuid),null==v||v(e)}),[v]),xt=(0,i.useCallback)((e=>{var t;(0,$.Tb)("callback handlePlaying",null===(t=Ue.current)||void 0===t?void 0:t.uuid),null==m||m(e)}),[m]),Et=(0,i.useCallback)((t=>{var n;(0,$.Tb)(Ce,"handlePrevention",null===(n=Ue.current)||void 0===n?void 0:n.uuid,e,Qe.current),je&&setTimeout((()=>{try{if(!de(Qe.current))return;if(Fe.current>=3)return void(null==w||w());if("xgplayer"===je||!(null==t?void 0:t.errorName)||"NotAllowedError"===(null==t?void 0:t.errorName)){if(8===r)return void wt(t);nt(!0);const e=Ue.current;Ue.current&&(Ue.current.muted=!0),null==e||e.play()}Fe.current+=1}catch(e){console.error("handle autoplay error",e)}}),0)}),[je,r]);return(0,i.useEffect)((()=>{if(!je)return;const e=Ue.current;return null==e||e.on(we,Et),()=>{var e;(null===(e=Ue.current)||void 0===e?void 0:e.element)&&Ue.current.off(we,Et)}}),[je,Et]),(0,i.useEffect)((()=>{if(je)return()=>{var e;const t=Ue.current;(0,$.Tb)(Te,"release off events",null===(e=Ue.current)||void 0===e?void 0:e.uuid),t&&(t.off("playCatch",lt),t.off(te.Wu,ut),t.off("autoplay_was_prevented",st))};((e,t)=>{const{playerPreload:r}=t;window.MultiMediaPreloader=G.IH,e&&e.updatePreloadConfig(Object.assign({getRequestOptionsCallback:se},r)),(0,F.as)((null==r?void 0:r.maxQueueCount)||3)})(ze.current,ge)}),[je,lt]),(0,i.useEffect)((()=>{var t,r;(0,$.Tb)(Ce,"playing",null===(t=Ue.current)||void 0===t?void 0:t.uuid,e,Qe.current,`playing:${ht} isPausedForced:${De.current}`),ht?De.current&&le&&(De.current=!1,yt()):(De.current=!0,null===(r=Ue.current)||void 0===r||r.pause())}),[le,ht,yt]),(0,i.useEffect)((()=>()=>{var e,t,r,n,i,a;const o=null===(r=null===(t=null===(e=Ue.current)||void 0===e?void 0:e.element)||void 0===t?void 0:t.getVideoPlaybackQuality)||void 0===r?void 0:r.call(t);if(o){null==ye||ye.updateFrameInfo({drop_frame:o.droppedVideoFrames,total_play_frame:o.totalVideoFrames,drop_frame_rate:o.droppedVideoFrames/o.totalVideoFrames,drop_frame_duration:o.creationTime});const e=null!==(a=null===(i=null===(n=Ue.current)||void 0===n?void 0:n.curDefinition)||void 0===i?void 0:i.codecType)&&void 0!==a?a:"";be.bt.setDropRate(o.droppedVideoFrames,o.totalVideoFrames,e)}}),[]),(0,i.useEffect)((()=>()=>{(0,L.uQ)(j.Y.PlayerDestroy),k(Ee(Ue.current,t))}),[]),(0,i.useEffect)((()=>{var n;return(0,$.Tb)(Te,"releasePlayer0",null===(n=Ue.current)||void 0===n?void 0:n.uuid,e),()=>{var n,i,a,o,l,s,d;null===(n=Pe.mp4Preloader)||void 0===n||n.cancelLoading(),null===(a=null===(i=Ue.current)||void 0===i?void 0:i.metrics)||void 0===a||a.stop(),(0,$.Tb)(Te,"releasePlayer1",null===(o=Ue.current)||void 0===o?void 0:o.uuid,e,Qe,t,r),null===(l=ze.current)||void 0===l||l.releasePlayer(Ue.current),null===(s=Ne.current)||void 0===s||s.detach(),null===(d=Ne.current)||void 0===d||d.destroy(),Ne.current=null,Xe(!1),Ue.current=null,null==P||P(!1)}}),[]),(0,U.Y)(_e,{containerId:`xgwrapper-${r}-${e}`,classList:["xgplayer-container","tiktok-web-player"],player:Ue.current,containerRef:qe,bitrateInfo:V,oncanplay:Ct,onplay:vt,onwaiting:gt,onended:_t,onbreak:ft,ontimeupdate:St,onerror:Tt,onpause:wt,onplaying:xt,onloadstart:bt,onloadeddata:kt,onvolumechange:Pt,onVideoPlayEnd:C,onResolutionReady:E,subtitle:4===r&&M?M:void 0,teaParams:J,videoDimensionParams:xe,hitPreload:Ye,mode:r,id:e})})));var Me=r(64116),Ae=r(33805),Ie=r(53438),Le=r(48615),je=r(49057),Oe=r(99282),Ve=r(52333),Be=r(32098);let De=null,Fe=null;const Ue=(0,i.memo)((0,i.forwardRef)((function({poster:e,videoCover:t,lazyLoading:r=!0,horizontal:d,playUrl:k,id:w,teaParams:R,index:A,mode:U,itemMute:N,desc:q,topSearchQueryAfterViewWord:H,duration:Q,playbackRate:$=1,onVideoPause:z=I(),onVideoPlaying:W=I(),onVideoPlay:G,onVideoEnded:K,onVideoError:Y,onTimeUpdate:Z,onLoadStart:J,onLoadedData:X,onVolumeChange:ee,onVideoUnmount:te,onUserHandlePlayVideo:re,onUserHandlePauseVideo:ne,onVideoInit:ie=I(),e2eTag:ae,subtitleStruct:oe,subtitleList:le,curSubtitle:se,onSubtitleCallback:de,onResolutionReady:ue,disableDownload:ce=!0,volumeInfo:pe=I(),adaptBitrateVid:ve,bitrateInfo:he,bitrate:ye,posterStyle:me,playModeForTea:ge,autoPlay:fe=!0,autoReplay:_e=!0,size:be,playerStyle:ke,fetchPriority:Pe="auto",renderState:Se=B.R.ACTIVE},Te){var Ce,we,xe,Ee,Ue;const Ne=(0,h.Ul)(),qe=null!==(Ce=(0,p.eu)())&&void 0!==Ce&&Ce,He=(0,c.ol)(),Qe=(0,h.hM)(),{actualResolution:$e}=(0,C.qW)(),ze=(0,h.fD)(),We=(0,o.Nj)(l.Gs),Ge=(0,o.Nj)(s.AU),Ke=(0,i.useRef)(null),Ye=(0,i.useRef)(null),Ze=(0,p.J3)(),Je=(0,c.S4)(),Xe=(0,a.HL)(),[et,tt]=(0,i.useState)(!1),[rt,nt]=(0,i.useState)(k),[it,at]=(0,i.useState)(!1),ot=(0,i.useRef)(null),lt=(0,E.w)(Ve.k),st=(0,a.qZ)(),dt=(0,o.Nj)(y.V$),ut=null!=ge?ge:U;if(De||(De=(0,O.V)(),De&&(D.M.getInstance().channelInfo={domain:De.tea,channel:De.teaChannel,type:null!==(we=De.teaChannelType)&&void 0!==we?we:"tcpy"})),!Fe&&(Fe=(0,V.x)(),Fe)){const{user:e,wid:t,region:r,odinId:n}=Fe;D.M.regionInfo={region:r,uid:(null==e?void 0:e.uid)||n||t,wid:t,isLogin:Boolean(e)}}const ct=(0,h.w)(A,U,w),pt=[B.R.ACTIVE,B.R.BACKUP,B.R.RETAIN].includes(Se)&&0===ut;(0,i.useEffect)((()=>{var e;let t=Se;Ke.current&&t===B.R.BACKUP?t=B.R.RETAIN:Ke.current||t!==B.R.RETAIN||(t=B.R.BACKUP),null===(e=ot.current)||void 0===e||e.setRenderState(t||"")}),[Se]),(0,i.useEffect)((()=>{if(Ne){const{index:e}=Ne;if(M()(e)&&(A-e<0||A-e>=3))return void(it&&(at(!1),ot.current=null))}if(!it){const e=new u("webapp-desktop",{playReport:We,experienceReport:Ge});at(!0),ot.current=e}}),[it,Ne,A,We,Ge]);const vt=(0,i.useCallback)((()=>{var e,t;try{null==re||re(),null===(t=null===(e=Ke.current)||void 0===e?void 0:e.play)||void 0===t||t.call(e)}catch(e){}}),[]),ht=(0,i.useCallback)((()=>{var e,t;null===(t=null===(e=Ke.current)||void 0===e?void 0:e.pause)||void 0===t||t.call(e),null==ne||ne()}),[]);(0,i.useEffect)((()=>{const{id:e,mode:t}=null!=Ne?Ne:{};e===w&&U===t||nt(k)}),[Ne,w,U,k]),(0,i.useEffect)((()=>{ct||tt(!1)}),[ct]),(0,i.useImperativeHandle)(Te,(()=>({play:e=>{vt(),Ye.current=!0,e&&We.triggerResume({enter_method:"click_resume",playMode:U})},pause:()=>{ht(),Ye.current=!1,We.triggerPause({enter_method:"click_pause",playMode:ut,currentBackendSourceEventTracking:R.currentBackendSourceEventTracking})},seek:e=>{var t;null===(t=Ke.current)||void 0===t||t.seek(e)},seekTime:e=>{var t;null===(t=Ke.current)||void 0===t||t.seekTime(e)},onSeeked:e=>{var t;null===(t=Ke.current)||void 0===t||t.onSeeked(e)},onSeeking:e=>{var t;null===(t=Ke.current)||void 0===t||t.onSeeking(e)},onTimeUpdate:e=>{var t;null===(t=Ke.current)||void 0===t||t.onTimeUpdate(e)},getFullscreen:e=>{var t;null===(t=Ke.current)||void 0===t||t.getFullscreen(e)},exitFullscreen:e=>{var t;null===(t=Ke.current)||void 0===t||t.exitFullscreen(e)},replay:()=>{var e;null===(e=Ke.current)||void 0===e||e.replay()},updatePlayer:e=>{var t;null===(t=Ke.current)||void 0===t||t.updatePlayer(e)},changeResolution:e=>{var t;null===(t=Ke.current)||void 0===t||t.changeResolution(e)},getResolutionInfo:()=>{var e;return null===(e=Ke.current)||void 0===e?void 0:e.getResolutionInfo()},get currentTime(){var e,t;return null!==(t=null===(e=Ke.current)||void 0===e?void 0:e.getPlayerAttributes().currentTime)&&void 0!==t?t:0},get duration(){var e,t;return null!==(t=null===(e=Ke.current)||void 0===e?void 0:e.getPlayerAttributes().duration)&&void 0!==t?t:0},get currentCanPlay(){return ct&&et}})),[et,ct,ht,vt,We,ut,R.currentBackendSourceEventTracking]);const yt=(0,m.jj)();(0,i.useEffect)((()=>{var e;const t=null===Ye.current||Ye.current,{ended:r}=(0,g.L$)(null===(e=Ke.current)||void 0===e?void 0:e.getPlayerAttributes());yt&&t&&fe&&(!r||_e)||8===U&&t?vt():(ht(),ct&&!yt&&We.triggerPause({enter_method:"switch_tab",playMode:ut,currentBackendSourceEventTracking:R.currentBackendSourceEventTracking}))}),[fe,yt,vt,ht,We,ct,ut,_e,U,R.currentBackendSourceEventTracking]);const mt=(0,Ie.Zd)({id:w}),gt=(0,Ie.Hs)(w),ft=(0,Ie.yy)(w,A),_t=(0,Oe.WH)(w),bt=(0,i.useMemo)((()=>{var e;const{videoQuality:t}=(0,g.L$)(null===(e=Ke.current)||void 0===e?void 0:e.getPlayerAttributes()),{definition:r}=R;return(0,Me.H4)(t,r)}),[R]),kt=(0,i.useCallback)((()=>{var e;const t=(0,g.L$)(null===(e=Ke.current)||void 0===e?void 0:e.getPlayerAttributes()),{videoBitrate:r,videoQuality:n,codecType:i}=t,a=(0,x.__rest)(t,["videoBitrate","videoQuality","codecType"]),{bitrate:o,author_id:l,format:s,encodedType:d,videoQuality:u,encodeUserTag:c,secret:p,forFriend:v,definition:h,playlist_id:y,popup_type:m,size:f}=R;return Object.assign(Object.assign(Object.assign(Object.assign({id:w,authorId:l,playMode:ut,bitrate:null!=r?r:o,format:s,encodedType:d,videoQuality:u,encodeUserTag:c,codecType:i,definition:bt,secret:p,forFriend:v,originalDefinition:h,playlist_id:y,popupType:m},null!=a?a:{}),gt),ft),{size:f})}),[w,R,bt,ut,gt,ft]),Pt=(0,c.i3)(),St=(0,i.useMemo)((()=>{const{group_id:e,author_id:t,is_scheduled:r,search_id:n,search_keyword:i,search_result_id:a,question_id:o,collection_id:l,collection_name:s,isPaidPartnership:d,poi_id:u,playlist_id:c,popup_type:p,enter_tab:v,diversify_id:h,enter_method:y,is_sub_only_video:m,tab_name:g,isPinnedItem:f,isReposted:_,is_just_watched:b,index_from_just_watched:k,currentBackendSourceEventTracking:P}=R;return Object.assign(Object.assign(Object.assign({itemId:e,authorId:t,isScheduled:Boolean(r),autoplayStatus:1,searchId:n,searchKeyword:i,searchResultId:a,questionId:o,playMode:ut,isMute:Pt,collectionId:l,collectionName:s,isPaidPartnership:Boolean(d),poiId:u,playlistId:c,popupType:p,enterTab:v,diversifyId:h,enterMethod:y,isSubOnlyVideo:m,isCopyrightMuted:N,isPinnedItem:f,isReposted:_,tab_name:g,isAutoScroll:qe,resolution:$e,is_auto_resolution:ze,is_just_watched:b,index_from_just_watched:k,currentBackendSourceEventTracking:P},gt),ft),_t)}),[Pt,N,R,qe,$e,ze,ut,gt,ft,_t]),Tt=(0,i.useCallback)((()=>{var e;const{currentTime:t=0,duration:r=0}=(0,g.L$)(null===(e=Ke.current)||void 0===e?void 0:e.getPlayerAttributes());return Object.assign(Object.assign({},St),{currentTime:t,duration:r,index:A})}),[A,St]);(0,i.useEffect)((()=>{R&&it&&ot.current&&(ot.current.videoPlayHandleParams=Tt())}),[Tt,R,it]);const Ct=(0,i.useMemo)((()=>(0,v.fU)()?"":(0,Ae.N2)(window.location.pathname)),[]),{loading:wt,handleCanPlayWithLoading:xt,handlePauseWithLoading:Et,handlePlayingWithLoading:Rt,handleWaitingWithLoading:Mt}=(0,m.iJ)({isCurrentVideo:ct}),At=(0,i.useCallback)((()=>{var e,t,r;null===(e=ot.current)||void 0===e||e.updateMetricsParams({playbackAttribute:null===(t=Ke.current)||void 0===t?void 0:t.getPlayerAttributes(),videoQualityParams:kt()}),null===(r=ot.current)||void 0===r||r.onLoadStart(),null==J||J()}),[kt]),It=(0,i.useCallback)((()=>{var e,t,r;null===(e=ot.current)||void 0===e||e.updateMetricsParams({playbackAttribute:null===(t=Ke.current)||void 0===t?void 0:t.getPlayerAttributes(),videoQualityParams:kt()}),null===(r=ot.current)||void 0===r||r.onLoadedData(),null==X||X()}),[kt]),Lt=(0,i.useCallback)((()=>{var e,t,r;null===(e=ot.current)||void 0===e||e.updateMetricsParams({playbackAttribute:null===(t=Ke.current)||void 0===t?void 0:t.getPlayerAttributes(),videoQualityParams:kt()}),xt(),tt(!0),null==ie||ie(!0),null===(r=ot.current)||void 0===r||r.onCanPlay()}),[kt,xt,ie]),jt=(0,i.useCallback)((e=>{var t,r,n;null===(t=ot.current)||void 0===t||t.updateMetricsParams({playbackAttribute:null===(r=Ke.current)||void 0===r?void 0:r.getPlayerAttributes(),videoQualityParams:kt()}),null===(n=ot.current)||void 0===n||n.onPlay(),null==G||G(e),lt.addMlModelTrainData({id:w,action:"play",isPreview:1===U||7===U}),Je.setCanAutoPlay(!0)}),[kt,G,w,lt,U]),Ot=(0,i.useCallback)((()=>{var e,t,r,n;const{currentTime:i=0,duration:a=0,playerType:o}=(0,g.L$)(null===(e=Ke.current)||void 0===e?void 0:e.getPlayerAttributes()),l=(0,F.ZQ)(),{byteLength:s,duration:d}=l.getPreloadCacheInfo(w);null===(t=ot.current)||void 0===t||t.updateMetricsParams({playbackAttribute:Object.assign(Object.assign(Object.assign({},mt),null===(r=Ke.current)||void 0===r?void 0:r.getPlayerAttributes()),{preload_size:s,preload_time:d,player_type:o,bitrateInfo:he}),videoQualityParams:kt()}),null===(n=ot.current)||void 0===n||n.onTimeUpdate(),null==Z||Z(i/a),S.e.handleFirstFrameVideo()}),[kt,Z,w,he,mt]),Vt=(0,m.TL)(),Bt=(0,i.useCallback)((e=>{const{httpCode:t=-1,errorCode:r=-1,errorMessage:n="",url:i="",response:a="",mode:o="",pathId:l=""}=e;dt.emitEvent("video_mse_error",{},{httpCode:String(t),errorCode:String(r),errorMessage:n,url:i,response:a,mode:o,pathId:l})}),[dt]),Dt=(0,i.useCallback)((e=>{var t,r,n,i;Ze.setPlayerError(),null==Y||Y(e);const a=kt(),o=null===(t=Ke.current)||void 0===t?void 0:t.getPlayerAttributes();Vt(Object.assign(Object.assign({},o),a)),null===(r=ot.current)||void 0===r||r.updateMetricsParams({playbackAttribute:null===(n=Ke.current)||void 0===n?void 0:n.getPlayerAttributes(),videoQualityParams:kt()}),null===(i=ot.current)||void 0===i||i.onError()}),[kt,Y,Vt]),Ft=(0,i.useCallback)((e=>{var t,r,n;z(e),Et(),null===(t=ot.current)||void 0===t||t.updateMetricsParams({playbackAttribute:null===(r=Ke.current)||void 0===r?void 0:r.getPlayerAttributes(),videoQualityParams:kt()}),null===(n=ot.current)||void 0===n||n.onPause(),lt.addMlModelTrainData({id:w,action:"pause"})}),[kt,z,Et,w,lt]),Ut=(0,i.useCallback)((e=>{var t,r,n;W(e),Rt(),null===(t=ot.current)||void 0===t||t.updateMetricsParams({playbackAttribute:null===(r=Ke.current)||void 0===r?void 0:r.getPlayerAttributes(),videoQualityParams:kt()}),null===(n=ot.current)||void 0===n||n.onPlaying()}),[kt,W,Rt]),Nt=(0,i.useCallback)((()=>{var e,t,r,n,i,a;Mt();const o=null===(e=Ke.current)||void 0===e?void 0:e.getPlayerAttributes();if(o){null===(t=ot.current)||void 0===t||t.updateMetricsParams({playbackAttribute:null===(r=Ke.current)||void 0===r?void 0:r.getPlayerAttributes(),videoQualityParams:kt()});const{buffered:e,currentTime:l=0,duration:s=0}=o,d=(null!==(n=null==e?void 0:e.length)&&void 0!==n?n:0)>0&&null!==(i=null==e?void 0:e.start(0))&&void 0!==i?i:0;if(Math.abs(d-l)<.5)return;if(Math.abs(s-l)<.5)return;null===(a=ot.current)||void 0===a||a.onWaiting(),lt.addMlModelTrainData({id:w,action:"wait"})}}),[kt,Mt,w,lt]),{handleVvCountOnEnd:qt,handleBreakCount:Ht}=(0,Be.K)(U),Qt=(0,i.useCallback)((()=>{Ht()}),[]),$t=(0,i.useCallback)((e=>{null==ee||ee(e)}),[]),zt=(0,i.useCallback)((e=>{var t,r,n;null===(t=ot.current)||void 0===t||t.updateMetricsParams({playbackAttribute:null===(r=Ke.current)||void 0===r?void 0:r.getPlayerAttributes(),videoQualityParams:kt()}),null===(n=ot.current)||void 0===n||n.onEnded(),null==K||K(e),qt(),lt.addMlModelTrainData({id:w,action:"finish"})}),[kt,K,w,lt]),Wt=(0,i.useCallback)((e=>{var t,r,n,i;const a=(0,F.ZQ)(),{byteLength:o,duration:l}=a.getPreloadCacheInfo(w);null===(t=ot.current)||void 0===t||t.updateMetricsParams({playbackAttribute:null===(r=Ke.current)||void 0===r?void 0:r.getPlayerAttributes(),videoQualityParams:kt()});const s=null===(n=Ke.current)||void 0===n?void 0:n.getPlaybackQuality(),d=s?s.droppedVideoFrames/s.totalVideoFrames*100:0;null===(i=ot.current)||void 0===i||i.onUnmount(Object.assign(Object.assign({},e),{preload_size:o,preload_time:l,droppedRate:d})),lt.addMlModelTrainData({id:w,action:"unmount"}),null==te||te()}),[kt,w,lt]),Gt=(0,i.useCallback)((e=>{e.preventDefault}),[]);(0,i.useEffect)((()=>{ct||null==z||z({})}),[ct,z]),(0,i.useEffect)((()=>{ct&&(0,L.uQ)(j.Y.PlayerMounted)}),[ct]);const Kt=(0,i.useCallback)((()=>{null==ie||ie()}),[ie]),Yt=d||2===U||3===U||4===U||6===U||5===U,Zt=(0,i.useMemo)((()=>{const{videoQuality:e,definition:t}=R;return e&&t?`${e}_${t.substring(0,t.length-1)}_0`:"unknown_definition_from_xgpreload_config"}),[R]),{bitrateConfig:Jt}=(0,g.L$)((0,Le.U)((()=>["bitrateConfig"]),[])),{isTTP:Xt}=null!==(xe=(0,Le.U)((()=>["isTTP"]),[]))&&void 0!==xe?xe:{},{region:er}=null!==(Ee=(0,je.W)((()=>["region"]),[]))&&void 0!==Ee?Ee:{},{abTestVersion:tr}=null!==(Ue=(0,je.W)((()=>["abTestVersion"]),[]))&&void 0!==Ue?Ue:{},rr=(0,a.pd)("desktop"),nr=(0,a.ZC)(),ir=(0,a.iM)("desktop"),ar=(0,a.Yu)(),or=D.M.getInstance();or.isTTP=Xt,tr&&(or.abTestVersion=tr.versionName,D.M.setABTest(ar)),rr&&(or.hevcAbVersion=rr,D.M.setHevcTestData(ir));const{normalizationVid:lr,playbackNormalizePath:sr}=(0,a.KV)(),dr=(0,o.Nj)(F.JX),ur=dr.getPreloadUrls(),cr=(0,m.CT)(ur,Zt),{playerInitHost:pr}=(0,a.NY)(),{videoOrder:vr}=(0,a.Xl)(),{bitrateSelectorConfigs:hr}=(0,a.Tg)(),{preloadConfigVid:yr}=(0,a.Md)(),mr=H?`${H}. ${q}`:q,{armCoreContentEvent:gr}=(0,i.useContext)(b.e),fr=(0,i.useCallback)((()=>{null==gr||gr(),dt.reportActualFMP(),S.e.handleActualFMP()}),[gr,dt]);(0,T.w)({isCurrentVideo:ct,index:A,mode:U});const _r=(0,i.useCallback)((e=>{const{errorCode:t,errorMessage:r,logid:n}=e;dt.emitEvent("video_play_end",{count:1},{is_success:`${0===t}`,error_code:String(t),error_msg:r,logid:n})}),[dt]);return(0,n.jsxs)(P.Le,{horizontal:d,mode:U,style:ke,children:[e?(0,n.jsx)(P.R,{horizontal:Yt,mode:U,src:e,alt:mr,loading:r?"lazy":"eager",style:me,onLoad:fr,fetchPriority:Pe}):t?(0,n.jsx)(_.x,{video:t,objectFit:Yt?"contain":"cover",style:me,alt:mr,onLoad:fr,fetchPriority:Pe}):null,(ct||pt)&&(0,n.jsxs)(P.Ec,{horizontal:Yt,"data-e2e":ae,children:[(0,n.jsx)(Re,{ref:Ke,id:w,url:rt,playbackRate:$,mode:U,muteSetting:N||f.T5[U].forceMute,defaultMute:f.T5[U].defaultMute,playProgress:null!=He?He:0,duration:Q,onUnmount:Wt,onLoadStart:At,onLoadedData:It,onTimeUpdate:Ot,onError:Dt,onCanPlay:Lt,onPause:Ft,onPlay:jt,onPlaying:Ut,onWaiting:Nt,onEnded:zt,onBreak:Qt,onVideoChange:Kt,onResolutionReady:ue,userResolution:Qe,onContextMenu:Gt,onVideoVolumeChange:$t,onVideoPlayEnd:_r,subtitleStruct:oe,subtitleList:le,curSubtitle:se,onSubtitleCallback:de,disableDownload:ce,volumeInfo:pe,adaptBitrateVid:ve,bitrateInfo:he,defaultDefinition:Zt,bitrateConfig:Jt,preloader:dr,normalizationVid:lr,playbackNormalizePath:sr,preloadUrlsList:cr,playerInitHost:pr,defaultBitrate:ye,videoOrder:vr,teaParams:R,autoPlay:fe,autoReplay:_e,size:be,bitrateSelectorConfigs:hr,preloadConfigVid:yr,pathId:Ct,metrics:ot.current,hevcTest:ir,hevcRobustnessTest:st,playbackAbTestInfo:Object.assign(Object.assign({},ar),nr),handleMseError:Bt,isTTP:!!Xt&&"US"===er,vIndex:A,renderState:Se,onAutoplayPrevented:()=>{Xe&&Je.setCanAutoPlay(!1)}}),wt&&(0,n.jsx)(P.K3,{})]})]})}))),Ne=(0,i.memo)((0,i.forwardRef)((function(e,t){const r=(0,i.useRef)(null);(0,i.useImperativeHandle)(t,(()=>({play:e=>{var t,n;(null===(t=r.current)||void 0===t?void 0:t.play)&&(null===(n=r.current)||void 0===n||n.play(e))},pause:()=>{var e,t;(null===(e=r.current)||void 0===e?void 0:e.pause)&&(null===(t=r.current)||void 0===t||t.pause())},seek:e=>{var t,n;(null===(t=r.current)||void 0===t?void 0:t.seek)&&(null===(n=r.current)||void 0===n||n.seek(e))},seekTime:e=>{var t,n;(null===(t=r.current)||void 0===t?void 0:t.seekTime)&&(null===(n=r.current)||void 0===n||n.seekTime(e))},onSeeked:e=>{var t,n;(null===(t=r.current)||void 0===t?void 0:t.onSeeked)&&(null===(n=r.current)||void 0===n||n.onSeeked(e))},onSeeking:e=>{var t,n;(null===(t=r.current)||void 0===t?void 0:t.onSeeking)&&(null===(n=r.current)||void 0===n||n.onSeeking(e))},onTimeUpdate:e=>{var t,n;(null===(t=r.current)||void 0===t?void 0:t.onTimeUpdate)&&(null===(n=r.current)||void 0===n||n.onTimeUpdate(e))},getFullscreen:e=>{var t;null===(t=r.current)||void 0===t||t.getFullscreen(e)},exitFullscreen:e=>{var t;null===(t=r.current)||void 0===t||t.exitFullscreen(e)},replay:()=>{var e,t;(null===(e=r.current)||void 0===e?void 0:e.replay)&&(null===(t=r.current)||void 0===t||t.replay())},updatePlayer:e=>{var t,n;(null===(t=r.current)||void 0===t?void 0:t.updatePlayer)&&(null===(n=r.current)||void 0===n||n.updatePlayer(e))},changeResolution:e=>{var t,n;(null===(t=r.current)||void 0===t?void 0:t.changeResolution)&&(null===(n=r.current)||void 0===n||n.changeResolution(e))},getResolutionInfo:()=>{var e;return null===(e=r.current)||void 0===e?void 0:e.getResolutionInfo()},get currentTime(){var e,t;return null!==(t=null===(e=r.current)||void 0===e?void 0:e.currentTime)&&void 0!==t?t:0},get duration(){var e,t;return null!==(t=null===(e=r.current)||void 0===e?void 0:e.duration)&&void 0!==t?t:0},get currentCanPlay(){var e,t;return null!==(t=null===(e=r.current)||void 0===e?void 0:e.currentCanPlay)&&void 0!==t&&t}})));const{isUseNativePlayer:o,adaptBitrateVid:l}=(0,a.Sc)();return o?(0,n.jsx)(w,Object.assign({},e,{ref:r})):(0,n.jsx)(Ue,Object.assign({},e,{adaptBitrateVid:l,ref:r}))})))},1967:(e,t,r)=>{r.d(t,{CZ:()=>d,Ec:()=>l,K3:()=>s,Le:()=>a,R:()=>o});var n=r(62186),i=r(84827);const a=(0,n.default)("div",{target:"e1yey0rl0"})((({horizontal:e,mode:t,theme:{colors:r}})=>[{width:"100%",height:"100%",overflow:"hidden",position:"relative",backgroundColor:1===t?r.BGPlaceholderOpaque:r.BGPlaceholderDefault,backgroundSize:e?"contain":"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},2===t||1===t||3===t||5===t?{display:"flex",alignItems:"center",justifyContent:"center"}:null]),"label:DivContainer;"),o=(0,n.default)("img",{target:"e1yey0rl1"})((({horizontal:e,mode:t,fetchPriority:r="auto"})=>2!==t&&3!==t&&4!==t&&5!==t?{width:"100%",height:"100%",objectFit:"cover",fetchPriority:r}:{width:"100%",height:"100%",objectFit:e?"contain":"cover",fetchPriority:r}),"label:ImgPoster;"),l=(0,n.default)("div",{target:"e1yey0rl2"})((({horizontal:e=!0})=>({position:"absolute",left:0,top:0,width:"100%",height:"100%","& .xgplayer video":{display:"block",width:"100%",height:"100%",objectFit:e?"contain":"cover"},"& .tiktok-web-player video":{display:"block",width:"100%",height:"100%",objectFit:e?"contain":"cover"}})),"label:DivBasicPlayerWrapper;"),s=(0,n.default)(i.R,{target:"e1yey0rl3"})({position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},"label:StyledLoading;"),d=(0,n.default)("video",{target:"e1yey0rl4"})((({horizontal:e})=>({display:"block",width:"100%",height:"100%",objectFit:e?"contain":"cover"})),"label:VideoBasic;")},49677:(e,t,r)=>{r.d(t,{_:()=>a});var n,i=r(93608);!function(e){e.General="general",e.Photosensitive="photosensitive",e.LoggedOut="logged_out",e.AgeRestriction="age_restriction"}(n||(n={}));const a={handleRemovePhotosensitiveStatus:e=>{i.f.sendEvent("tns_remove_photosensitive_status",{status:e})},handleShowMaskLayer:e=>{i.f.sendEvent("tns_show_mask_layer",e)},handleShowPhotosensitiveRemoved:e=>{i.f.sendEvent("tns_show_photosensitive_removed",e)},handleMaskLayerClickSkip:e=>{i.f.sendEvent("tns_mask_layer_click_skip",e)},handleMaskLayerClickWatch:e=>{i.f.sendEvent("tns_mask_layer_click_watch",e)},handleCCMaskShow:e=>{i.f.sendEvent("cc_mask_show",e)},handleClickLogInCCMask:e=>{i.f.sendEvent("click_log_in_cc_mask",e)}}}}]);