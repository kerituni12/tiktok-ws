"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[2189],{82189:(e,t,i)=>{i.d(t,{z:()=>C});var a=i(58632),s=i(64162),n=i(4126),o=i(93995),r=i(340),d=i(77069),p=i(75974),_=i(72916),m=i(62564),u=i(20259),c=i(23999),l=i(8536),g=i(24451),y=i(63700),h=i(9543),T=i(76435),S=i(80339),M=i(87933),v=i(35572),f=i(33310),D=i(65070),k=i(26324),A=i(68310),b=i(86515),w=i(50970),O=i(24643),P=i(24549),B=i(11983),U=i(62186),F=i(72153);const j=(0,U.default)("div",{target:"e6q1x1a0"})((({theme:{direction:e}})=>[{display:"flex",justifyContent:"center",gap:"10px",alignItems:"center"},(0,F.mp)({direction:e})]),"label:DivShowToastContent;"),R=(0,U.default)("div",{target:"e6q1x1a1"})((({theme:{direction:e}})=>[{color:"rgba(11, 224, 155, 1)"},(0,F.mp)({direction:e})]),"label:DivShowToastIcon;"),L=(0,U.default)("div",{target:"e6q1x1a2"})((({theme:{direction:e}})=>[(0,F.mp)({direction:e})]),"label:DivShowToastText;"),$=(e,t=3,i="padding")=>{B.F.destroy(),B.F.open({content:(0,O.jsxs)(j,{children:[(0,O.jsx)(R,{children:(0,O.jsx)(P.I,{color:"Positive",size:24})}),(0,O.jsx)(L,{children:e})]}),duration:t,widthType:i})},I=(e,t=3,i="padding")=>{B.F.destroy(),B.F.open({content:e,duration:t,widthType:i})};var N=i(64356);let C=class extends s.E{constructor(e,t,i,a){super(),this.service=e,this.home=t,this.ComplianceSettings=i,this.t=a,this.defaultState={timeUsageToday:0,userSTMSetting:null,defaultDailySTMPopup:!1,parentUsername:"",userSTMLimit:0,STMInterventionType:1,STMManagementType:0,scheduledBreakSetting:void 0,shouldShowScheduledBreak:!1,scheduledBreakEnabled:!1,scheduledBreakActive:!1,scheduledBreakActiveRule:{startTime:"",endTime:""},STMManagementRepeatType:1,STMManagementDaySetting:[],FPSTMManagementDaySetting:[],isFpTeenOpenDailySTM:!1,showDailyScreenTimeLimitsWeb:!0,lastUploadTime:new Date,dayChange:new Date,tenMinutesInterval:0,weeklyScreenTimeUpdates:!1,durationReminder:0,durationReminderType:0,isDisplayOtherPopupWhenTimeBreak:!1,isTimeBreakSnooze:!1,isOpenSleepReminder:!1,sleepTimeSettings:void 0,isMinor:!1,sleepReminderPopup:!1,breakReminderPopup:!1,isPageHidden:!1,isLogin:!1,activeTimeUsage:0,isOpenDailySTM:!1,userIdentity:1,defaultDailyLimitKmPopup:!1,isPinSet:!1,kmPopupExtendCount:0}}setUserSTMSetting(e,t){e.userSTMSetting=Object.assign(Object.assign({},e.userSTMSetting),t)}setDefaultDailySTMPopup(e,t){e.defaultDailySTMPopup=t}setparentUsername(e,t){e.parentUsername=t}setSleepReminderPopup(e,t){e.sleepReminderPopup=t}setBreakReminderPopup(e,t){e.breakReminderPopup=t}setDefaultDailyLimitKmPopup(e,t){e.defaultDailyLimitKmPopup=t}showDefaultDailyLimitKmPopup(e){e.defaultDailyLimitKmPopup=!0}hideDefaultDailyLimitKmPopup(e){e.defaultDailyLimitKmPopup=!1}extendLimitKidsMode(e){const t=e.timeUsageToday+1e3*e.activeTimeUsage,i=Math.ceil((t-36e5)/18e5),a=Math.max(e.kmPopupExtendCount,i);e.kmPopupExtendCount=a}setIsPinSet(e,t){e.isPinSet=t}setPageHidden(e){e.isPageHidden=!0}setPageVisible(e){e.isPageHidden=!1}setLogin(e){e.isLogin=!0}setNotLogin(e){e.isLogin=!1}setIsLogin(e,t){e.isLogin=t}setActiveTimeUsage(e,t){e.activeTimeUsage=t}setTimeUsageToday(e,t){e.timeUsageToday=t}setIsOpenDailySTM(e,t){e.isOpenDailySTM=t}setUserIdentity(e,t){e.userIdentity=t}setUserSTMLimit(e,t){e.userSTMLimit=t}setSTMInterventionType(e,t){e.STMInterventionType=t}setLastUploadTime(e,t){e.lastUploadTime=t}setDayChange(e,t){e.dayChange=t}setTenMinutesInterval(e,t){e.tenMinutesInterval=t}setDurationReminder(e,t){e.durationReminder=t}setDurationReminderType(e,t){e.durationReminderType=t}setIsDisplayOtherPopupWhenTimeBreak(e,t){e.isDisplayOtherPopupWhenTimeBreak=t}setIsTimeBreakSnooze(e,t){e.isTimeBreakSnooze=t}setIsOpenSleepReminder(e,t){e.isOpenSleepReminder=t}setWeeklyScreenTimeUpdates(e,t){e.weeklyScreenTimeUpdates=t}setSTMManagementType(e,t){e.STMManagementType=t}setScheduledBreakSetting(e,t){var i,a,s;e.scheduledBreakSetting=t;const n=null!==(a=null===(i=e.scheduledBreakSetting)||void 0===i?void 0:i.show_stm_down_time)&&void 0!==a&&a;e.shouldShowScheduledBreak=n;const o=(null===(s=e.scheduledBreakSetting)||void 0===s?void 0:s.screen_down_time_status)===A.qL.on;e.scheduledBreakEnabled=o}disableScheduledBreak(e){e.shouldShowScheduledBreak=!1,e.scheduledBreakEnabled=!1}setScheduledBreakHidden(e){e.scheduledBreakActive=!1}setScheduledBreakShow(e){e.scheduledBreakActive=!0}setScheduledBreakRule(e,t){e.scheduledBreakActiveRule=t}setSTMManagementRepeatType(e,t){e.STMManagementRepeatType=t}setSTMManagementDaySetting(e,t){e.STMManagementDaySetting=t}setFPSTMManagementDaySetting(e,t){e.FPSTMManagementDaySetting=t}setSleepTimeSettings(e,t){e.sleepTimeSettings=t;const i=(null==t?void 0:t.sleep_reminder_enabled)&&(0!==t.sleep_time_start_hour||0!==t.sleep_time_start_minute||0!==t.sleep_time_end_hour||0!==t.sleep_time_end_minute);e.isOpenSleepReminder=i||!1}setIsFpTeenOpenDailySTM(e,t){e.isFpTeenOpenDailySTM=t}setIsMinor(e,t){e.isMinor=t}setShowDailyScreenTimeLimitsWeb(e,t){e.showDailyScreenTimeLimitsWeb=t}uploadAppOpentimes(e){return e.pipe((0,_.n)((e=>{const{reqPayload:t,kidsMode:i=!1}=e;return(i?this.service.uploadAppOpentimesKidsMode:this.service.uploadAppOpentimes)(t).pipe((0,m.T)((()=>this.noop())))})),(0,u.W)((e=>(console.error("uploadAppOpentimes error occurs",e),(0,c.of)(this.noop())))))}uploadSleepReminderAction(e){return e.pipe((0,_.n)((e=>this.service.uploadSleepReminderAction(e).pipe((0,m.T)((()=>this.noop()))))),(0,u.W)((e=>(console.error("uploadSleepReminderAction error occurs",e),(0,c.of)(this.noop())))))}getSTMManagement(e){return e.pipe((0,l.Z)((e=>this.ComplianceSettings.getGuardianComplianceSettings(e).pipe((0,l.Z)((e=>{var t,i;if(e){let a=e.dw.screen_time_management_status;const s=null===(t=e.fp.restriction)||void 0===t?void 0:t.screen_time_management_status,n=(0,b.uA)(e),o=(0,b.Wf)(e);return(2===e.fp.user_identity||4===e.fp.user_identity&&s)&&(a=s),(0,c.of)(this.getActions().setUserSTMLimit(n||0),this.getActions().setIsOpenDailySTM(Boolean(a)),this.getActions().setIsFpTeenOpenDailySTM(Boolean(s)),this.getActions().setIsMinor(Boolean(e.user_details.is_minor)),this.getActions().setUserIdentity(e.fp.user_identity),this.getActions().setUserSTMSetting(e),this.getActions().setDurationReminder(e.dw.session_duration_reminder||0),this.getActions().setDurationReminderType(e.dw.session_duration_type||0),this.getActions().setSTMManagementRepeatType((null==o?void 0:o.screen_time_management_repeat_type)||1),this.getActions().setFPSTMManagementDaySetting((null===(i=e.fp.restriction)||void 0===i?void 0:i.screen_time_management_week_settings)||[]),this.getActions().setSTMManagementDaySetting(e.dw.screen_time_management_week_settings||[]),this.getActions().setWeeklyScreenTimeUpdates(1===e.dw.screen_time_update),this.getActions().setSleepTimeSettings(e.dw.sleep_time_settings))}return(0,c.of)(this.noop())}))))))}getParentInfo(e){return e.pipe((0,l.Z)((e=>this.service.getParentInfo(e).pipe((0,l.Z)((e=>{var t,i;return e?(0,c.of)(this.getActions().setparentUsername((null===(t=e.parent)||void 0===t?void 0:t.unique_id)||(null===(i=e.parent)||void 0===i?void 0:i.short_id)||"")):(0,c.of)(this.noop())}))))),(0,u.W)((e=>(console.error("getParentInfo error occurs",e),(0,c.of)(this.noop())))))}weeklyUpdateChangeHandler(e){return e.pipe((0,_.n)((e=>this.service.setMinorSetting({settings:[{event_type:4,event_value:e?"1":"0"}]}).pipe((0,l.Z)((t=>0===t.status_code?(0,c.of)(this.getActions().setWeeklyScreenTimeUpdates(e)):(0,c.of)(this.noop())))))))}init(e){return e.pipe((0,_.n)((()=>this.ComplianceSettings.getGuardianComplianceSettings({date:(0,b.zk)(new Date)}).pipe((0,g.E)(this.home.state$),(0,l.Z)((([e,t])=>{var i,a,s,n,o;if(!e)return(0,y.h)((0,c.of)(this.noop()));let r=e.dw.screen_time_management_status;const d=(2===e.fp.user_identity||4===e.fp.user_identity)&&Boolean(null===(i=e.fp.restriction)||void 0===i?void 0:i.screen_time_management_status);(2===e.fp.user_identity||4===e.fp.user_identity&&d)&&(r=d?1:0);const p=(0,b.x1)(e),_=(0,b.Wf)(e),m=(0,b.uA)(e),u=new Date;let l=1;d&&(l=3),1===e.dw.screen_time_management_eligible&&(l=2);const g=(0,b.jc)(),h=void 0===e.dw.show_daily_screen_time_limits_web||e.dw.show_daily_screen_time_limits_web;return(0,b.ml)({isOpenDailySTM:Boolean(r),STMManagementRepeatType:(null==_?void 0:_.screen_time_management_repeat_type)||1,userSTMLimit:m||0,durationReminder:e.dw.session_duration_reminder||0,isOpenSleepReminder:Boolean(null===(a=null==e?void 0:e.dw.sleep_time_settings)||void 0===a?void 0:a.sleep_reminder_enabled),sleepTimeSettings:e.dw.sleep_time_settings,weeklyScreenTimeUpdates:1===e.dw.screen_time_update},this.service),(0,y.h)((0,c.of)(this.getActions().setUserSTMSetting(e),this.getActions().setIsFpTeenOpenDailySTM(Boolean(d)),this.getActions().setIsMinor(Boolean(e.user_details.is_minor)),this.getActions().setUserIdentity(e.fp.user_identity),this.getActions().setTimeUsageToday(e.user_details.time_usage_today||this.state.timeUsageToday),this.getActions().setUserSTMLimit(m||0),this.getActions().setSTMInterventionType(l),this.getActions().setSTMManagementType((null==_?void 0:_.screen_time_management_type)||0),this.getActions().setScheduledBreakSetting(p),this.getActions().setSTMManagementRepeatType((null==_?void 0:_.screen_time_management_repeat_type)||1),this.getActions().setSTMManagementDaySetting((null==_?void 0:_.screen_time_management_week_settings)||[]),this.getActions().setIsMinor(e.user_details.is_minor||!1),this.getActions().setIsOpenDailySTM(Boolean(r)),this.getActions().setFPSTMManagementDaySetting((null===(s=e.fp.restriction)||void 0===s?void 0:s.screen_time_management_week_settings)||[]),this.getActions().setShowDailyScreenTimeLimitsWeb(h),this.getActions().setLastUploadTime(new Date(u.getTime())),this.getActions().setIsLogin(Boolean(null===(n=t.appContext)||void 0===n?void 0:n.user)),this.getActions().setDurationReminder(e.dw.session_duration_reminder||0),this.getActions().setDurationReminderType(e.dw.session_duration_type||0),this.getActions().setActiveTimeUsage(g),this.getActions().setWeeklyScreenTimeUpdates(1===e.dw.screen_time_update),this.getActions().setSleepTimeSettings(e.dw.sleep_time_settings),this.getActions().setIsOpenSleepReminder(Boolean(null===(o=null==e?void 0:e.dw.sleep_time_settings)||void 0===o?void 0:o.sleep_reminder_enabled))))}))))),(0,u.W)((e=>(console.error("init error occurs",e),(0,c.of)(this.noop())))))}initKidsMode(e){return e.pipe((0,_.n)((()=>this.ComplianceSettings.getGuardianComplianceSettings({date:(0,b.zk)(new Date)}).pipe((0,g.E)(this.home.state$),(0,l.Z)((([e,t])=>{var i;const a=new Date,s=(0,b.jc)();return(0,y.h)((0,c.of)(this.getActions().setLastUploadTime(new Date(a.getTime())),this.getActions().setIsLogin(Boolean(null===(i=t.appContext)||void 0===i?void 0:i.user)),this.getActions().setActiveTimeUsage(s)))}))))),(0,u.W)((e=>(console.error("init error occurs",e),(0,c.of)(this.noop())))))}checkDailySTMPopupShow(e){return e.pipe((0,l.Z)((e=>this.service.checkDailySTMPopupShow(e).pipe((0,l.Z)((e=>0===e.status_code&&e.can_view_popup?(0,c.of)(this.getActions().setDefaultDailySTMPopup(!0)):(0,c.of)(this.getActions().setDefaultDailySTMPopup(!1))))))))}dailySTMUpdateHandler(e){return e.pipe((0,_.n)((e=>this.service.setDailySTM(e).pipe((0,g.E)(this.state$),(0,l.Z)((([t,i])=>{if(0!==t.status_code)return(0,c.of)(this.noop());$(this.t("dailyscreentime_featurescreen_toast_editedtime"),3,"auto");const a=(0,b.ZY)(e);return(0,b.nN)("updateDailySTM",e),(0,c.of)(this.getActions().setUserSTMLimit(a),this.getActions().setIsOpenDailySTM(Boolean(e.screen_time_management_status)),this.getActions().setSTMManagementType(e.screen_time_management_type),this.getActions().setSTMManagementRepeatType(e.screen_time_management_repeat_type||i.STMManagementRepeatType),this.getActions().setSTMManagementDaySetting(e.screen_time_management_week_settings||i.STMManagementDaySetting))}))))),(0,u.W)((e=>(console.error("dailySTMUpdateHandler error occurs",e),(0,c.of)(this.noop())))))}syncDailySTMUpdateHandler(e){return e.pipe((0,g.E)(this.state$),(0,_.n)((([e,t])=>{const i=(0,b.ZY)(e),a=[(0,c.of)(this.getActions().setUserSTMLimit(i)),(0,c.of)(this.getActions().setIsOpenDailySTM(Boolean(e.screen_time_management_status))),(0,c.of)(this.getActions().setSTMManagementType(e.screen_time_management_type)),(0,c.of)(this.getActions().setSTMManagementRepeatType(e.screen_time_management_repeat_type||t.STMManagementRepeatType)),(0,c.of)(this.getActions().setSTMManagementDaySetting(e.screen_time_management_week_settings||t.STMManagementDaySetting))];return(0,y.h)(...a)})))}startAccumulateActiveTime(e){return e.pipe((0,_.n)((()=>(0,h.Y)(15e3).pipe((0,g.E)(this.state$),(0,l.Z)((([e,t])=>(0,c.of)(this.getActions().setActiveTimeUsage(t.activeTimeUsage+15)))),(0,T.Q)((0,y.h)(this.getAction$().setPageHidden,this.getAction$().setNotLogin)),(0,S.q)(this.getActions().setActiveTimeUsage(0))))))}startMonitorDayChange(e){return e.pipe((0,_.n)((()=>(0,h.Y)(3e4).pipe((0,g.E)(this.state$),(0,l.Z)((([e,t])=>{const i=new Date;return t.lastUploadTime.getDate()!==i.getDate()?(0,c.of)(this.getActions().setDayChange(i)):(0,c.of)(this.noop())})),(0,T.Q)((0,y.h)(this.getAction$().setPageHidden,this.getAction$().setNotLogin,this.stopTimer$))))))}startMonitorTimeLimit(e){return e.pipe((0,_.n)((()=>(0,h.Y)(3e4).pipe((0,g.E)(this.state$),(0,l.Z)((([e,t])=>{const i=[];return t.timeUsageToday+t.activeTimeUsage>=60*t.userSTMLimit&&t.timeUsageToday+t.activeTimeUsage<60*t.userSTMLimit+30&&i.push(this.service.checkDailySTMPopupShow({date:0,screen_time_limit_type:t.STMInterventionType}).pipe((0,m.T)((e=>0===e.status_code&&e.can_view_popup?this.getActions().setDefaultDailySTMPopup(!0):this.getActions().setDefaultDailySTMPopup(!1))))),(0,y.h)(...i)})),(0,T.Q)((0,y.h)(this.getAction$().setPageHidden,this.getAction$().setNotLogin,this.getAction$().setDayChange,this.stopTimer$))))))}startUploadSTMEveryTenMinutes(e){return e.pipe((0,_.n)((()=>(0,h.Y)(6e5).pipe((0,g.E)(this.state$),(0,m.T)((([e,t])=>this.getActions().setTenMinutesInterval(t.tenMinutesInterval+1))),(0,T.Q)((0,y.h)(this.getAction$().setPageHidden,this.getAction$().setNotLogin,this.stopTimer$))))))}uploadScreenTime(e){return e.pipe((0,g.E)(this.state$),(0,l.Z)((([e,t])=>{const{uploadType:i,kidsMode:a=!1}=e||{},s=new Date,n=(0,b.BX)(s),o=(0,b.BX)(t.lastUploadTime);if(s.getTime()<=t.lastUploadTime.getTime()+18e4&&5!==i)return(0,c.of)(this.noop());const r=(0,b.zk)(s),d=(0,b.$n)(s),p=d?0:n-o,_=d?n-o:0;if(p<=0&&_<=0)return(0,c.of)(this.noop());const m={upload_timestamp:s.getTime(),stm_enabled:t.isOpenDailySTM?1:0,upload_type:i||2,time_usage:[{upload_date:r,day_usage:p,night_usage:_}]};return(a?this.service.uploadScreenTimeKidsMode:this.service.uploadScreenTime)(m).pipe((0,g.E)(this.state$),(0,l.Z)((([e,t])=>{let i=e;if("string"==typeof e&&(i=JSON.parse(e)),0!==i.status_code)return(0,c.of)(this.noop());const n=[(0,c.of)(this.getActions().setLastUploadTime(s))];return a?n.push((0,c.of)(this.getActions().getTodayUsage())):n.push((0,c.of)(this.getActions().setTimeUsageToday(i.time_usage_today||t.timeUsageToday))),(0,y.h)(...n)})))})),(0,u.W)((e=>(console.error("uploadScreenTime error occurs",e),(0,c.of)(this.noop())))))}uploadScreenTimeWhenDayChange(e){return e.pipe((0,g.E)(this.state$),(0,l.Z)((([e,t])=>{const{kidsMode:i=!1}=e||{},a=new Date,s=(0,b.zk)(a),n=(0,b.$n)(a),o=(0,b.BX)(a),r=(0,b.BX)(t.lastUploadTime);if(a.getDate()===t.lastUploadTime.getDate())return(0,c.of)(this.noop());const d=new Date(a).setHours(0,0,0,0)/1e3;return(i?this.service.uploadScreenTimeKidsMode:this.service.uploadScreenTime)({upload_timestamp:a.getTime(),stm_enabled:t.isOpenDailySTM?1:0,upload_type:2,time_usage:[{upload_date:s-1,day_usage:n?0:d-r,night_usage:n?d-r:0},{upload_date:s,day_usage:n?0:o-d,night_usage:n?o-d:0}]}).pipe((0,g.E)(this.state$),(0,l.Z)((([e])=>(0,c.of)(this.getActions().setLastUploadTime(a),this.getActions().setTimeUsageToday(e.time_usage_today||0)))))})))}sessionDurationChangeHandler(e){return e.pipe((0,_.n)((e=>this.service.setMinorSetting({settings:[{event_type:0===e.type?5:6,event_value:e.value.toString()}]}).pipe((0,l.Z)((t=>0===t.status_code?($(this.t("screenTime_screenTimeBreaks_manageTime_editBreak_toast",{},"You’ve edited your screen time break"),3,"auto"),(0,b.nN)("updateTimeBreak",{event_type:0===e.type?5:6,event_value:e.value.toString()}),(0,c.of)(this.getActions().setDurationReminder(e.value),this.getActions().setDurationReminderType(e.type))):(I(this.t("error_toast")),(0,c.of)(this.noop()))))))))}syncSessionDurationHandler(e){return e.pipe((0,_.n)((e=>(0,c.of)(this.getActions().setDurationReminder(Number(e.event_value)),this.getActions().setDurationReminderType(e.event_type)))))}startTimeBreakTimer(e){return(0,M.O)(1e3*(60*e.durationReminder-e.activeTimeUsage)).pipe((0,g.E)(this.state$),(0,_.n)((([e,t])=>t.isDisplayOtherPopupWhenTimeBreak||t.isTimeBreakSnooze?(0,c.of)(this.getActions().setBreakReminderPopup(!1),this.getActions().setIsDisplayOtherPopupWhenTimeBreak(!1)):(0,c.of)(this.getActions().setBreakReminderPopup(!0)))),(0,T.Q)((0,y.h)(this.getAction$().setPageHidden,this.getAction$().setNotLogin,this.stopTimer$,this.stopTimeBreak$)))}processTimeBreak(e){return e.pipe((0,g.E)(this.state$),(0,_.n)((([e,t])=>t.activeTimeUsage/60>=t.durationReminder&&!t.isDisplayOtherPopupWhenTimeBreak&&!t.isTimeBreakSnooze?(0,c.of)(this.getActions().setBreakReminderPopup(!0)):(0,y.h)((0,c.of)(this.getActions().setBreakReminderPopup(!1)),this.startTimeBreakTimer(t)))))}startTimeBreakSnoozeTimer(e){return e.pipe((0,_.n)((()=>{const e=[(0,c.of)(this.getActions().setIsTimeBreakSnooze(!0))];return e.push((0,M.O)(6e5).pipe((0,l.Z)((()=>(0,c.of)(this.getActions().setIsTimeBreakSnooze(!1),this.getActions().setBreakReminderPopup(!0)))),(0,T.Q)((0,y.h)(this.getAction$().setPageHidden,this.getAction$().setNotLogin,this.stopTimer$)))),(0,y.h)(...e)})))}startSleepReminderTimer(e,t){return(0,M.O)(e).pipe((0,g.E)(this.state$),(0,_.n)((([e,i])=>this.service.checkSleepReminderShow({sleep_time_settings:i.sleepTimeSettings,user_real_timestamp:t}).pipe((0,_.n)((e=>0===e.status_code&&e.show_reminder?(0,c.of)(this.getActions().setSleepReminderPopup(!0)):(0,c.of)(this.noop())))))),(0,T.Q)((0,y.h)(this.getAction$().setPageHidden,this.getAction$().setNotLogin,this.stopTimer$,this.stopSleepReminder$)))}sleepReminderProcess(e){const t=new Date,i=(0,b.BX)(t);if((0,b.eR)(e))return this.service.checkSleepReminderShow({sleep_time_settings:e,user_real_timestamp:i}).pipe((0,_.n)((e=>0===e.status_code&&e.show_reminder?(0,c.of)(this.getActions().setSleepReminderPopup(!0)):0===e.status_code&&e.next_timestamp?this.startSleepReminderTimer(1e3*(e.next_timestamp-i),i):(0,c.of)(this.getActions().setSleepReminderPopup(!1)))));const a=(0,b.rv)(e);return(0,y.h)((0,c.of)(this.getActions().setSleepReminderPopup(!1)),this.startSleepReminderTimer(a,i))}openSleepReminder(e){return e.pipe((0,g.E)(this.state$),(0,l.Z)((([e,t])=>this.sleepReminderProcess(t.sleepTimeSettings))))}sleepReminderChangeHandler(e){return e.pipe((0,_.n)((e=>this.service.setSleepReminder(e).pipe((0,_.n)((t=>{if(0===t.status_code){$(this.t(void 0===this.state.sleepTimeSettings?"screenTime_sleepReminders_setSleepTime_toast":"nightscreentimemgmt_sleepreminders_toast_editsleeptime",{},void 0===this.state.sleepTimeSettings?"You’ve set your sleep time":"You’ve edited your sleep time"),3,"auto"),(0,b.nN)("updateSleepTime",e.sleep_time_settings);const t=new Date,i=(0,b.BX)(t),a=[],s=(0,b.rv)(e.sleep_time_settings);return a.push(this.startSleepReminderTimer(s,i)),a.push((0,c.of)(this.getActions().setSleepTimeSettings({sleep_time_start_hour:e.sleep_time_settings.sleep_time_start_hour,sleep_time_start_minute:e.sleep_time_settings.sleep_time_start_minute,sleep_time_end_hour:e.sleep_time_settings.sleep_time_end_hour,sleep_time_end_minute:e.sleep_time_settings.sleep_time_end_minute,sleep_reminder_enabled:e.sleep_time_settings.sleep_reminder_enabled}))),(0,y.h)(...a)}return I(this.t("error_toast")),(0,c.of)(this.noop())}))))),(0,u.W)((e=>(console.error("sleepReminderChangeHandler error occurs",e),(0,c.of)(this.noop())))))}syncSleepSettingHandler(e){return e.pipe((0,g.E)(this.state$),(0,l.Z)((([e,t])=>{const i=[];return i.push((0,c.of)(this.getActions().setSleepTimeSettings({sleep_time_start_hour:e.sleep_time_start_hour,sleep_time_start_minute:e.sleep_time_start_minute,sleep_time_end_hour:e.sleep_time_end_hour,sleep_time_end_minute:e.sleep_time_end_minute,sleep_reminder_enabled:e.sleep_reminder_enabled}))),t.isPageHidden||(i.push((0,c.of)(this.getActions().stopSleepReminder$())),i.push(this.sleepReminderProcess(e))),(0,y.h)(...i)})),(0,u.W)((e=>(console.error("syncSleepSettingHandler error occurs",e),(0,c.of)(this.noop())))))}delaySleep(e){return e.pipe((0,v.p)((()=>(0,M.O)(6e5).pipe((0,m.T)((()=>this.getActions().setSleepReminderPopup(!0))),(0,T.Q)((0,y.h)(this.getAction$().setPageHidden,this.getAction$().setNotLogin,this.stopTimer$))))))}scheduledBreakProcess(e){return e.pipe((0,g.E)(this.state$),(0,l.Z)((([e,t])=>{const i=[],a=t.scheduledBreakSetting;if(a){const e=t.scheduledBreakActive,{status:s,rule:n}=(0,b.T5)(a);e&&!s?i.push((0,c.of)(this.getActions().setScheduledBreakHidden())):!s||e&&t.scheduledBreakActiveRule.endTime===n.endTime&&t.scheduledBreakActiveRule.startTime===n.startTime||(i.push((0,c.of)(this.getActions().setScheduledBreakShow())),i.push((0,c.of)(this.getActions().setScheduledBreakRule(n))))}return(0,y.h)(...i)})))}startScheduledBreakTimer(e){return e.pipe((0,_.n)((()=>(0,h.Y)(15e3).pipe((0,g.E)(this.state$),(0,l.Z)((([e,t])=>{const i=[];return t.scheduledBreakSetting&&i.push((0,c.of)(this.getActions().scheduledBreakProcess())),(0,y.h)(...i)})),(0,T.Q)((0,y.h)(this.getAction$().setPageHidden,this.getAction$().setNotLogin,this.getAction$().setDayChange,this.stopTimer$,this.stopScheduleBreak$))))))}stmLimitKidsModeProcess(e){return e.pipe((0,g.E)(this.state$),(0,l.Z)((([e,t])=>{const i=[],a=t.defaultDailyLimitKmPopup,s=(0,b.E9)(t.timeUsageToday,t.activeTimeUsage,t.kmPopupExtendCount);return a&&!s?i.push((0,c.of)(this.getActions().hideDefaultDailyLimitKmPopup())):!a&&s&&i.push((0,c.of)(this.getActions().showDefaultDailyLimitKmPopup())),(0,y.h)(...i)})))}extendLimitKidsModeProcess(e){return e.pipe((0,g.E)(this.state$),(0,l.Z)((([e,t])=>(0,f.x)((0,c.of)(this.getActions().extendLimitKidsMode()),(0,c.of)(this.getActions().stmLimitKidsModeProcess())))))}startStmLimitKidsModeTimer(e){return e.pipe((0,_.n)((()=>(0,h.Y)(15e3).pipe((0,g.E)(this.state$),(0,l.Z)((([e,t])=>(0,y.h)((0,c.of)(this.getActions().stmLimitKidsModeProcess())))),(0,T.Q)((0,y.h)(this.getAction$().setPageHidden,this.getAction$().setNotLogin,this.getAction$().setDayChange,this.stopTimer$,this.stopStmLimitKidsMode$))))))}getTodayUsage(e){return e.pipe((0,_.n)((()=>this.service.getSTMDashboardKidsMode({count:1}).pipe((0,g.E)(this.home.state$),(0,l.Z)((([e,t])=>{const i=(0,b.b$)(e);return(0,y.h)((0,c.of)(this.getActions().setTimeUsageToday(i),this.getActions().setActiveTimeUsage(0)))}))))),(0,u.W)((e=>(console.error("getTodayUsage error occurs",e),(0,c.of)(this.noop())))))}initCallKmDefaultLimit(e){return e.pipe((0,_.n)((()=>(0,D.p)({listRes:this.service.getSTMDashboardKidsMode({count:1}),pinRes:this.service.getIsPinSet()}).pipe((0,l.Z)((({listRes:e,pinRes:t})=>{const i=(0,b.b$)(e),a=2702===t.status_code;return(0,f.x)((0,c.of)(this.getActions().setTimeUsageToday(i),this.getActions().setActiveTimeUsage(0),this.getActions().setIsPinSet(a)),(0,c.of)(this.getActions().stmLimitKidsModeProcess()))})),(0,u.W)((e=>(console.error("Error during parallel API calls:",e),(0,c.of)(this.noop()))))))))}};(0,a.__decorate)([(0,n.uk)(),(0,a.__metadata)("design:type",k.c)],C.prototype,"stopTimer$",void 0),(0,a.__decorate)([(0,n.uk)(),(0,a.__metadata)("design:type",k.c)],C.prototype,"stopSleepReminder$",void 0),(0,a.__decorate)([(0,n.uk)(),(0,a.__metadata)("design:type",k.c)],C.prototype,"stopTimeBreak$",void 0),(0,a.__decorate)([(0,n.uk)(),(0,a.__metadata)("design:type",k.c)],C.prototype,"stopScheduleBreak$",void 0),(0,a.__decorate)([(0,n.uk)(),(0,a.__metadata)("design:type",k.c)],C.prototype,"stopStmLimitKidsMode$",void 0),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Object]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setUserSTMSetting",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Boolean]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setDefaultDailySTMPopup",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,String]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setparentUsername",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Boolean]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setSleepReminderPopup",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Boolean]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setBreakReminderPopup",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Boolean]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setDefaultDailyLimitKmPopup",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"showDefaultDailyLimitKmPopup",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"hideDefaultDailyLimitKmPopup",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"extendLimitKidsMode",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Boolean]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setIsPinSet",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setPageHidden",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setPageVisible",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setLogin",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setNotLogin",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Boolean]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setIsLogin",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Number]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setActiveTimeUsage",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Number]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setTimeUsageToday",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Boolean]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setIsOpenDailySTM",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Number]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setUserIdentity",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Number]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setUserSTMLimit",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Number]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setSTMInterventionType",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Date]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setLastUploadTime",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Date]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setDayChange",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Number]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setTenMinutesInterval",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Number]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setDurationReminder",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Number]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setDurationReminderType",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Boolean]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setIsDisplayOtherPopupWhenTimeBreak",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Boolean]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setIsTimeBreakSnooze",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Boolean]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setIsOpenSleepReminder",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Boolean]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setWeeklyScreenTimeUpdates",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Number]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setSTMManagementType",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Object]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setScheduledBreakSetting",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"disableScheduledBreak",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setScheduledBreakHidden",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setScheduledBreakShow",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Object]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setScheduledBreakRule",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Number]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setSTMManagementRepeatType",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Array]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setSTMManagementDaySetting",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Array]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setFPSTMManagementDaySetting",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Object]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setSleepTimeSettings",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Boolean]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setIsFpTeenOpenDailySTM",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Boolean]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setIsMinor",null),(0,a.__decorate)([(0,n.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Boolean]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"setShowDailyScreenTimeLimitsWeb",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"uploadAppOpentimes",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"uploadSleepReminderAction",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"getSTMManagement",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"getParentInfo",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"weeklyUpdateChangeHandler",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"init",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"initKidsMode",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"checkDailySTMPopupShow",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"dailySTMUpdateHandler",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"syncDailySTMUpdateHandler",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"startAccumulateActiveTime",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"startMonitorDayChange",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"startMonitorTimeLimit",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"startUploadSTMEveryTenMinutes",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"uploadScreenTime",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"uploadScreenTimeWhenDayChange",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"sessionDurationChangeHandler",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"syncSessionDurationHandler",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"processTimeBreak",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"startTimeBreakSnoozeTimer",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"openSleepReminder",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"sleepReminderChangeHandler",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"syncSleepSettingHandler",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"delaySleep",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"scheduledBreakProcess",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"startScheduledBreakTimer",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"stmLimitKidsModeProcess",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"extendLimitKidsModeProcess",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"startStmLimitKidsModeTimer",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"getTodayUsage",null),(0,a.__decorate)([(0,n.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[k.c]),(0,a.__metadata)("design:returntype",void 0)],C.prototype,"initCallKmDefaultLimit",null),C=(0,a.__decorate)([(0,o.n)("STMModule"),(0,a.__param)(3,(0,r.y)(N.hp)),(0,a.__metadata)("design:paramtypes",[d.i,w.L,p.P,Function])],C)},77069:(e,t,i)=>{i.d(t,{i:()=>p});var a=i(58632),s=i(7672),n=i(26325),o=i(55099),r=i(93608);function d(e){return 0===e.length?"":function(e){let t="";for(let i=0;i<e.length;i++)t+=(5^e.charCodeAt(i)).toString(16);return t}(parseInt(e)*parseInt(e)+"dmt")}let p=class{constructor(e){this.fetch=e,this.uploadScreenTime=this.uploadScreenTime.bind(this),this.uploadScreenTimeKidsMode=this.uploadScreenTimeKidsMode.bind(this),this.uploadAppOpentimes=this.uploadAppOpentimes.bind(this),this.uploadAppOpentimesKidsMode=this.uploadAppOpentimesKidsMode.bind(this),this.getSTMDashboard=this.getSTMDashboard.bind(this),this.getSTMDashboardKidsMode=this.getSTMDashboardKidsMode.bind(this)}uploadMetric(e,t){r.f.event(e,t)}uploadScreenTime(e){return this.fetch.post("/tiktok/v1/screen_time/upload/",{body:JSON.stringify(e),headers:{"content-type":"application/json"},baseUrlType:2})}uploadScreenTimeKidsMode(e){return this.fetch.post("/tiktok/v1/kids/screen_time/upload/",{body:JSON.stringify(e),headers:{"content-type":"application/json"},baseUrlType:2})}uploadAppOpentimes(e){return this.fetch.post("/tiktok/v1/app_open_times/upload/",{body:JSON.stringify(e),headers:{"Content-Type":"application/json"},baseUrlType:2})}uploadAppOpentimesKidsMode(e){return this.fetch.post("/tiktok/v1/kids/app_open_times/upload/",{body:JSON.stringify(e),headers:{"Content-Type":"application/json"},baseUrlType:2})}getSTMDashboard(e){return this.fetch.get("/tiktok/v1/screen_time/list/",{query:e,baseUrlType:2})}getSTMDashboardKidsMode(e){return this.fetch.get("/tiktok/v1/kids/screen_time/list/",{query:e,baseUrlType:2})}getSTMManagement(e){return this.fetch.get("/tiktok/v1/compliance/guadig/settings/",{query:e,baseUrlType:2})}setDailySTM(e){return this.fetch.post("/tiktok/v1/screen_time/settings/",{body:JSON.stringify(e),headers:{"Content-Type":"application/json; charset=UTF-8"},baseUrlType:2})}checkDailySTMPopupShow(e){return this.fetch.post("/tiktok/v1/screen_time/popup/show/",{body:JSON.stringify(e),headers:{"Content-Type":"application/json"},baseUrlType:2})}uploadDailySTMPopupSuccess(e){return this.fetch.post("/tiktok/v1/screen_time/popup/complete/",{body:JSON.stringify(e),headers:{"Content-Type":"application/json"},baseUrlType:2})}uploadDailySTMTeenPinSuccess(e){const t=new URLSearchParams;return t.append("pass_code",e),this.fetch.post("/aweme/v2/guardian/platform/verify/password/",{body:t,headers:{"Content-Type":"application/x-www-form-urlencoded"},baseUrlType:2})}setSleepReminder(e){return this.fetch.post("/tiktok/v1/night_screen_time/settings/",{body:JSON.stringify(e),headers:{"Content-Type":"application/json; charset=UTF-8"},baseUrlType:2})}uploadSleepReminderAction(e){return this.fetch.post("/tiktok/v1/night_screen_time/popup/",{body:JSON.stringify(e),headers:{"Content-Type":"application/json"},baseUrlType:2})}checkSleepReminderShow(e){return this.fetch.post("/tiktok/v1/night_screen_time/reminder/",{body:JSON.stringify(e),headers:{"Content-Type":"application/json"},baseUrlType:2})}setMinorSetting(e){const t=new URLSearchParams;return t.append("settings",JSON.stringify(e.settings)),this.fetch.post("/aweme/v1/minor/user/set/settings/",{body:t,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",[n.nk]:this.fetch.csrfToken},baseUrlType:2})}getParentInfo(e){return this.fetch.get("/aweme/v1/guardian/platform/parent/info/",{query:e,baseUrlType:2})}getIsPinSet(){const e=JSON.stringify([{event_type:2,event_value:"",password:""}]);return this.fetch.post("/tiktok/v1/kids/user/set/settings/",{headers:{"Content-Type":"application/json; charset=UTF-8"},query:{settings:e},baseUrlType:2})}setPin(e){const t=JSON.stringify([{event_type:1,event_value:"1",password:d(e.password)}]);return this.fetch.post("/tiktok/v1/kids/user/set/settings/",{headers:{"Content-Type":"application/json; charset=UTF-8"},query:{settings:t},baseUrlType:2})}checkPin(e){return this.fetch.post("/tiktok/v1/kids/user/check/password/",{body:JSON.stringify(e),headers:{"Content-Type":"application/json; charset=UTF-8"},query:{password:d(e.password)},baseUrlType:2})}};p=(0,a.__decorate)([(0,s._)(),(0,a.__metadata)("design:paramtypes",[o.p])],p)},86515:(e,t,i)=>{i.d(t,{$n:()=>y,BX:()=>D,E9:()=>R,Sx:()=>b,T5:()=>U,Wf:()=>S,ZY:()=>v,Zf:()=>P,b$:()=>L,eR:()=>l,gO:()=>f,jc:()=>A,ml:()=>O,nN:()=>k,rv:()=>g,uA:()=>M,x1:()=>j,yh:()=>w,zk:()=>h});var a=i(68310),s=i(4408),n=i.n(s),o=i(52756),r=i.n(o),d=i(9953),p=i.n(d),_=i(65333),m=i.n(_),u=i(93991),c=i.n(u);function l(e){if(!e.sleep_reminder_enabled||!e)return!1;const t=new Date,i=t.getTime(),a=new Date(t).setHours(e.sleep_time_start_hour,e.sleep_time_start_minute);let s=new Date(t).setHours(e.sleep_time_end_hour,e.sleep_time_end_minute);return s<=a&&(s+=864e5),i>=a&&i<=s}const g=e=>{const t=new Date,i=t.getTime(),a=new Date(t).setHours(e.sleep_time_start_hour,e.sleep_time_start_minute);let s=new Date(t).setHours(e.sleep_time_end_hour,e.sleep_time_end_minute);return s<=a&&(s+=864e5),a-i},y=e=>(e=e||new Date,n()(e).hour()>=18),h=e=>(e=e||new Date,Math.floor((e.getTime()-6e4*e.getTimezoneOffset())/864e5)),T=e=>0===(e=e||new Date).getDay()?7:e.getDay(),S=e=>{const{fp:t,dw:i}=e;let a;return a=t&&2===t.user_identity?t.restriction:i,a},M=e=>{const t=S(e);if(!t)return 0;if(2===t.screen_time_management_repeat_type){const e=T();return t.screen_time_management_week_settings[e-1].screen_time_limit}return t.screen_time_management},v=e=>{let t=e.screen_time_management;if(2===e.screen_time_management_repeat_type){const i=T();t=e.screen_time_management_week_settings[i-1].screen_time_limit}return t},f=(e,t)=>e.replace(/\{(\w+)\}/g,((e,i)=>t[i])),D=e=>Math.floor(e.getTime()/1e3),k=(e,t,i=a.o4)=>{if(localStorage)try{localStorage.setItem(i,JSON.stringify({event:e,value:t}))}catch(e){console.error("stm localstroage occurs error",e)}},A=()=>{try{if(!localStorage)return 0;const e=localStorage.getItem(a.LH);if(!e)return 0;const t=JSON.parse(e);return(new Date).getTime()<=t.timeStamp+5e3&&t.activeTimeUsage||0}catch(e){return console.error(e),0}},b=(e,t)=>{const i=e.userIdentity;if(1===i||3===i||2===i||4===i&&!e.isFpTeenOpenDailySTM||!i){const i=e.userSTMLimit;return e.isOpenDailySTM?((e,t)=>{const i=Math.floor(e/60),a=e%60;return i&&a?t("customizeSTM_screenTimeLimit_selectTimeActionSheet",{hours:i,minutes:a},"{hours}h {minutes}m"):i?t("customizeSTM_screenTimeLimit_selectTime_hours",{hours:i},"{hours}h"):t("customizeSTM_screenTimeLimit_selectTime_minutes",{minutes:a},"{minutes}m")})(i,t):t("screentime_settings_dailyscreentime_status_off",{},"Off")}return 4===i&&e.isFpTeenOpenDailySTM?t("family_safety_mode_locked_mode_indicator",{},"Locked"):""},w=(e,t)=>{const i=e.userIdentity;return 1===i||3===i||4===i&&!e.isFpTeenOpenDailySTM?t("screentimedash_digitalwellbeing_dailyscreentime_desc",{},"Get notified if you reach your time on TikTok."):2===i||4===i&&e.isFpTeenOpenDailySTM?t("customizeSTM_dailyScreenTimeOn_desc_discuss",{username:`@${e.parentUsername}`},"Your daily screen time settings are managed by {username} in Family Pairing."):t("screentimedash_digitalwellbeing_dailyscreentime_desc",{},"Get notified if you reach your time on TikTok.")},O=(e,t)=>{try{if(!sessionStorage)return;let i=!1;if(i=JSON.parse(sessionStorage.getItem(a.w7)||"{}").isUpload||!1,i)return;if(e.isOpenDailySTM){const i=new Date;t.uploadMetric("web_daily_screen_time_limit_status",{status:"on",type:1===e.STMManagementRepeatType?"set the same limit every day":"set a custom limit per day",time:e.userSTMLimit,days:1===e.STMManagementRepeatType?7:i.getDay()})}else t.uploadMetric("web_daily_screen_time_limit_status",{status:"off",type:"null"});e.durationReminder?t.uploadMetric("web_screen_time_break_status",{status:"on",select_time:String(e.durationReminder)}):t.uploadMetric("web_screen_time_break_status",{status:"off",select_time:"null"}),e.isOpenSleepReminder&&e.sleepTimeSettings?t.uploadMetric("web_sleep_reminder_status",{status:"on",sleep_time:`${e.sleepTimeSettings.sleep_time_start_hour.toString()}:${e.sleepTimeSettings.sleep_time_start_minute.toString().padStart(2,"0")}`}):t.uploadMetric("web_sleep_reminder_status",{status:"off",sleep_time:"null"}),t.uploadMetric("web_weekly_screen_time_update_status",{status:e.weeklyScreenTimeUpdates?"on":"off"}),sessionStorage.setItem(a.w7,JSON.stringify({isUpload:!0}))}catch(e){console.error(e)}},P=(e,t)=>{const i=p()(t+":"+e).toString(),a=m().parse(i),s=m().parse(t);return r()(a,s).toString()},B=(e,t)=>{const i=t?(()=>{const e=T();return 1===e?7:e-1})():T(),a=n()(),s=t?a.subtract(1,"day"):a,o=e.screen_down_time_day_setting.find((e=>e.day===i));if(!o)return{status:!1,rule:{startTime:"",endTime:""}};const r=n()().millisecond(0).second(0).minute(o.start_min).hour(o.start_hour).day(s.day()),d=o.end_hour<o.start_hour||o.end_hour===o.start_hour&&o.end_min<o.start_min,p=n()().millisecond(0).second(0).hour(o.end_hour).minute(o.end_min).day(d?s.add(1,"day").day():s.day());return a.isBefore(r)||a.isAfter(p)||a.isSame(p,"minute")?{status:!1,rule:{startTime:"",endTime:""}}:{status:!0,rule:{startTime:o.startTime||"",endTime:o.endTime||""}}},U=e=>{const t=B(e);if(t.status)return t;const i=B(e,!0);return i.status?i:t},F=(e,t)=>{const i=e>=12?"PM":"AM";return`${e%12||12}:${t.toString().padStart(2,"0")} ${i}`},j=e=>{var t;let i;if("object"==typeof(null==e?void 0:e.fp)){i=null===(t=e.fp.restriction)||void 0===t?void 0:t.screen_down_time_settings;const s=null==i?void 0:i.screen_down_time_day_setting;if(i&&c()(s)){const e=(e=>[7,1,2,3,4,5,6].map((t=>{const i=e.find((e=>e.day===t)),{dayName:s,defaultDayName:n}=(e=>{let t="",i="N/A";switch(e){case 1:t="FPscheduledBreak_parentDetailpage_monday",i="Monday";break;case 2:t="FPscheduledBreak_parentDetailpage_tuesday",i="Tuesday";break;case 3:t="FPscheduledBreak_parentDetailpage_wednesday",i="Wednesday";break;case 4:t="FPscheduledBreak_parentDetailpage_thursday",i="Thursday";break;case 5:t="FPscheduledBreak_parentDetailpage_friday",i="Friday";break;case 6:t="FPscheduledBreak_parentDetailpage_saturday",i="Saturday";break;case 7:t="FPscheduledBreak_parentDetailpage_sunday",i="Sunday"}return{defaultDayName:i,dayName:t}})(t);if(i){const[e,t,a]=((e,t,i,a)=>{const s=F(e,t),n=F(i,a);return[`${s} - ${n}`,s,n]})(i.start_hour,i.start_min,i.end_hour,i.end_min);return Object.assign(Object.assign({},i),{dayName:s,defaultDayName:n,daySettingTime:e,startTime:t,endTime:a})}return{start_hour:0,start_min:0,end_hour:0,end_min:0,day:t,screen_down_time_status_day:a.qL.off,dayName:s,daySettingTime:void 0,startTime:void 0,endTime:void 0}})))(s);i.screen_down_time_day_setting=e}}return i},R=(e,t,i)=>e+1e3*t>=36e5+18e5*i,L=e=>{const{time_usage:t}=e;let i=0;if("object"==typeof t&&t.length){const{night_usage:e,day_usage:a}=t[t.length-1];"number"==typeof e&&"number"==typeof a&&(i=e+a)}return i}}}]);