(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[2365],{87379:(e,t,i)=>{"use strict";i.d(t,{$:()=>o,s:()=>s});var n=i(2787),a=i(48712);const s=(e,t,i)=>{const s=t.match(e);let o=0,r=null;if(s){const{length:e}=s,l=s.map((e=>{const i=t.slice(o).indexOf(e)+o,n=i+e.length;return o=n,[i,n]}));r=(0,n.Y)(a.Ro,{children:l.map(((a,s)=>{let o=0;return 0!==s&&(o=l[s-1][1]),(0,n.FD)(n.FK,{children:[(0,n.Y)("span",{children:t.slice(o,a[0])}),i[t.slice(a[0],a[1])],s===e-1&&(0,n.Y)("span",{children:t.slice(a[1],t.length)})]})}))})}return r},o=(e,t)=>{let i=e;for(const[e,n]of Object.entries(t))i=i.replace(e,n);return i}},99372:(e,t,i)=>{"use strict";i.d(t,{T:()=>l});var n=i(2787),a=i(40099),s=i(94893),o=function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function r(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((n=n.apply(e,t||[])).next())}))};const r=({progress:e})=>{const t=2*Math.PI*24;return(0,n.Y)("div",{className:"status-indicator",children:(0,n.FD)("svg",{viewBox:"0 0 100 100",width:"100",height:"100",children:[(0,n.Y)("circle",{cx:"50",cy:"50",r:"24",fill:"transparent",stroke:"rgba(255, 255, 255, 0.4)",strokeWidth:"3"}),(0,n.Y)("circle",{cx:"50",cy:"50",r:"24",fill:"transparent",stroke:"#fff",strokeWidth:"3",strokeDasharray:`${e/100*t} ${t}`,strokeLinecap:"round",style:{transformOrigin:"center",transform:"rotate(-90deg)",transition:"stroke-dasharray 0.5s ease"}}),(0,n.FD)("text",{x:"50",y:"55",textAnchor:"middle",fill:"#fff",fontSize:"12",fontWeight:"500",children:[e.toFixed(0),"%"]})]})})},l=({type:e,src:t,moderationResult:i,isSending:l,sendingProgress:d,localMediaUrl:c,style:u={},mediaStyle:p={},contentTipComponent:g,decryptMedia:h,onClick:m,onLoad:v,onError:f})=>{const b=1===e,_=2===e,y=1===i,x=2===i||4===i,[k,w]=(0,a.useState)(t),[C,S]=(0,a.useState)(!0),[M,j]=(0,a.useState)(!1),[T,I]=(0,a.useState)(!1),L=a.useRef(!0),F=(0,a.useCallback)((()=>o(void 0,void 0,void 0,(function*(){if(h){const e=yield h();if(e){const t=new Uint8Array(e),i=new Blob([t]);return{imgUrl:URL.createObjectURL(i)}}return{imgUrl:""}}throw Error("no decryptMedia")}))),[h]),O=(0,a.useCallback)((()=>{S(!0),h?F().then((e=>{if(!L.current)return;const{imgUrl:t}=e;j(!0),w(t),I(!1),S(!1)})).catch((e=>{L.current&&(I(!0),S(!1),f&&f(e))})):w(`${t}${(null==t?void 0:t.includes("?"))?"&":" ?"}retry_time=${Date.now()}`)}),[h,F,f,t]),D=(0,a.useCallback)((e=>{S(!1),I(!0),f&&f(e)}),[f]),Y=(0,a.useCallback)((()=>o(void 0,void 0,void 0,(function*(){x&&T&&(1===e?yield O():O()),null==m||m({loading:C,hasError:T})}))),[x,T,m,C,e,O]);(0,a.useEffect)((()=>{h&&!c&&x&&O()}),[h,O,x,c]),(0,a.useEffect)((()=>()=>{L.current=!1}),[]),(0,a.useEffect)((()=>{t&&!h&&w(t)}),[t,h]);const E=C||y,R=E&&!c,P=b&&T&&!E&&!c,B=_&&(!E||c),$={width:"100%",height:"100%",objectFit:"cover"},A="image message";return(0,n.FD)(s.Le,{style:Object.assign(Object.assign({},u),P?{cursor:"pointer"}:void 0),onClick:Y,children:[c&&(b?(0,n.Y)("img",{src:c,alt:A,style:Object.assign(Object.assign({},$),p),onContextMenu:e=>e.preventDefault(),onLoad:v}):(0,n.Y)("video",{src:c,style:Object.assign(Object.assign({},$),p),onContextMenu:e=>e.preventDefault()})),x&&!c&&(h?M:k)&&(0,n.Y)("img",{src:k,alt:A,style:Object.assign(Object.assign({opacity:C||T?0:1},$),p),onLoad:()=>{S(!1),I(!1),v&&v()},onError:e=>{D(new Error(`failed to load image: ${e.target.src}`))},onContextMenu:e=>e.preventDefault()}),l&&(0,n.Y)(s.O9,{}),(0,n.Y)(s.GU,{children:l?(0,n.Y)(r,{progress:Math.floor(Number(null!=d?d:0))}):(0,n.FD)(n.FK,{children:[R&&(0,n.Y)(s.vV,{}),P&&(0,n.Y)(s.uF,{}),b&&!R&&!P&&g,B&&(0,n.FD)(s.HB,{children:[(0,n.Y)(s.ko,{}),g]})]})})]})}},94893:(e,t,i)=>{"use strict";i.d(t,{GU:()=>h,HB:()=>m,Le:()=>l,O9:()=>g,ko:()=>p,uF:()=>u,vV:()=>c});var n=i(62186),a=i(75431),s=i(98380),o=i(96936),r=i(88263);const l=(0,n.default)("div",{target:"ew834b00"})({width:"100%",height:"100%",position:"relative"},"label:DivContainer;"),d=a.i7`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,c=(0,n.default)(s.A,{target:"ew834b01"})((({theme:e})=>({fontSize:32,color:e.colors.UIText2,animation:`${d} 1s linear infinite`})),"label:IconLoadingIndicator;"),u=(0,n.default)(o.A,{target:"ew834b02"})((({theme:e})=>({fontSize:32,color:e.colors.UIText2,marginTop:-4})),"label:IconRetryButton;"),p=(0,n.default)(r.A,{target:"ew834b03"})((({theme:e})=>({fontSize:32,color:e.colors.UIText2,marginTop:-4})),"label:IconPlayButton;"),g=(0,n.default)("div",{target:"ew834b04"})({position:"absolute",width:"100%",height:"100%",top:0,left:0,background:"rgba(0,0,0,.2)"},"label:DivSendingMask;"),h=(0,n.default)("div",{target:"ew834b05"})({display:"flex",flexDirection:"column",alignItems:"center",width:"100%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},"label:DivIndicatorContainer;"),m=(0,n.default)("div",{target:"ew834b06"})({display:"flex",flexDirection:"column",alignItems:"center"},"label:DivPlayButtonContainer;")},46522:(e,t,i)=>{"use strict";i.d(t,{Bn:()=>v,eS:()=>g,Ik:()=>m});var n=i(2787),a=i(40099),s=i(46682),o=i(25616),r=i(34178),l=i(25754),d=i(54433),c=i(62186);const u=(0,c.default)("div",{target:"eh000250"})((({width:e,height:t,isLoaded:i,theme:n})=>({position:"relative",borderRadius:"8px",overflow:"hidden",width:e,height:t,backgroundColor:i?"transparent":n.colors.UIShapeNeutral4})),"label:DivStickerContainer;"),p=(0,c.default)("div",{target:"eh000251"})((({theme:e})=>[{width:112,height:112,backgroundColor:e.colors.BGCreation3,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",textAlign:"center",color:e.colors.TextSecondary,fontSize:13,lineHeight:"17px"}]),"label:UnavailableSticker;");var g,h=i(99372);!function(e){e[e.Static=1]="Static",e[e.Animated=2]="Animated",e[e.VideoStickerStatic=3]="VideoStickerStatic",e[e.VideoStickerAnimated=4]="VideoStickerAnimated",e[e.AimojiStickerStatic=5]="AimojiStickerStatic"}(g||(g={}));const m=e=>{var t,i,n,a,s;return Number(null===(s=null===(a=null===(n=null===(i=null===(t=e.contentPb)||void 0===t?void 0:t.sticker_card)||void 0===i?void 0:i.req_base)||void 0===n?void 0:n.query_data)||void 0===a?void 0:a.extra)||void 0===s?void 0:s["a:sticker_type"])},v=(0,a.memo)((function({message:e,isRefMsg:t}){var i,c,v;const f=(0,o.s)(),b=(0,s.w)(r._),[_,y]=(0,a.useState)(!1),x=(0,a.useCallback)((()=>y(!0)),[]);let k,w,C,S=!1;if(5===e.type){S="action_bar:nudge"===e.ext["a:src"];const t=JSON.parse(e.content),{url_list:n=[]}=null!==(i=t.url)&&void 0!==i?i:{};k=n[0],w=S?112:180,C=t.height*w/t.width}else{const{url_list:t,resolution:i}=null===(v=null===(c=e.contentPb)||void 0===c?void 0:c.sticker_card)||void 0===v?void 0:v.sticker;switch(m(e)){case g.Static:case g.Animated:w=C=112;break;case g.VideoStickerStatic:case g.VideoStickerAnimated:w=140,C=i.height/i.width*140;break;default:w=C=140}k=t[0]}t&&(w/=2,C/=2);const M=(0,a.useCallback)((t=>{b.handleLoadMediaFail({message:e,mediaType:10,mediaUrl:k,error:t,scene:"sticker_message"})}),[b,e,k]);return(0,a.useEffect)((()=>{l.w.handleMediaMessageShow({media_type:10,scene:"sticker_message"})}),[]),k?(0,n.Y)(u,{width:w,height:C,isLoaded:_,children:(0,n.Y)(h.T,{type:1,src:k,moderationResult:2,isSending:!1,onLoad:x,onError:M})}):(0,n.Y)(u,{width:112,height:112,isLoaded:!0,children:(0,n.FD)(p,{children:[(0,n.Y)("div",{style:{fontSize:40},children:(0,n.Y)(d.h,{style:{color:"var(--tux-colorTextQuaternary)"}})}),(0,n.Y)("div",{style:{marginTop:8},children:f("sticker_consume_sticker_unavail")})]})})}))},48712:(e,t,i)=>{"use strict";i.d(t,{TG:()=>j,Z5:()=>v,kl:()=>h,IU:()=>g,G2:()=>p,GY:()=>C,th:()=>F,pZ:()=>f,_T:()=>I,kT:()=>z,e$:()=>_,my:()=>b,Mt:()=>U,AG:()=>P,N3:()=>Y,Cy:()=>w,B4:()=>x,B7:()=>y,r$:()=>k,Mm:()=>m,Ro:()=>S,kz:()=>O,mI:()=>M,h6:()=>$,M9:()=>D,T1:()=>R,yC:()=>A,oK:()=>E,dl:()=>L,NX:()=>T});var n=i(62186),a=i(72153),s=i(92846),o=i(24643),r=i(40099),l=i(84987);const d={id:"fail-da144aa4",use:"fail-da144aa4-usage",viewBox:"0 0 24 25",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 25" id="fail-da144aa4"><path fill="#FF4C3A" fill-rule="evenodd" d="M12 3.856a9 9 0 1 0 0 18 9 9 0 0 0 0-18m-11 9c0-6.075 4.925-11 11-11s11 4.925 11 11-4.925 11-11 11-11-4.924-11-11m12.5 4a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m-2-9.5a.5.5 0 0 0-.5.5v5.5a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-5.5a.5.5 0 0 0-.5-.5z" clip-rule="evenodd" /></symbol>'};function c(e){const t=(0,r.useContext)(l.X);return(0,r.useLayoutEffect)((()=>(t.add(d),()=>{t.remove("fail-da144aa4")})),[]),(0,o.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},e,{children:(0,o.jsx)("use",{xlinkHref:"#fail-da144aa4"},void 0)}),void 0)}var u=i(75431);const p=(0,n.default)("div",{target:"e9j91380"})((({isReportMode:e})=>({display:"flex",flexDirection:"column",flexShrink:0,flex:e?1:"0 0 auto"})),"label:DivChatItemWrapper;");p.defaultProps=Object.assign(Object.assign({},p.defaultProps),{"data-e2e":"chat-item"});const g=(0,n.default)("div",{target:"e9j91381"})((({isMyself:e,theme:t,theme:{direction:i}})=>[(0,a.zy)({theme:t,fontFamily:"TikTokFont",color:"TextTertiary"}),{alignSelf:e?"end":"start",fontSize:"12px"},(0,a.mp)({direction:i,marginEnd:"52px",marginStart:"64px"})]),"label:DivChatItemSenderNameContainer;"),h=(0,n.default)("div",{target:"e9j91382"})({width:"32px"},"label:DivChatAvatarPlaceHolder;"),m=(0,n.default)("div",{target:"e9j91383"})((({theme:e,theme:{direction:t,colors:i,isDark:n}})=>[{overflow:"hidden",width:"fit-content",maxWidth:"360px",padding:"7px 12px",borderRadius:"8px",border:"1px solid rgba(22, 24, 35, .12)",background:n?i.BGQuinary:"transparent",fontSize:"16px",lineHeight:"22px",wordBreak:"break-word",whiteSpace:"pre-line"},(0,a.mp)({direction:t,marginStart:"8px"}),(0,a.zy)({theme:e,fontFamily:"TikTokFont",typography:"P2"})]),"label:DivTextContainer;"),v=(0,n.default)("div",{target:"e9j91384"})((({theme:e,show:t,isMyself:i})=>[{flexDirection:i?"row":"row-reverse",visibility:t?"visible":"hidden",width:t?"unset":"0px",padding:t?"0 12px":"unset",gap:"8px",display:"flex",position:"relative",alignItems:"center",justifyContent:"center"},(0,a.zy)({theme:e,color:"UIText2"})]),"label:DivActions;"),f=(0,n.default)("div",{target:"e9j91386"})({width:"24px",height:"24px",padding:"2px",cursor:"pointer"},"label:DivIconAction;"),b=(0,n.default)("div",{target:"e9j91387"})((()=>({display:"flex",flexDirection:"column",margin:"8px 0",gap:"4px"})),"label:DivMessageVerticalContainer;"),_=(0,n.default)("div",{target:"e9j91388"})((({theme:{direction:e,isDark:t},isMyself:i})=>i?[{display:"flex",flexDirection:"row-reverse",alignSelf:"flex-end",width:"100%",[m.toString()]:[{background:t?"rgba(0, 162, 201, 1)":"rgba(22, 24, 35, .06)"},(0,a.mp)({direction:e,marginEnd:"8px",marginStart:"0"})]},(0,a.mp)({direction:e,paddingEnd:"12px"})]:[{display:"flex",flexDirection:"row",alignSelf:"flex-start",width:"100%"},(0,a.mp)({direction:e,paddingStart:"24px"})]),"label:DivMessageHorizontalContainer;"),y=(0,n.default)("div",{target:"e9j91389"})((({isMyself:e,theme:t,theme:{colors:i,direction:n}})=>[{alignSelf:e?"end":"start",fontSize:"13px",maxWidth:"238px",backgroundColor:i.UIShapeNeutral4,borderRadius:"8px",padding:"8px 12px"},(0,a.zy)({theme:t,color:"UIText3",fontFamily:"TikTokFont"}),(0,a.mp)({direction:n,marginEnd:"52px",marginStart:"64px"})]),"label:DivRefTextContent;"),x=(0,n.default)("div",{target:"e9j913810"})((({isMyself:e,isLoading:t,theme:{colors:i,direction:n}})=>[Object.assign(Object.assign({alignSelf:e?"end":"start",backgroundColor:t?i.UIShapeNeutral4:"unset"},t?{width:"90px",height:"90px"}:{}),{borderRadius:"8px"}),(0,a.mp)({direction:n,marginEnd:"52px",marginStart:"64px"})]),"label:DivRefStickerContent;"),k=(0,n.default)("div",{target:"e9j913811"})((({isMyself:e,isLoading:t,theme:{colors:i,direction:n}})=>[{display:"flex",justifyContent:"center",alignItems:"center",alignSelf:e?"end":"start",cursor:t?"default":"pointer",backgroundSize:"cover",backgroundPosition:"center center",backgroundColor:i.UIShapeNeutral4,width:"90px",height:"120px",borderRadius:"8px"},(0,a.mp)({direction:n,marginEnd:"52px",marginStart:"64px"})]),"label:DivRefVideoContent;"),w=(0,n.default)("div",{target:"e9j913812"})((({isMyself:e,isLoading:t,theme:{colors:i,direction:n}})=>[Object.assign({alignSelf:e?"end":"start",backgroundColor:i.UIShapeNeutral4,borderRadius:"8px"},t?{width:"90px",height:"120px"}:{}),(0,a.mp)({direction:n,marginEnd:"52px",marginStart:"64px"})]),"label:DivRefMediaContent;"),C=(0,n.default)("div",{target:"e9j913813"})((({theme:{direction:e},isMyself:t})=>(0,a.mp)({direction:e,[t?"marginEnd":"marginStart"]:"8px"})),"label:DivCommonContainer;"),S=(0,n.default)("p",{target:"e9j913814"})((({theme:e})=>[{margin:"8px 0",textAlign:"center",width:"100%",padding:"0 50px",overflowWrap:"break-word"},(0,a.zy)({theme:e,typography:"P3",fontFamily:"TikTokFont",color:"TextTertiary"})]),"label:PChatTipContainer;"),M=(0,n.default)("p",{target:"e9j913815"})({whiteSpace:"pre-wrap",wordBreak:"break-word"},"label:PText;"),j=(0,n.default)("a",{target:"e9j913816"})((({theme:e})=>[{cursor:"pointer","&:hover":{textDecoration:"underline"}},(0,a.zy)({theme:e,fontFamily:"TikTokFont",fontWeight:"semiBold"})]),"label:AMessageLink;"),T=(0,n.default)(c,{target:"e9j913817"})((({theme:{direction:e}})=>[{width:"24px",height:"24px",marginTop:"4px"},(0,a.mp)({direction:e,marginEnd:"8px"})]),"label:StyledIconFail;"),I=(0,n.default)("div",{target:"e9j913822"})((({theme:{direction:e},isMyself:t,isReportMode:i})=>[{display:"flex",alignItems:"center",alignSelf:t?"flex-end":"flex-start",margin:"-3px 0 6px",float:t?"right":"unset"},(0,a.mp)({direction:e,[t?"marginEnd":"marginStart"]:i?"42px":"64px"})]),"label:DivLikeContainer;"),L=(0,n.default)(s.e,{target:"e9j913823"})((({theme:{direction:e}})=>(0,a.mp)({direction:e,marginStart:"5px"})),"label:StyledAvatar;"),F=(0,n.default)("div",{target:"e9j913824"})({margin:"14px 0",textAlign:"center"},"label:DivErrorTip;");F.defaultProps=Object.assign(Object.assign({},F.defaultProps),{"data-e2e":"dm-message-notification"});const O=(0,n.default)("p",{target:"e9j913825"})((({theme:e})=>[{padding:"0 40px"},(0,a.zy)({theme:e,typography:"P3",fontFamily:"TikTokFont",color:"TextTertiary"})]),"label:PNoticeText;"),D=(0,n.default)("span",{target:"e9j913826"})((({theme:e})=>[{cursor:"pointer"},(0,a.zy)({theme:e,typography:"P3",fontFamily:"TikTokFont",fontWeight:"bold",color:"TextPrimary"})]),"label:SpanClickText;"),Y=(0,n.default)("div",{target:"e9j913827"})((()=>[{maxWidth:"266px",padding:"13px",flexWrap:"wrap",display:"flex",justifyContent:"center",alignItems:"center"}]),"label:DivReactionPanel;"),E=(0,n.default)("span",{target:"e9j913828"})((({theme:{colors:e},selected:t})=>[{borderRadius:8,backgroundColor:t?e.UIShapeNeutral4:"unset"}]),"label:SpanReactionPanelEmoji;"),R=(0,n.default)("span",{target:"e9j913829"})((()=>[{cursor:"pointer",width:40,height:40,borderRadius:8,display:"flex",justifyContent:"center",alignItems:"center",fontSize:"24px",transition:"transform 300ms cubic-bezier(0.645, 0.045, 0.355, 1.000)",transformOrigin:"bottom","&:hover":{transform:"scale(1.45) translateY(6%)"},"&:focus":{transform:"scale(1.45) translateY(6%)"}}]),"label:SpanEmoji;"),P=(0,n.default)("div",{target:"e9j913830"})((({isMyself:e,theme:{direction:t,colors:i}})=>[{cursor:"pointer",alignSelf:e?"end":"start",display:"flex",alignItems:"center",flexWrap:"wrap",gap:"4px",maxWidth:"294px",padding:"5px 10px",borderRadius:100,fontSize:"14px",lineHeight:"18px",letterSpacing:"0.093px",backgroundColor:i.UIShapeNeutral4,transition:"height 300ms ease-in-out"},(0,a.mp)({direction:t,marginEnd:"52px",marginStart:"64px"})]),"label:DivReactionContainer;"),B=u.i7`
  0% {
    transform: translateY(5px) scale(1.0);
  }
  33% {
    transform: translateY(-60px) scale(2.0);
  }
  66% {
    transform: translateY(-60px) scale(2.0);
  }
  100% {
    transform: translateY(0) scale(1.0);
  }
`,$=(0,n.default)("span",{target:"e9j913831"})((()=>({display:"flex",flexWrap:"nowrap",gap:"4px"})),"label:ReactionItem;"),A=(0,n.default)("span",{target:"e9j913832"})((({animate:e})=>Object.assign({fontSize:"16px",width:"18px",height:"18px",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},e&&{animation:`${B} 900ms cubic-bezier(0.455, 0.03, 0.515, 0.955)`})),"label:SpanReactionEmoji;"),U=(0,n.default)("div",{target:"e9j913833"})({position:"absolute",bottom:"-12px",width:"100%",height:"12px",clipPath:"polygon(0 0, 100% 0, calc(50% + 12px) 100%, calc(50% - 12px) 100%)"},"label:DivPopoverArrowHoverExtend;"),z=(0,n.default)("div",{target:"e9j913834"})({".TUXMenuItem:hover":{backgroundColor:"unset",cursor:"unset"}},"label:DivMenuItem;")},81862:(e,t,i)=>{"use strict";i.d(t,{y:()=>l});var n=i(40099),a=i(34012),s=i(4725),o=i(29474),r=i(32125);const l=()=>{const e=(0,a.Ig)(),[{isShowContactButton:t},i]=(0,o.Ks)((e=>({isShowContactButton:e.isShowContactButton})),r.bN),l=(0,n.useCallback)((()=>{e&&i.setIsShowContactButton(!0)}),[i,e]),d=(0,n.useCallback)(((t,n,a,o,r="close-card")=>{e&&((0,s.Hz)("user-select",{uid:t,uniqueId:n,from:o,closeType:r,conversationShortId:a}),i.setIsShowContactButton(!1))}),[i,e]);return{isShowContactButton:e&&t,handleCloseCard:l,handleOpenCard:d}}},2365:(e,t,i)=>{"use strict";i.d(t,{U:()=>pi});var n=i(2787),a=i(40099),s=i(88091),o=i(64454),r=i(62186);r.default.div`
  display: flex;
  margin: 0;
  gap: 6px;
  align-items: center;
`,r.default.div`
  .semi-tag {
    display: none;
  }
`;const l=(0,r.default)("div",{target:"e7idst20"})({cursor:"pointer",display:"flex",padding:"6px 12px",alignItems:"center",gap:"6px",width:"100%",maxHeight:"54px",":hover":{backgroundColor:"#F2F2F2"}},"label:LabelWrapper;"),d=(0,r.default)("div",{target:"e7idst21"})({minWidth:0,flex:"1",maxHeight:"42px",width:"202px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",wordWrap:"break-word"},"label:GroupLabelText;"),c=(0,r.default)("div",{target:"e7idst22"})({minWidth:0,flex:"1",paddingLeft:"32px",maxHeight:"42px",width:"202px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",wordWrap:"break-word"},"label:OptionLabelText;"),u=(0,r.default)("div",{target:"e7idst23"})({width:"100%",height:"60px",padding:"12px",display:"flex",justifyContent:"flex-end",borderTop:"1px solid #E3E3E3"},"label:SelectBottomSlot;"),p=(0,r.default)("div",{target:"e7idst24"})({width:"100%",height:"250px",padding:"0 32px",display:"flex",justifyContent:"center",alignItems:"center",wordBreak:"break-word",textAlign:"center"},"label:EmptyContent;"),g=(0,r.default)("div",{target:"e7idst25"})({transform:"rotate(180deg)",width:"18px",height:"18px"},"label:IconOptionGroupCollapseWrapper;"),h=(0,r.default)("div",{target:"e7idst26"})({width:"18px",height:"18px"},"label:IconOptionGroupExpandWrapper;");var m=i(25616),v=i(53737),f=i(24488),b=i(32125),_=i(24226),y=i(46716),x=i(70629);const k=(0,r.default)("div",{target:"e1gom1d80"})({display:"flex",flexDirection:"column"},"label:CustomSelectPopOverWrapper;"),w=(0,r.default)("div",{target:"e1gom1d81"})({height:"30px",maxWidth:"150px",textOverflow:"ellipsis",whiteSpace:"nowrap",borderRadius:"4px",padding:"4px 9px",justifyContent:"space-between",border:"1px solid rgba(22, 24, 35, 0.12)",display:"flex",alignItems:"center",color:"rgba(0, 0, 0, 0.6)",cursor:"pointer"},"label:CustomSelectWrapper;"),C=(0,r.default)("div",{target:"e1gom1d82"})({marginLeft:"6px",marginRight:"20px"},"label:SelectLabel;"),S=(0,r.default)("div",{target:"e1gom1d83"})({inset:0,position:"fixed",zIndex:"99"},"label:SelectMask;"),M=(0,r.default)("div",{target:"e1mwslzn0"})({width:"280px",height:"320px",marginTop:"31px",zIndex:"100",display:"flex",flexDirection:"column",borderRadius:"4px",boxShadow:"0 2px 8px 0px rgba(0, 0, 0, 0.08)",backgroundColor:`${s.Tj.BGPrimary}`,position:"absolute",overflow:"hidden"},"label:PopOverWrapper;"),j=(0,r.default)("div",{target:"e1mwslzn1"})({display:"flex",flexDirection:"column",overflow:"scroll",flexGrow:"1","::-webkit-scrollbar:horizontal":{height:0,width:0,display:"none"},"::-webkit-scrollbar":{width:"6px"},"::-webkit-scrollbar-track":{backgroundColor:"transparent"},"::-webkit-scrollbar-thumb":{backgroundColor:"transparent"},":hover":{"::-webkit-scrollbar":{width:"6px"},"::-webkit-scrollbar-track":{backgroundColor:"transparent"},"::-webkit-scrollbar-thumb":{backgroundColor:"#D9D9D9",height:"80px",borderRadius:"4px"},msOverflowStyle:"auto",scrollbarWidth:"auto"}},"label:ListWrapper;"),T=(0,a.memo)((function({outerBottomSlot:e,emptyContent:t,optionList:i,renderOptionList:a}){return(0,n.FD)(M,{children:[(0,n.Y)(j,{children:i.length>0?a(i):t}),e]})})),I=(0,a.memo)((function({optionList:e,renderOptionList:t,outerBottomSlot:i,emptyContent:a,handleClickSelect:o,isExpanded:r}){const l=(0,m.s)();return(0,n.FD)(k,{children:[(0,n.FD)(w,{onClick:o,children:[(0,n.Y)(_.R,{size:16}),(0,n.Y)(C,{children:(0,n.Y)(s.Fm,{type:"P4-Regular",children:l("dm_web_baLabel_filter")})}),r?(0,n.Y)(y.D,{size:16}):(0,n.Y)(x.C,{size:16})]}),r?(0,n.Y)(S,{onClick:o}):null,r?(0,n.Y)(T,{optionList:e,outerBottomSlot:i,renderOptionList:t,emptyContent:a}):null]})}));var L=function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function r(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((n=n.apply(e,t||[])).next())}))};const F=()=>{const e=(0,m.s)(),t=(0,v._q)(),[{allConversationTagList:i,allConversationTagGroupList:r,selectedConversationTagList:_},y]=(0,f.n4)((e=>({allConversationTagList:e.allConversationTagList,allConversationTagGroupList:e.allConversationTagGroupList,selectedConversationTagList:e.selectedConversationTagList})),b.bN),[x,k]=(0,a.useState)((()=>_.map((e=>e.label_id)))),w=(0,a.useMemo)((()=>r.map((e=>(e=>{var t,i;return{label:e.label_group_name,id:e.label_group_id,isExpanded:!0,children:null!==(i=null===(t=e.labels)||void 0===t?void 0:t.map((e=>{return{value:(t=e).label_id,label:t.label_name};var t})))&&void 0!==i?i:[]}})(e)))),[r]),[C,S]=(0,a.useState)(!1),[M,j]=(0,a.useState)(w),T=e=>{const t=M.findIndex((t=>t.id===e)),i=M[t],n=Object.assign(Object.assign({},i),{isExpanded:!i.isExpanded}),a=M.map((t=>t.id===e?n:t));j(a)},F=()=>{S(!C)},O=(0,a.useCallback)((()=>L(void 0,void 0,void 0,(function*(){const e=i.filter((e=>x.includes(e.label_id)));y.setSelectedConversationTagList(e),yield t.getConversationListWithFilter()}))),[i,x,y,t]),D=(0,n.Y)(p,{children:(0,n.Y)(s.Fm,{color:"TextTertiary",type:"P4-Regular",children:e("dm_web_baLabel_emptyLabel_state")})}),Y=(0,a.useMemo)((()=>(0,n.Y)(u,{children:(0,n.Y)(s.I0,{label:e("dm_web_baLabel_apply_btn"),variant:"primary",disabled:0===i.length,onClick:()=>L(void 0,void 0,void 0,(function*(){F(),yield O()}))})})),[i,O,e,e("dm_web_baLabel_apply_btn")]);return(0,a.useEffect)((()=>{k(_.map((e=>e.label_id)))}),[_]),(0,n.Y)(I,{outerBottomSlot:Y,emptyContent:D,optionList:M,renderOptionList:e=>e.map((e=>{const{label:t,id:i,isExpanded:a,children:r}=e;return(0,n.FD)(n.FK,{children:[(0,n.FD)(l,{onClick:()=>T(i),children:[a?(0,n.Y)(g,{children:(0,n.Y)(o.Z,{size:18})}):(0,n.Y)(h,{children:(0,n.Y)(o.Z,{size:18})}),(0,n.Y)(d,{children:(0,n.Y)(s.Fm,{type:"P4-Regular",children:t})})]}),a?r.map((e=>(e=>{const{label:t,value:i}=e,a=Boolean(i&&x.includes(i));return(0,n.FD)(l,{onClick:a?()=>(e=>{const t=x.filter((t=>t!==e));k(t)})(i):()=>(e=>{k([...x,e])})(i),children:[(0,n.Y)(c,{children:(0,n.Y)(s.Fm,{type:"P4-Regular",children:t})}),(0,n.Y)(s.h$,{label:"",checked:Boolean(i&&x.includes(i))})]})})(e))):null]})})),handleClickSelect:F,isExpanded:C})};var O=i(21380),D=i(75431);const Y=(0,r.default)("div",{target:"egzbg250"})({display:"flex",alignItems:"flex-start",alignContent:"flex-start",gap:"4px",flexWrap:"wrap",marginBottom:"12px",maxHeight:"90px",overflow:"hidden"},"label:TagWrapper;"),E=(0,r.default)("div",{target:"egzbg251"})({display:"flex",alignItems:"flex-start",alignContent:"flex-start",gap:"4px",flexWrap:"wrap",marginBottom:"12px"},"label:OverflowTagWrapper;"),R=(0,r.default)("div",{target:"egzbg252"})({display:"flex",padding:"2px 8px",alignItems:"center",gap:"4px",borderRadius:"4px",maxWidth:"320px",border:"0.5px solid rgba(22, 24, 35, 0.34)"},"label:Tag;"),P=(0,r.default)("div",{target:"egzbg253"})({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},"label:TagText;"),B=(0,r.default)("div",{target:"egzbg254"})({display:"flex",flex:"1",justifyContent:"center"},"label:FlexRow;"),$=D.i7`
  from {
    transform: rotate(-90deg);
  }

  to {
    transform: rotate(90deg);
  }
`,A=D.i7`
  from {
    transform: rotate(90deg);
  }

  to {
    transform: rotate(-90deg);
  }
`,U=(0,r.default)("div",{target:"egzbg255"})({display:"flex",transform:"rotate(-90deg)",flexGrow:"0",width:"fit-content",color:"rgba(0, 0, 0, 0.32)",cursor:"pointer",animation:`${A} 0.3s ease`},"label:CollapseIconWrapper;"),z=(0,r.default)("div",{target:"egzbg256"})({display:"flex",transform:"rotate(90deg)",flexGrow:"0",width:"fit-content",color:"rgba(0, 0, 0, 0.32)",cursor:"pointer",animation:`${$} 0.3s ease`},"label:ExpandIconWrapper;"),N=(0,r.default)(O.A,{target:"egzbg257"})({cursor:"pointer",size:14},"label:StyledCloseIcon;");var H=i(48037),V=function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function r(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((n=n.apply(e,t||[])).next())}))};const W=()=>{const[{selectedConversationTagList:e},t]=(0,f.n4)((e=>({selectedConversationTagList:e.selectedConversationTagList})),b.bN),i=(0,v._q)(),o=(0,a.useRef)(null),[r,l]=(0,a.useState)(!1),[d,c]=(0,a.useState)(!0),u=n=>V(void 0,void 0,void 0,(function*(){const a=e.filter((e=>e.label_id!==n));t.setSelectedConversationTagList(a),yield i.getConversationListWithFilter()})),p=()=>{c(!d)},g=(0,a.useCallback)((e=>!!e&&90<e.scrollHeight),[]);return(0,a.useEffect)((()=>{g(o.current)?l(!0):(l(!1),c(!0))}),[g,o,e]),(0,a.useEffect)((()=>{V(void 0,void 0,void 0,(function*(){yield t.getAllConversationTags()}))}),[t]),0===e.length?null:(0,n.FD)("div",{children:[d?(0,n.Y)(Y,{ref:o,children:e.map((e=>(0,n.FD)(R,{children:[(0,n.Y)(P,{children:(0,n.Y)(s.Fm,{type:"P4-Regular",children:e.label_name})}),(0,n.Y)(N,{onClick:()=>u(String(e.label_id))})]},e.label_id)))}):(0,n.Y)(E,{ref:o,children:e.map((e=>(0,n.FD)(R,{children:[(0,n.Y)(P,{children:(0,n.Y)(s.Fm,{type:"P4-Regular",children:e.label_name})}),(0,n.Y)(N,{onClick:()=>u(String(e.label_id))})]},e.label_id)))}),(0,n.Y)(B,{children:r?d?(0,n.Y)(U,{onClick:p,children:(0,n.Y)(H.a,{size:20})}):(0,n.Y)(z,{onClick:p,children:(0,n.Y)(H.a,{size:20})}):null})]})};var G=i(11328);const q=(0,r.default)(G.eg,{target:"e105junf0"})({width:"108px",height:"30px"},"label:StyledSkeletonSelectTitle;"),K=(0,r.default)(G.eg,{target:"e105junf1"})({width:"100px",height:"22px"},"label:StyledSkeletonUnreadOnlyTitle;"),Z=(0,r.default)("div",{target:"e105junf2"})({display:"flex",gap:"8px",maxWidth:"150px",whiteSpace:"nowrap"},"label:UnreadOnlySelectorWrapper;"),X=(0,r.default)("div",{target:"e105junf3"})({padding:"12px 16px",display:"flex",flexDirection:"column",justifyContent:"center"},"label:ConversationLabelWrapper;"),Q=(0,r.default)("div",{target:"e105junf4"})({display:"flex",justifyContent:"space-between",alignItems:"center",overflowX:"scroll",scrollbarWidth:"none","&::WebkitScrollbar":{width:0}},"label:DropDownCheckboxWrapper;");var J=i(33147),ee=i(42952),te=function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function r(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((n=n.apply(e,t||[])).next())}))};const ie=(0,a.memo)((function({mode:e}){const t=(0,m.s)(),i=(0,v._q)(),o=(0,J.L_)(),[{selectedConversation:r},l]=(0,ee.VI)((e=>({selectedConversation:e.selectedConversation}))),[{isLoading:d,unreadOnly:c},u]=(0,f.n4)((e=>({isLoading:e.isLoading,unreadOnly:e.unreadOnly})),b.bN),p=(0,a.useCallback)((e=>te(this,void 0,void 0,(function*(){"message-page-visible"===e.data.type&&(yield u.getAllConversationTags())}))),[u]);return(0,a.useEffect)((()=>(window.addEventListener("message",p),()=>{window.removeEventListener("message",p)})),[p]),1===e?null:(0,n.FD)(X,{children:[(0,n.Y)(W,{}),(0,n.FD)(Q,{children:[d?(0,n.Y)(q,{}):(0,n.Y)(F,{}),d?(0,n.Y)(K,{}):(0,n.FD)(Z,{children:[(0,n.Y)(s.h$,{onChange:e=>te(this,void 0,void 0,(function*(){var t,n,a;const s=e.target.checked;if(u.setUnreadOnly(s),r&&!r.isGroupChat){const e=null!==(t=r.toParticipantUserId)&&void 0!==t?t:"",i=null!==(a=null===(n=o.getUser(e))||void 0===n?void 0:n.uniqueId)&&void 0!==a?a:"";(0,v.Hz)("user-delete",{uid:e,uniqueId:i,conversationShortId:r.shortId})}l.setSelectedConversation(void 0),yield i.getConversationListWithFilter()})),checked:c,label:""}),(0,n.Y)(s.Fm,{type:"P4-Regular",children:t("dm_web_baLabel_unreadOnly_checkbox")})]})]})]})}));var ne=i(29474),ae=i(76127),se=i(72153),oe=i(33543),re=i(58542);const le=(0,r.default)("div",{target:"e16uuwmt0"})((({theme:{direction:e}})=>[{width:"100%",height:"60px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 16px 0 24px",boxSizing:"border-box",flexGrow:0,flexShrink:0},(0,se.mp)({direction:e,paddingStart:"24px",paddingEnd:"16px"})]),"label:DivConversationHeader;"),de=(0,r.default)("div",{target:"e16uuwmt1"})({height:oe.in,width:"100%",display:"flex",flexShrink:0,marginInlineStart:"1rem",paddingTop:"1.5rem",paddingBottom:"1rem"},"label:DivFullSideNavConversationHeader;"),ce=(0,r.default)("div",{target:"e16uuwmt2"})((({theme:e})=>[{display:"flex",alignItems:"center",width:"100%",height:"60px",padding:"0 24px 0 24px",flexGrow:0,flexShrink:0},se.PR,(0,se.zy)({theme:e,fontFamily:"TikTokDisplayFont",fontWeight:"bold"})]),"label:DivConversationRequestHeader;"),ue=(0,r.default)("div",{target:"e16uuwmt3"})((()=>[{height:oe.in,display:"flex",width:"100%",marginInlineStart:"1rem",paddingTop:"1.5rem",paddingBottom:"1rem",flexShrink:0,gap:"0.5rem"},se.PR]),"label:DivFullSideNavConversationRequestHeader;"),pe=(0,r.default)("h1",{target:"e16uuwmt4"})((({theme:e})=>[{fontSize:"24px",lineHeight:"28px",color:e.colors.TextPrimary},(0,se.zy)({theme:e,fontFamily:"TikTokDisplayFont",fontWeight:"bold"})]),"label:H1ListTitle;");pe.defaultProps=Object.assign(Object.assign({},pe.defaultProps),{"data-e2e":"message-title"});const ge=(0,r.default)("div",{target:"e16uuwmt5"})({display:"block",width:"32px",height:"32px",cursor:"pointer"},"label:DivSettingIconContainer;");ge.defaultProps=Object.assign(Object.assign({},ge.defaultProps),{"data-e2e":"message-settings-icon"});const he=(0,r.default)(ae.A,{target:"e16uuwmt7"})((({theme:{direction:e,colors:t}})=>({display:"block",width:"20px",height:"20px",cursor:"pointer",transform:`rotate(${"rtl"===e?"0":"180deg"})`,color:t.TextPrimary})),"label:StyledBackIcon;"),me=(0,r.default)(re.I05,{target:"e16uuwmt8"})({"&.TUXButton.TUXButton":{minWidth:"0",height:"1.5rem",padding:"0"},width:"1.5rem","& > div":{"& > .TUXButton-label":{display:"none"}}},"label:StyledTUXMoreBackButton;"),ve=(0,r.default)("div",{target:"e16uuwmt9"})({width:"1.5rem",height:"1.5rem",display:"flex",justifyContent:"center",alignItems:"center"},"label:DivBackIconWrapper;");var fe=i(26290);const be=(0,a.memo)((function({mode:e}){const t=(0,m.s)(),[{conversationListType:i},s]=(0,ne.Ks)((e=>({conversationListType:e.conversationListType})),b.bN),[{selectedConversation:o},r]=(0,ee.VI)((e=>({selectedConversation:e.selectedConversation})),b.bN),l=(0,f.US)(),d=(0,J.L_)(),c=(0,a.useCallback)((()=>{var e,t,i;if(s.setConversationListType("friends"),l.setUnreadOnly(!1),l.setSelectedConversationTagList([]),o){const n=null!==(e=o.toParticipantUserId)&&void 0!==e?e:"",a=null!==(i=null===(t=d.getUser(n))||void 0===t?void 0:t.uniqueId)&&void 0!==i?i:"";(0,v.Hz)("user-delete",{uid:n,uniqueId:a,conversationShortId:o.shortId}),r.setSelectedConversation(void 0)}}),[s,r,l,d,o]);return 2===e?"strangers"===i?(0,n.FD)(ue,{children:[(0,n.Y)(me,{shape:"capsule",variant:"secondary",label:"",leadingIcon:(0,n.Y)(ve,{children:(0,n.Y)(re.pdK,{size:"12",autoMirror:!0})}),onClick:c,"aria-label":t("Back"),role:"button"}),(0,n.Y)(fe.F.H2,{weight:"bold",children:t("message_request_inbox")})]}):(0,n.Y)(n.FK,{children:(0,n.Y)(de,{children:(0,n.Y)(fe.F.H2,{weight:"bold",children:t("webdm_chatlist_head_messages")})})}):1===e?"strangers"===i?(0,n.Y)(ce,{children:(0,n.Y)(he,{onClick:c})}):null:"strangers"===i?(0,n.FD)(ce,{children:[(0,n.Y)(he,{onClick:c}),(0,n.Y)(pe,{children:t("message_request_inbox")})]}):(0,n.Y)(n.FK,{children:(0,n.Y)(le,{children:(0,n.Y)(pe,{children:t("webdm_chatlist_head_messages")})})})}));var _e=i(26456),ye=i(88920),xe=i(49057),ke=i(55291),we=i(46522),Ce=i(87379);function Se({lastVisibleMessage:e,conv:t}){var i,n,a,s,o,r;const l=(0,m.s)(),{user:d}=null!==(i=(0,xe.W)((()=>["user"]),[]))&&void 0!==i?i:{},{enableMultimediaMessage:c,enableStickerMessageDisplay:u}=(0,ke.Q)(),p=(0,J.EL)((t=>{var i;return t.users[null!==(i=null==e?void 0:e.sender)&&void 0!==i?i:""]})),g=(0,J.EL)((e=>{var i,n;return e.users[null!==(n=null===(i=null==t?void 0:t.customLocalLike)||void 0===i?void 0:i.senderUid)&&void 0!==n?n:""]}));if((null==t?void 0:t.customLocalLike)&&t.customLocalLike.date.getTime()>(null!==(s=null===(a=null===(n=null==e?void 0:e.createdAt)||void 0===n?void 0:n.getTime)||void 0===a?void 0:a.call(n))&&void 0!==s?s:0)){let e="";return e=(null==t?void 0:t.customLocalLike.reaction)?(null==t?void 0:t.isGroupChat)?l("reaction_preview_v2_react_group",{0:null==g?void 0:g.nickname,6:null==t?void 0:t.customLocalLike.reaction}):l("reaction_preview_v2_react_private",{6:null==t?void 0:t.customLocalLike.reaction}):(null==t?void 0:t.isGroupChat)?`${null==g?void 0:g.nickname} ${l("like_message")}`:l("like_message"),{isBusinessMsg:!1,lastMessageSenderNickname:null==g?void 0:g.nickname,isMessageReactionPreview:!0,text:e}}const h="tcm"===(null===(o=null==e?void 0:e.ext)||void 0===o?void 0:o["a:bold_msg_extract"])&&(null==e?void 0:e.sender)!==(null==d?void 0:d.uid);let v="",f=null!==(r=null==p?void 0:p.nickname)&&void 0!==r?r:"";const b=(null==e?void 0:e.sender)===(null==d?void 0:d.uid);if(!e)return{isBusinessMsg:!1,text:""};{let i;if([7,1031,5,1].includes(e.type))try{i=JSON.parse(e.content)}catch(e){return console.log("error when parsing",e),{isBusinessMsg:!1,text:""}}const n=()=>{v=l("webdm_message_not_supported")};switch(e.type){case 0:case 49999:v="";break;case 1:v=i.tips;break;case 7:v=(null==t?void 0:t.isGroupChat)?`${f}: ${i.text}`:i.text;break;case 8:v=l(b?"support_webapp_sharing_chat_page_status_2":"support_webapp_sharing_chat_page_status_1");break;case 1037:v=`${l("dm_tcm_card_title_business_invitation")} - ${l("webdm_message_not_supported")}`;break;case 1802:case 1803:c?v=l(b?"dm_cam_preview_chatlist_you_backend":"dm_cam_preview_nonick_backend"):n();break;case 1805:case 5:u?(0,we.Ik)(e)===we.eS.AimojiStickerStatic?v=l(b?"aimoji_inbox_youSent":"aimoji_outapp_private"):(v=l(b?"avatars_in_dm_notif_sender_side":"avatars_in_dm_notif_recipient_side"),b&&(f="")):n();break;case 1031:f="";const a=i.aweType,s=i.max_display_subject_users,o=i.max_display_object_users;let r,d,p;switch(void 0===i.subject_users&&(i.subject_users=[]),void 0===i.object_users&&(i.object_users=[]),a){case 103101:v=l("group_chat_76_notice_create_group",void 0,"%s created the group"),r=i.subject_users.slice(0,Math.min(i.subject_users.length,s)),p={"%s":r.map((e=>e.nickname)).join(",")},v=(0,Ce.$)(v,p);break;case 103102:v=l("group_chat_84_notice_remove_user",void 0,"%1$s removed %2$s"),r=i.subject_users.slice(0,Math.min(i.subject_users.length,s)),d=i.object_users.slice(0,Math.min(i.object_users.length,o)),p={"%1$s":r.map((e=>e.nickname)).join(","),"%2$s":d.map((e=>e.nickname)).join(",")},v=(0,Ce.$)(v,p);break;case 103103:v=l("group_chat_85_notice_become_admin",void 0,"%s became group admin"),r=i.subject_users.slice(0,Math.min(i.subject_users.length,s)),p={"%s":r.map((e=>e.nickname)).join(",")},v=(0,Ce.$)(v,p);break;case 103104:v=l("group_chat_87_notice_user_left_group",void 0,"%s left the group"),r=i.subject_users.slice(0,Math.min(i.subject_users.length,s)),p={"%s":r.map((e=>e.nickname)).join(",")},v=(0,Ce.$)(v,p);break;case 103105:v=l("group_chat_77_notice_add_member",void 0,"%1$s added %2$s to this group"),r=i.subject_users.slice(0,Math.min(i.subject_users.length,s)),d=i.object_users.slice(0,Math.min(i.object_users.length,o)),p={"%1$s":r.map((e=>e.nickname)).join(","),"%2$s":d.map((e=>e.nickname)).join(",")},v=(0,Ce.$)(v,p);break;case 103106:v=l("group_chat_83_notice_rename",void 0,"%1$s named this group to “%2$s”");const e=i.group_name;r=i.subject_users.slice(0,Math.min(i.subject_users.length,s)),p={"%1$s":r.map((e=>e.nickname)).join(","),"%2$s":e},v=(0,Ce.$)(v,p);break;case 103107:v=l("group_chat_81_notice_risk_to_group",void 0,"%s is not friends with anyone in this group. Report this user if you receive an inappropriate message (such as fraud, spam, threats, or predatory behavior)."),r=i.subject_users.slice(0,Math.min(i.subject_users.length,s)),p={"%s":r.map((e=>e.nickname)).join(",")},v=(0,Ce.$)(v,p);break;case 103108:v=l("groupChatSafety_groupDM_inChatLink_resetGroupDesc",void 0,"This group chat name has been reset because the original name violated our Community Guidelines.");break;case 103109:case 103110:v=l("groupChatSafety_groupDM_inChatLink_reportNoticeDesc",void 0,"Your safety is our priority. If you find any inappropriate messages within the group, %s"),p={"%s":l("groupChatSafety_groupDM_inChatLink_reportNoticeLink",void 0,"submit a report")},v=(0,Ce.$)(v,p);break;case 103111:v=l("groupchat_groupChat_u18_removed",void 0,"%s was removed from the group"),r=i.subject_users.slice(0,Math.min(i.subject_users.length,s)),p={"%s":r.map((e=>e.nickname)).join(",")},v=(0,Ce.$)(v,p);break;case 103112:const t=i.object_users.length;switch(r=i.subject_users.slice(0,Math.min(i.subject_users.length,s)),d=i.object_users.slice(0,Math.min(i.object_users.length)),t){case 0:case 1:v=l("group_chat_76_notice_create_group",void 0,"%s created the group"),p={"%s":r.map((e=>e.nickname)).join(",")},v=(0,Ce.$)(v,p);break;case 2:v=l("groupChat_chatpage_inline_creation_2More",void 0,"%1$s created this group chat and added %2$s and %3$s"),p={"%1$s":r.map((e=>e.nickname)).join(","),"%2$s":i.object_users[0].nickname,"%3$s":i.object_users[1].nickname},v=(0,Ce.$)(v,p);break;case 3:v=l("groupChat_chatpage_inline_creation_3More",void 0,"%1$s created this group chat and added %2$s, %3$s and %4$s"),p={"%1$s":r.map((e=>e.nickname)).join(","),"%2$s":i.object_users[0].nickname,"%3$s":i.object_users[1].nickname,"%4$s":i.object_users[2].nickname},v=(0,Ce.$)(v,p);break;default:v=l("groupChat_chatpage_inline_creation_3More_plus",{num:d.length},"%1$s created this group chat and added %2$s, %3$s and %4$s and %5$d more."),p={"%1$s":r.map((e=>e.nickname)).join(","),"%2$s":i.object_users[0].nickname,"%3$s":i.object_users[1].nickname,"%4$s":i.object_users[2].nickname,"%5$d":""+(i.object_users.length-3)},v=(0,Ce.$)(v,p)}break;case 103114:break;default:n()}break;default:n()}}return{isBusinessMsg:h,text:v,lastMessageSenderNickname:f}}var Me=i(4474),je=i(12452),Te=i(11060),Ie=i(73580),Le=i(9350),Fe=i(89311),Oe=i(11654),De=i(34012),Ye=i(25754),Ee=i(58305),Re=i(81862),Pe=i(67518),Be=i(44815),$e=i(38597),Ae=function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function r(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((n=n.apply(e,t||[])).next())}))},Ue=i(24953),ze=i(47656),Ne=i(10263),He=i(34034),Ve=i(71863),We=i(24643),Ge=i(84987);const qe={id:"pin-top-icon-dark-be940e97",use:"pin-top-icon-dark-be940e97-usage",viewBox:"0 0 14 15",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 15" id="pin-top-icon-dark-be940e97"><path fill="white" fill-opacity=".9" fill-rule="evenodd" d="M.219 0C.098 0 0 .087 0 .194v.778c0 .108.098.195.219.195H13.78c.121 0 .219-.087.219-.195V.194C14 .087 13.902 0 13.781 0zm1.733 8.777L7 3.99l5.048 4.786h-3.08v5.055H5.032V8.777zm5.846-5.735a1.19 1.19 0 0 0-1.596 0L.65 8.306c-.655.621-.16 1.638.797 1.638H3.72v4.083c0 .537.49.972 1.094.972h4.375c.604 0 1.093-.435 1.093-.972V9.944h2.272c.957 0 1.453-1.017.798-1.638z" clip-rule="evenodd" /></symbol>'};function Ke(e){const t=(0,a.useContext)(Ge.X);return(0,a.useLayoutEffect)((()=>(t.add(qe),()=>{t.remove("pin-top-icon-dark-be940e97")})),[]),(0,We.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},e,{children:(0,We.jsx)("use",{xlinkHref:"#pin-top-icon-dark-be940e97"},void 0)}),void 0)}const Ze={id:"pin-top-icon-8c20bd45",use:"pin-top-icon-8c20bd45-usage",viewBox:"0 0 16 16",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="pin-top-icon-8c20bd45"><path fill="black" fill-rule="evenodd" d="M2.667 1.333a.333.333 0 0 0-.334.334v.666c0 .184.15.334.334.334h10.666c.184 0 .334-.15.334-.334v-.666a.333.333 0 0 0-.334-.334zM2.529 8.53a.667.667 0 0 0 .47 1.138h2.668V14a.667.667 0 0 0 .666.667h3.334a.667.667 0 0 0 .666-.667V9.667H13a.667.667 0 0 0 .471-1.138l-5-5a.667.667 0 0 0-.942 0zm5.47-3.586 3.391 3.39H9.667A.667.667 0 0 0 9 9v4.333H7V9a.667.667 0 0 0-.667-.667H4.61z" clip-rule="evenodd" /></symbol>'};function Xe(e){const t=(0,a.useContext)(Ge.X);return(0,a.useLayoutEffect)((()=>(t.add(Ze),()=>{t.remove("pin-top-icon-8c20bd45")})),[]),(0,We.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},e,{children:(0,We.jsx)("use",{xlinkHref:"#pin-top-icon-8c20bd45"},void 0)}),void 0)}const Qe="8px solid transparent",Je=(0,r.default)("div",{target:"ebldarn0"})((({isOverflowBottom:e,theme:{isDark:t,colors:i,direction:n}})=>[{position:"absolute",background:t?i.BGQuaternary:i.BGPrimary,borderRadius:"8px",boxShadow:"0px 4px 16px rgba(0, 0, 0, 0.12)",padding:"8px 0px",zIndex:9,top:e?"":"48px",bottom:e?"48px":"",minWidth:"200px",cursor:"pointer","::after":{position:"absolute",right:"12px",top:e?"":"-16px",bottom:e?"-16px":"",transform:e?"rotate(180deg)":"rotate(0deg)",width:"0",height:"0",content:'""',borderBottom:t?`8px solid ${i.BGQuaternary}`:"8px solid white",borderLeft:Qe,borderTop:Qe,borderRight:Qe}},(0,se.mp)({direction:n,end:"8px"})]),"label:DivActionContainer;"),et=(0,r.default)("div",{target:"ebldarn1"})((({theme:{direction:e},theme:t})=>[{position:"relative",display:"flex",height:"100%",alignItems:"center",fontSize:"16px",lineHeight:"22px","::after":Object.assign({content:'""',background:t.colors.LineSecondary},(0,se.WB)("bottom"))},(0,se.mp)({direction:e,paddingEnd:"20px"}),(0,se.zy)({theme:t,fontFamily:"TikTokFont",fontWeight:"semiBold"})]),"label:DivActionDetail;"),tt=(0,r.default)("div",{target:"ebldarn2"})({position:"relative",padding:"0px 16px",height:"48px","&:hover":{background:"rgba(22, 24, 35, 0.03)"},"&:last-child":{[et.toString()]:{"::after":{width:0,height:0}}}},"label:DivActionItem;");tt.defaultProps=Object.assign(Object.assign({},tt.defaultProps),{"data-e2e":"action-item"});const it=({theme:{direction:e,isDark:t}})=>[{width:"16px",height:"16px",color:t?"#fff":"#000"},(0,se.mp)({direction:e,marginEnd:"8px"})],nt=(0,r.default)(Ue.A,{target:"ebldarn3"})(it,"label:StyledUnMuteIcon;"),at=(0,r.default)(ze.A,{target:"ebldarn4"})(it,"label:StyledMuteActionIcon;"),st=(0,r.default)(Ne.A,{target:"ebldarn5"})(it,"label:StyledTrashBin;"),ot=(0,r.default)(Xe,{target:"ebldarn6"})(it,"label:StyledPinToTop;"),rt=(0,r.default)(Ke,{target:"ebldarn7"})(it,"label:StyledPinToTopDark;"),lt=(0,r.default)(He.A,{target:"ebldarn8"})(it,"label:StyledFlagIcon;"),dt=(0,r.default)(Ve.A,{target:"ebldarn9"})(it,"label:StyledBlockIcon;"),ct=(0,a.memo)((function({id:e,isStranger:t=!1,isGroupChat:i=!1,index:s,onClickBody:o}){var r;const l=(0,m.s)(),{isDark:d}=(0,Pe.u)(),{isMuted:c,isStickOnTop:u,toParticipantUserId:p}=(0,ee.by)((t=>{var i,n,a,s,o,r,l,d,c,u,p,g,h,m,v;return{isMuted:null!==(a=null===(n=null===(i=null==t?void 0:t.friends)||void 0===i?void 0:i[e])||void 0===n?void 0:n.isMuted)&&void 0!==a?a:null===(o=null===(s=null==t?void 0:t.strangers)||void 0===s?void 0:s[e])||void 0===o?void 0:o.isMuted,isStickOnTop:null!==(d=null===(l=null===(r=null==t?void 0:t.friends)||void 0===r?void 0:r[e])||void 0===l?void 0:l.isStickOnTop)&&void 0!==d?d:null===(u=null===(c=null==t?void 0:t.strangers)||void 0===c?void 0:c[e])||void 0===u?void 0:u.isStickOnTop,toParticipantUserId:null!==(h=null===(g=null===(p=null==t?void 0:t.friends)||void 0===p?void 0:p[e])||void 0===g?void 0:g.toParticipantUserId)&&void 0!==h?h:null===(v=null===(m=null==t?void 0:t.strangers)||void 0===m?void 0:m[e])||void 0===v?void 0:v.toParticipantUserId}}),b.bN),g=(0,ee.Yl)(),{relation:h}=null!==(r=(0,J.EL)((e=>e.users[null!=p?p:""]),b.bN))&&void 0!==r?r:{},v=4===h,f=(0,a.useRef)(null),_=()=>{const e=document.getElementById(`more-acton-icon-${s}`),t=null==e?void 0:e.getBoundingClientRect();return!!t&&t.top+48+256>window.innerHeight};(0,a.useEffect)((()=>(document.addEventListener("click",o),_(),()=>{document.removeEventListener("click",o)})),[]);const y=(0,a.useCallback)((e=>{o(),(0,Ee.Gu)(e)}),[o]),x=(0,a.useCallback)((e=>{13!==e.keyCode&&32!==e.keyCode&&27!==e.keyCode||(o(),(0,Ee.Gu)(e)),9===e.keyCode&&setTimeout((()=>{var e;Array.from(null===(e=f.current)||void 0===e?void 0:e.children).includes(document.activeElement)||o()}),100)}),[o]),{handleMute:k,handleDelete:w,handleStickTop:C,handleReport:S,handleBlock:M}=function({id:e,isStranger:t,index:i}){const n=(0,ne.Xq)(),[s,o]=(0,ee.VI)((t=>{var i,n;return null!==(n=null!==(i=t.friends[e])&&void 0!==i?i:t.strangers[e])&&void 0!==n?n:{}}),b.bN),{isMuted:r,isStickOnTop:l,toParticipantUserId:d=""}=s,[{relation:c},u]=(0,J.Sk)((e=>{var t;return null!==(t=e.users[d])&&void 0!==t?t:{}}),b.bN),p=4===c;return{handleMute:(0,a.useCallback)((()=>Ae(this,void 0,void 0,(function*(){yield o.setConversationSettingInfo({id:e,mute:!r}),Ye.w.handleChatMuteClick({to_status:r?"off":"on",conversation_id:e})}))),[e,r,o]),handleDelete:(0,a.useCallback)((()=>Ae(this,void 0,void 0,(function*(){t?yield n.deleteStranger({conversation:s}):yield o.deleteConversation({id:e}),Ye.w.handleDeleteChat({is_stranger:t,conversation_id:e})}))),[t,e,n,s,o]),handleStickTop:(0,a.useCallback)((()=>Ae(this,void 0,void 0,(function*(){yield o.setConversationSettingInfo({id:e,stickOnTop:!l}),Ye.w.handleChatTopClick({to_status:l?"off":"on",conversation_id:e})}))),[e,l,o]),handleReport:(0,a.useCallback)((()=>{n.setIsShowReportSelectModal(!0),o.setRecordedFocusOrigin(`more-acton-icon-${i}`),o.setSelectedConversation(s),Be.o.handleShowReport({enter_from:"chat",is_stranger:t,conversation_id:e})}),[n,o,s,t,e,i]),handleBlock:(0,a.useCallback)((()=>Ae(this,void 0,void 0,(function*(){yield u.blockUser({uid:d,isBlock:!p}),$e.h.handleBlock({to_user_id:d,conversation_id:e,chat_type:"private"},!p)}))),[u,d,p,e])}}({id:e,isStranger:t,index:s}),j=(0,a.useCallback)(((e,t=!1)=>i=>{13===i.keyCode&&(null==e||e(),t&&g.setRecordedFocusOrigin(`more-acton-icon-${s}`))}),[g,s]);return(0,n.FD)(Je,{id:`more-action-panel-${s}`,onClick:y,onKeyDown:x,ref:f,role:"listbox",isOverflowBottom:_(),children:[!t&&(0,n.Y)(tt,{onClick:k,onKeyDown:j(k),tabIndex:0,role:"option",children:(0,n.FD)(et,{children:[c?(0,n.Y)(nt,{}):(0,n.Y)(at,{}),(0,n.Y)("p",{children:l(c?"dm_left_swipe_unmute":"dm_left_swipe_mute")})]})}),(0,n.Y)(tt,{onClick:w,onKeyDown:j(w),tabIndex:0,role:"option",children:(0,n.FD)(et,{children:[(0,n.Y)(st,{}),(0,n.Y)("p",{children:l("dm_delete")})]})}),!t&&(0,n.Y)(tt,{onClick:C,onKeyDown:j(C),tabIndex:0,role:"option",children:(0,n.FD)(et,{children:[d?(0,n.Y)(rt,{}):(0,n.Y)(ot,{}),(0,n.Y)("p",{children:l(u?"no_top":"webdm_pin_to_top")})]})}),(0,n.Y)(tt,{onClick:S,onKeyDown:j(S,!0),tabIndex:0,role:"option",children:(0,n.FD)(et,{children:[(0,n.Y)(lt,{}),(0,n.Y)("p",{children:l("webdm_report")})]})}),!i&&(0,n.Y)(tt,{onClick:M,onKeyDown:j(M),tabIndex:0,role:"option",children:(0,n.FD)(et,{children:[(0,n.Y)(dt,{}),(0,n.Y)("p",{children:l(v?"unblock":"webdm_block")})]})})]})}));var ut=i(54731),pt=i(92846);const gt="56px",ht="48px",mt="224px",vt="180px",ft=(0,r.default)(ut.A,{target:"eii3f6d0"})((({theme:{direction:e,colors:t}})=>[{position:"absolute",display:"none",width:"24px",height:"24px",top:"24px","&:focus-visible":{display:"block"},color:t.TextPrimary},(0,se.mp)({direction:e,end:"16px"})]),"label:StyledMoreActionIcon;");ft.defaultProps=Object.assign(Object.assign({},ft.defaultProps),{"data-e2e":"more-action-icon"});const bt=(0,r.default)(ze.A,{target:"eii3f6d1"})((({theme:{direction:e,colors:t}})=>[{position:"absolute",display:"block",width:"16px",height:"16px",top:"28px",color:t.TextTertiaryAlt},(0,se.mp)({direction:e,end:"20px"})]),"label:StyledMuteIcon;"),_t=(0,r.default)("div",{target:"eii3f6d2"})((({theme:{direction:e,colors:t},unreadCount:i=0})=>[{position:"absolute",display:"block",minWidth:i>0?"20px":"8px",height:i>0?"20px":"8px",top:"32px",color:t.ConstTextInverse,background:"#fe2c55",borderRadius:"10px",textAlign:"center",padding:i>=10?"0 6px":"0"},(0,se.mp)({direction:e,end:"20px"})]),"label:SpanNewMessage;"),yt={[ft.toString()]:{display:"block"},[bt.toString()]:{display:"none"},[_t.toString()]:{display:"none"}},xt=({isSelected:e,isStickOnTop:t,isFullSideNav:i,isDark:n,colors:a})=>i?t||e?re.Tj4.UIShapeNeutral4:"unset":t?n?a.BGView:"rgba(22, 24, 35, 0.03)":e?n?a.BGView:"#f1f1f1":"inherit",kt=({isFullSideNav:e,isDark:t,colors:i})=>e?re.Tj4.UIShapeNeutral3:t?i.BGView:"#f1f1f1",wt=(0,r.default)("div",{target:"eii3f6d3"})((({isSelected:e,showMoreAction:t,isStickOnTop:i,isFullSideNav:n,theme:{isDark:a,colors:s}})=>[{position:"relative",width:"100%",height:"72px",display:"flex",alignItems:"center",justifyContent:"space-between",paddingInlineStart:n?"1rem":"1.5rem",paddingInlineEnd:"20px",boxSizing:"border-box",backgroundColor:xt({isSelected:e,isStickOnTop:i,isFullSideNav:n,isDark:a,colors:s}),cursor:"pointer","&:hover":Object.assign({backgroundColor:kt({isFullSideNav:n,isDark:a,colors:s})},yt),"&:focus-visible":Object.assign({backgroundColor:kt({isFullSideNav:n,isDark:a,colors:s}),outlineStyle:"auto"},yt)},t?yt:null]),"label:DivItemWrapper;");wt.defaultProps=Object.assign(Object.assign({},wt.defaultProps),{"data-e2e":"chat-list-item"});const Ct=(0,r.default)("div",{target:"eii3f6d4"})({display:"flex",alignItems:"center"},"label:DivItemInfo;"),St=(0,r.default)("div",{target:"eii3f6d5"})((({isFullSideNav:e})=>({position:"relative",width:e?ht:gt,height:e?ht:gt})),"label:DivInfoAvatarWrapper;"),Mt=(0,r.default)(pt.e,{target:"eii3f6d6"})({position:"absolute",left:"0",top:"0",display:"block",borderRadius:"50%",backgroundColor:"rgba(136, 136, 136, 0.5)"},"label:StyledAvatar;"),jt=(0,r.default)("div",{target:"eii3f6d7"})((({isFullSideNav:e})=>({position:"absolute",left:"0",top:"0",display:"block",width:e?ht:gt,height:e?ht:gt,border:"1px solid rgba(22, 24, 35, 0.12)",borderRadius:"50%"})),"label:DivInfoAvatarMask;"),Tt=(0,r.default)("div",{target:"eii3f6d8"})((({theme:{direction:e}})=>(0,se.mp)({direction:e,paddingStart:"12px"})),"label:DivInfoTextWrapper;"),It=(0,r.default)("p",{target:"eii3f6d9"})((({theme:e,isFullSideNav:t})=>[{fontSize:"16px",lineHeight:"22px",minHeight:"22px",color:e.colors.TextPrimary,maxWidth:t?vt:mt},se.PR,(0,se.zy)({theme:e,fontFamily:"TikTokFont",fontWeight:"semiBold"})]),"label:PInfoNickname;"),Lt=(0,r.default)("p",{target:"eii3f6d10"})((({theme:e,isFullSideNav:t})=>[{display:"flex",maxWidth:t?vt:mt,paddingTop:"4px",fontSize:"14px",lineHeight:"20px",color:e.colors.TextSecondary},(0,se.zy)({theme:e,fontFamily:"TikTokFont"})]),"label:PInfoExtractTime;"),Ft=(0,r.default)("span",{target:"eii3f6d11"})((({theme:e})=>[{flexShrink:0,color:e.colors.TextPrimary},(0,se.zy)({theme:e,fontFamily:"TikTokFont",fontWeight:"semiBold"})]),"label:SpanInfoTcm;"),Ot=(0,r.default)("span",{target:"eii3f6d12"})(se.PR,"label:SpanInfoExtract;"),Dt=(0,r.default)("span",{target:"eii3f6d13"})((({theme:{direction:e,colors:t}})=>[{display:"inline-block",flexShrink:0,lineHeight:"20px",minHeight:"20px",color:t.TextTertiaryAlt},(0,se.mp)({direction:e,paddingStart:"4px"})]),"label:SpanInfoTime;");var Yt=function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function r(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((n=n.apply(e,t||[])).next())}))};const Et=(0,a.memo)((function({isStranger:e=!1,isGroupChat:t=!1,mode:i,id:s,shortId:o,index:r}){var l,d,c,u,p;const g=(0,ye.rl)(),h=(0,m.s)(),{user:f}=null!==(l=(0,xe.W)((()=>["user"]),[]))&&void 0!==l?l:{},[{selectedConversation:b,actionOpenedConversation:_,conversation:y,hasProcessedGroupChatUserMap:x},k]=(0,ee.VI)((t=>{var i;return{selectedConversation:t.selectedConversation,actionOpenedConversation:t.actionOpenedConversation,conversation:null!==(i=e?t.strangers[s]:t.friends[s])&&void 0!==i?i:{},hasProcessedGroupChatUserMap:t.hasProcessedGroupChatUserMap}})),w=(null==_?void 0:_.id)===y.id,C=(0,v._q)(),S=(0,Le.rp)(),{lastVisibleMessage:M,toParticipantUserId:j="",isMuted:T,isStickOnTop:I,unreadCount:L,ext:F}=y;let{updatedAt:O}=y;const{nickname:D,avatarThumb:Y,relation:E,uniqueId:R}=(0,J.EL)((e=>{var t;return null!==(t=e.users[j])&&void 0!==t?t:{}})),P=null!==(c=null===(d=y.coreInfo)||void 0===d?void 0:d.name)&&void 0!==c?c:"",B=null!==(p=null===(u=y.coreInfo)||void 0===u?void 0:u.icon)&&void 0!==p?p:"",$=(null==b?void 0:b.id)===s,A="tcm"===(null==F?void 0:F["a:banner_indicator"])&&(null==F?void 0:F["a:banner_setter"])!==(null==f?void 0:f.uid),[U,z]=(0,a.useState)(!1),{text:N,isBusinessMsg:H,lastMessageSenderNickname:V}=Se({lastVisibleMessage:M,unreadCount:e&&U?0:L,conv:y});y.customLocalLike&&(null===M||y.customLocalLike.date.getTime()>M.createdAt.getTime())&&(O=y.customLocalLike.date);const W=((e,t)=>e&&t?(new Date).toString().slice(0,15)===e.toString().slice(0,15)?_e.Ay.format(e,"LT"):_e.Ay.format(e,"l"):null)(O,M),G=function({conversation:e,isSelected:t,isStranger:i,hasRead:n}){const{unreadCount:a,customLocalLike:s,lastVisibleMessage:o}=e;return i?a>0&&!n:(a>0||s&&(null===o||s.date.getTime()>o.createdAt.getTime())&&!s.hasRead)&&!t}({conversation:y,isSelected:$,isStranger:e,hasRead:U}),{handleOpenCard:q}=(0,Re.y)(),K=(0,a.useCallback)((e=>{(0,Ee.Gu)(e),Ye.w.handleChatSettingClick(s),setTimeout((()=>{k.setActionOpenedConversation(y)}),0)}),[s,y,k]),Z=(0,a.useCallback)((e=>{13!==e.keyCode&&32!==e.keyCode||((0,Ee.Gu)(e),Ye.w.handleChatSettingClick(s),setTimeout((()=>{k.setActionOpenedConversation(y)}),0)),(9===e.keyCode&&e.shiftKey||27===e.keyCode)&&k.setActionOpenedConversation(void 0)}),[s,y,k]),X=(0,a.useCallback)((()=>{k.setActionOpenedConversation(void 0)}),[k]),Q=(0,a.useCallback)((()=>Yt(this,void 0,void 0,(function*(){if(y.isGroupChat&&!x[y.id]){const e=S.getConversationparticipants(y);yield C.getMultiUsersByUids({uidList:e}),k.setProcessedGroupChatUsers(y.shortId)}k.setSelectedConversation(y),e?(yield k.markConversationRead({id:s}),z(!0)):yield k.markConversationRead({id:s}),Ye.w.handleEnterChat({relation_tag:E,is_stranger:e,conversation_id:s,chat_type:A?"business":t?"group":"private"}),y.customLocalLike&&!y.customLocalLike.hasRead&&(y.customLocalLike.hasRead=!0),q(j,R,o,"conversation-item")}))),[y,k,q,s,o,A,e,t,E,j,R,x,S,C]),te=(0,a.useCallback)((e=>Yt(this,void 0,void 0,(function*(){13===e.keyCode&&(yield Q())}))),[Q]),ie=(0,a.useCallback)((()=>y.isGroupChatBanned?(0,n.Y)(Ot,{children:h("dm_riskyGroupChat_groupClosed_body",void 0,"This group chat is closed due to violations of our Community Guidelines. If you think this was a mistake, you may submit an appeal.")}):(0,n.Y)(Ot,{children:N})),[N,y,V,h]),ne=(0,a.useCallback)((()=>0===L?"":L<=99?L:"99+"),[L]);return 1===i?(0,n.Y)(wt,{isSelected:$,showMoreAction:w,isStickOnTop:I,tabIndex:0,onClick:Q,onKeyDown:te,isFullSideNav:!1,children:(0,n.Y)(Ct,{children:(0,n.FD)(St,{isFullSideNav:!1,children:[(0,n.Y)(Mt,{src:y.isGroupChat?B:Y,size:56,alt:""}),(0,n.Y)(jt,{isFullSideNav:!1})]})})}):(0,n.FD)(wt,{id:`more-acton-icon-${r}`,isSelected:$,showMoreAction:w,isStickOnTop:I,onClick:Q,onKeyDown:te,tabIndex:0,isFullSideNav:g,children:[(0,n.FD)(Ct,{children:[(0,n.FD)(St,{isFullSideNav:g,children:[(0,n.Y)(Mt,{src:y.isGroupChat?B:Y,size:g?48:56,alt:""}),(0,n.Y)(jt,{isFullSideNav:g})]}),(0,n.FD)(Tt,{children:[(0,n.Y)(It,{isFullSideNav:g,children:y.isGroupChat?P:D}),(0,n.FD)(Lt,{isFullSideNav:g,children:[H&&(0,n.FD)(n.FK,{children:[(0,n.Y)(Ft,{children:h("dm_tcm_label_business")}),(0,n.Y)("span",{style:{margin:"0 4px"},children:"·"})]}),ie(),(0,n.Y)(Dt,{children:W})]})]})]}),T?(0,n.Y)(bt,{}):G?(0,n.Y)(_t,{unreadCount:L,children:ne()}):null,(0,n.Y)(ft,{onClick:K,onKeyDown:Z,role:"button",tabIndex:0,"aria-expanded":w,"aria-haspopup":"true","aria-controls":w?`more-action-panel-${r}`:""}),w&&(0,n.Y)(ct,{id:s,isStranger:e,isGroupChat:y.isGroupChat,index:r,onClickBody:X})]})})),Rt={id:"request-group-icon-59187b51",use:"request-group-icon-59187b51-usage",viewBox:"0 0 56 56",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56" id="request-group-icon-59187b51"><circle cx="28" cy="28" r="28" fill="#57608A" /><path fill="white" fill-rule="evenodd" d="M28 40c6.627 0 12-5.373 12-12s-5.373-12-12-12-12 5.373-12 12c0 2.708.897 5.206 2.41 7.214l-1.632 1.247c-.491.374-.778.95-.778 1.561 0 1.092.902 1.978 2.015 1.978zm-3-15.163a1 1 0 1 0 0 2h6a1 1 0 1 0 0-2zm-3 5.898a1 1 0 0 1 1-1h10a1 1 0 1 1 0 2H23a1 1 0 0 1-1-1" clip-rule="evenodd" /></symbol>'};function Pt(e){const t=(0,a.useContext)(Ge.X);return(0,a.useLayoutEffect)((()=>(t.add(Rt),()=>{t.remove("request-group-icon-59187b51")})),[]),(0,We.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},e,{children:(0,We.jsx)("use",{xlinkHref:"#request-group-icon-59187b51"},void 0)}),void 0)}const Bt=(0,r.default)("div",{target:"efjalot0"})((({theme:{colors:e,isDark:t},isFullSideNav:i})=>({position:"relative",width:"100%",height:"72px",backgroundColor:i?"unset":e.BGSecondary,display:"flex",alignItems:"center",justifyContent:"space-between",paddingInlineStart:i?"1rem":"1.5rem",paddingInlineEnd:"20px",boxSizing:"border-box",cursor:"pointer","&:hover":{backgroundColor:i?re.Tj4.UIShapeNeutral3:t?e.BGView:"rgba(22, 24, 35, 0.03)"}})),"label:DivRequestGroup;"),$t=(0,r.default)("div",{target:"efjalot1"})({display:"flex",alignItems:"center"},"label:DivRequestInfo;"),At=(0,r.default)(Pt,{target:"efjalot2"})((({isFullSideNav:e})=>({display:"block",width:e?ht:gt,height:e?ht:gt,borderRadius:"50%",fill:"none"})),"label:StyledRequestAvatar;"),Ut=(0,r.default)("div",{target:"efjalot3"})((({theme:{direction:e}})=>(0,se.mp)({direction:e,paddingStart:"12px"})),"label:DivInfoTextWrapper;"),zt=(0,r.default)("span",{target:"efjalot4"})((({theme:e})=>[{flexShrink:0,color:e.colors.TextPrimary},(0,se.zy)({theme:e,fontFamily:"TikTokFont",fontWeight:"semiBold"})]),"label:SpanInfoTcm;"),Nt=(0,r.default)("span",{target:"efjalot5"})(se.PR,"label:SpanInfoExtract;");const Ht=(0,a.memo)((function({mode:e,id:t,shortId:i,index:s}){var o,r;const l=(0,ye.rl)(),d=(0,m.s)(),c=(0,ne.Xq)(),[{strangerConversationList:u},p]=(0,v.D1)(),[{friends:g,strangers:h,selectedConversation:f},_]=(0,ee.VI)((e=>({friends:e.friends,strangers:e.strangers,selectedConversation:e.selectedConversation})),b.bN),y=null!==(r=null!==(o=g[t])&&void 0!==o?o:h[t])&&void 0!==r?r:{},{isBusinessMsg:x}=Se({lastVisibleMessage:y.lastVisibleMessage}),k=(0,J.L_)(),w=(0,De.Ig)(),C=(0,a.useCallback)((()=>{return e=this,t=void 0,n=function*(){var e,t,i;if(c.setConversationListType("strangers"),f){const n=null!==(e=f.toParticipantUserId)&&void 0!==e?e:"",a=null!==(i=null===(t=k.getUser(n))||void 0===t?void 0:t.uniqueId)&&void 0!==i?i:"";(0,v.Hz)("user-delete",{uid:n,uniqueId:a,conversationShortId:f.shortId}),_.setSelectedConversation(void 0)}yield p.getStrangerConversationList({isLoadMore:!1,forceRefresh:w}),Ye.w.handleEnterStrangerChatList()},new((i=void 0)||(i=Promise))((function(a,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function r(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((n=n.apply(e,t||[])).next())}));var e,t,i,n}),[p,c,_,w,k,f]);return y.isStrangerConversation?1!==e?(0,n.FD)(Bt,{onClick:C,isFullSideNav:l,children:[(0,n.FD)($t,{children:[(0,n.Y)(At,{isFullSideNav:l,"aria-hidden":!0}),(0,n.FD)(Ut,{children:[(0,n.Y)(It,{isFullSideNav:l,children:d("message_request_inbox")}),(0,n.FD)(Lt,{isFullSideNav:l,children:[x&&(0,n.FD)(n.FK,{children:[(0,n.Y)(zt,{children:d("dm_tcm_label_business")}),(0,n.Y)("span",{style:{margin:"0 4px"},children:"·"})]}),(0,n.Y)(Nt,{children:d("Message_req_optimize_chatList_body",{num:u.length}).replace("%d",String(u.length))})]})]})]}),(0,n.Y)(_t,{unreadCount:u.length,children:u.length>99?"99+":u.length})]}):(0,n.Y)(Bt,{onClick:C,isFullSideNav:!1,children:(0,n.Y)($t,{children:(0,n.Y)(At,{"aria-hidden":!0,isFullSideNav:!1})})}):y.lastVisibleMessage?(0,n.Y)(Et,{mode:e,id:t,shortId:i,index:s,isGroupChat:y.isGroupChat}):null}));var Vt=i(22568);const Wt=(0,r.default)("div",{target:"etdtmal0"})((({theme:e})=>[{background:"rgba(22, 24, 35, .03)",padding:"0px 16px",height:"72px",fontSize:"14px",lineHeight:"72px"},(0,se.zy)({theme:e,fontFamily:"TikTokFont"})]),"label:DivEmptyList;"),Gt=(0,r.default)("div",{target:"etdtmal1"})({display:"flex",alignItems:"center",gap:"0.675rem",justifyContent:"flex-start",width:"100%",background:re.Tj4.UIShapeNeutral4,padding:"0.5rem"},"label:DivFullSideNavEmptyMessageContainer;"),qt=(0,r.default)("div",{target:"etdtmal2"})({display:"flex",alignItems:"center",justifyContent:"center",width:"3rem",height:"3rem",borderRadius:"50%",border:`1px solid ${re.Tj4.UIShapeNeutral3}`},"label:DivFullSideNavEmptyMessageIconContainer;"),Kt=(0,r.default)("div",{target:"etdtmal3"})((({isFullSideNav:e})=>({position:"relative",width:"100%",height:"72px",display:"flex",alignItems:"center",paddingInlineStart:e?"1rem":"1.5rem",paddingInlineEnd:"24px"})),"label:DivSkeletonContainer;"),Zt=(0,r.default)(G.NH,{target:"etdtmal4"})((({isFullSideNav:e})=>({width:e?ht:gt,height:e?ht:gt})),"label:StyledSkeletonAvatar;"),Xt=(0,r.default)("div",{target:"etdtmal5"})((({theme:{direction:e}})=>(0,se.mp)({direction:e,paddingStart:"12px"})),"label:DivSkeletonTextWrapper;"),Qt=(0,r.default)(G.eg,{target:"etdtmal6"})((({theme:{isDark:e,colors:t},long:i})=>[{width:i?"200px":"120px",height:i?"12px":"16px",background:e?t.BGTertiary2:"#f1f1f1",borderRadius:"4px"},i?{marginTop:"10px"}:null]),"label:StyledSkeletonTitle;"),Jt=(0,r.default)("div",{target:"etdtmal7"})({overflow:"auto",height:"100%"},"label:DivListContent;"),ei=(0,r.default)(Vt.U,{target:"etdtmal8"})({"&::-webkit-scrollbar":{display:"none"},"&::-webkit-scrollbar-thumb":{display:"none"}},"label:StyledScroll;"),ti=(0,r.default)("div",{target:"etdtmal9"})({position:"absolute",width:"1px",height:"1px",padding:0,margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap"},"label:DivMessageStatus;"),ii=(0,r.default)("div",{target:"etdtmal10"})({height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",padding:"0 24px",alignItems:"center",textAlign:"center"},"label:EmptyListFilterContent;"),ni=(0,r.default)("div",{target:"etdtmal11"})({marginTop:"24px",display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",flexDirection:"column",gap:"8px"},"label:EmptyListText;");const ai=new Array(15).fill(1),si={height:"100%"},oi=(e,t)=>(0,n.FD)(Kt,{isFullSideNav:2===e,children:[(0,n.Y)(Zt,{isFullSideNav:2===e}),(0===e||2===e)&&(0,n.FD)(Xt,{children:[(0,n.Y)(Qt,{}),(0,n.Y)(Qt,{long:!0})]})]},t),ri=(0,a.memo)((function({mode:e}){const t=(0,m.s)(),i=(0,Te.zy)(),s=(0,Te.W6)(),{isRTL:o}=(0,Fe.m)(),r=(0,a.useRef)(null),l=(0,a.useRef)(null),d=(0,a.useRef)(null),c=(0,a.useRef)(!1),u=(0,Ie.Nj)(Oe.V$),p=(0,a.useRef)(""),g=(0,a.useMemo)((()=>performance.now()),[]),[h,f]=(0,a.useState)(!1),_=(0,De.Ig)(),[{conversationListType:y},x]=(0,ne.Ks)((e=>({conversationListType:e.conversationListType})),b.bN),[{allConversationList:k,conversationList:w,conversationMap:C,strangerConversationList:S,isListLoading:M,initialized:j},T]=(0,v.D1)((e=>({allConversationList:e.allConversationList,conversationList:e.conversationList,conversationMap:e.conversationMap,strangerConversationList:e.strangerConversationList,isListLoading:e.isListLoading,initialized:e.initialized}))),{hasMoreFriends:I,hasMoreGroup:L,hasMoreStranger:F}=(0,Le.Ye)((e=>({hasMoreFriends:e.hasMoreFriends,hasMoreGroup:e.hasMoreGroup,hasMoreStranger:e.hasMoreStranger})),b.bN),O=(0,ee.Yl)(),D=(0,De.XJ)(),Y=(0,ye.cV)(),E="friends"===y&&0!==w.length||"strangers"===y&&0!==S.length;return((e,t,i=!1)=>{var n,s,o,r;const{conversationList:l,strangerConversationList:d}=(0,v.VB)((e=>({conversationList:e.conversationList,strangerConversationList:e.strangerConversationList})),b.bN),c=(0,a.useRef)(null==l?void 0:l.length),u=(0,a.useRef)(null==d?void 0:d.length);if(i){const e=d.length,i=u.current;if(e!==i){if(e>i){try{(null===(o=null==t?void 0:t.current)||void 0===o?void 0:o.lastChild)&&t.current.removeChild(t.current.lastChild)}catch(e){console.error(e)}const e=document.createElement("p");e.innerHTML="New messages from some stranger.",e.setAttribute("aria-atomic","true"),e.setAttribute("aria-relevant","additions"),null===(r=null==t?void 0:t.current)||void 0===r||r.appendChild(e)}u.current=d.length}}else{const t=l.length,i=c.current;if(t!==i){if(t>i){try{(null===(n=null==e?void 0:e.current)||void 0===n?void 0:n.lastChild)&&e.current.removeChild(e.current.lastChild)}catch(e){console.error(e)}const t=document.createElement("p");t.innerHTML="New messages from some friend.",t.setAttribute("aria-atomic","true"),t.setAttribute("aria-relevant","additions"),null===(s=null==e?void 0:e.current)||void 0===s||s.appendChild(t)}c.current=l.length}}})(l,d,"strangers"===y),(0,a.useEffect)((()=>{M||h||(u.reportActualFMP(),Ye.w.handleReportMessagePageLcp({is_business_account:_,lcp:Number(performance.now()-g)}),f(!0))}),[M,u,_,g,h]),(0,a.useEffect)((()=>{(()=>{var e,t,n,a;e=this,t=void 0,a=function*(){var e;const t=(0,Me.parse)(i.search),{u:n}=t;let a="";if(n&&j){c.current=!1,p.current=n;const o=k.some((e=>e.toParticipantUserId===n&&(a=e.id,!0)));delete t.u;const r=(0,Me.stringify)(t);s.replace(Object.assign(Object.assign({},i),{search:r})),T.setOtherUid(n),(!o||!(null===(e=C[p.current])||void 0===e?void 0:e.lastVisibleMessage))&&(yield T.sendMessage({convId:a,uid:n,type:49999,content:"",hasConversation:!1}))}p.current&&!c.current&&k.some((e=>e.toParticipantUserId===p.current&&(c.current=!0,e.isStrangerConversation&&x.setConversationListType("strangers"),O.setSelectedConversation(e),!0)))},new((n=void 0)||(n=Promise))((function(i,s){function o(e){try{l(a.next(e))}catch(e){s(e)}}function r(e){try{l(a.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,r)}l((a=a.apply(e,t||[])).next())}))})()}),[i,j,T,k,O,s,C,x]),(0,n.Y)(Jt,{children:(0,n.Y)(ei,{ref:r,style:{height:"100%",paddingLeft:o?0:"unset",paddingRight:o?"unset":0},wrapperStyle:Object.assign(Object.assign({},si),{overflow:2===e?"auto":"unset"}),bottomThreshold:0,children:M||I||Y&&L||0!==w.length?(M||"strangers"===y&&F||"friends"===y&&(I||Y&&L))&&!E?ai.map(((t,i)=>oi(e,i))):"strangers"===y?(0,n.FD)(n.FK,{children:[S.map(((t,i)=>t.lastVisibleMessage?(0,n.Y)(Et,{isStranger:!0,mode:e,id:t.id,shortId:t.shortId,index:i},t.id):null)),F&&ai.slice(0,2).map(((t,i)=>oi(e,i))),(0,n.FD)(ti,{"aria-live":"off",children:[(0,n.Y)("div",{ref:l}),(0,n.Y)("div",{ref:d})]})]}):(0,n.FD)(n.FK,{children:[w.map(((t,i)=>(0,n.Y)(Ht,{mode:e,id:t.id,shortId:t.shortId,index:i},t.id))),(I||Y&&L)&&ai.slice(0,2).map(((t,i)=>oi(e,i))),(0,n.FD)(ti,{"aria-live":"off",children:[(0,n.Y)("div",{ref:l}),(0,n.Y)("div",{ref:d})]})]}):D?(0,n.FD)(ii,{children:[(0,n.Y)(fe.F,{color:"UITextPlaceholder",children:(0,n.Y)(je.n,{size:72})}),(0,n.FD)(ni,{children:[(0,n.Y)(fe.F.P1,{weight:"bold",children:t("dm_web_baLabel_noChatFound_header")}),(0,n.Y)(fe.F.P3,{children:t("dm_web_baLabel_noChatFound_body")})]})]}):2===e?(0,n.FD)(Gt,{children:[(0,n.Y)(qt,{children:(0,n.Y)(re.Y4q,{size:"24",color:"UIShapeNeutral3"})}),(0,n.Y)(fe.F.P1,{weight:"medium",children:t("im_message_list_empty")})]}):(0,n.Y)(Wt,{children:t("im_message_list_empty")})})})})),li=(0,r.default)("div",{target:"e1axnl2b0"})((({theme:{colors:e},mode:t})=>({position:"relative",flexShrink:0,display:"flex",flexDirection:"column",width:0===t?"400px":2===t?"100%":"104px",height:"100%",background:2===t?"unset":e.BGSecondary,boxShadow:"0 2px 8px rgba(0, 0, 0, .06)",borderRadius:"8px"})),"label:DivConversationListContainer;"),di=(0,r.default)("div",{target:"e1axnl2b1"})((({theme:{direction:e,colors:t}})=>[{position:"absolute",top:"8px",width:"40px",height:"40px",paddingTop:"10px",borderRadius:"100%",backgroundColor:t.BGView,cursor:"pointer",transform:"rtl"===e?"rotateY(180deg)":"none"},(0,se.mp)({direction:e,start:"-56px",paddingStart:"10px"})]),"label:DivBackIconContainer;");di.defaultProps=Object.assign(Object.assign({},di.defaultProps),{"data-e2e":"back-btn"});var ci=i(26354),ui=i(85349);const pi=(0,a.memo)((function({isFromBusiness:e,ariaLabel:t}){const i=(0,ye.rl)(),{mode:s}=function(){const[e,t]=(0,a.useState)(0);return(0,a.useEffect)((()=>{const i=()=>{window.innerWidth<768?0===e&&t(1):1===e&&t(0)};return window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)}),[e]),{mode:(0,ye.rl)()?2:e}}(),o=(0,ee.Yl)(),r=(0,De.XJ)(),l=(0,a.useCallback)((()=>{o.removeRefMessage(),window.history.back(),Ye.w.handleLeaveChatList()}),[o]),d=(0,a.useCallback)((e=>{13!==e.keyCode&&32!==e.keyCode||(e.preventDefault(),e.stopPropagation(),l())}),[l]);return(0,n.Y)(ui.t,{isMobile:!1,componentName:"message-conversation-list",children:(0,n.FD)(li,{mode:s,children:[!e&&!i&&(0,n.Y)(di,{onClick:l,onKeyDown:d,tabIndex:0,role:"button","aria-label":t,children:(0,n.Y)(ci.A,{width:20,height:20})}),(0,n.Y)(be,{mode:s}),r?(0,n.Y)(ie,{mode:s}):null,(0,n.Y)(ri,{mode:s})]})})}))},55291:(e,t,i)=>{"use strict";i.d(t,{$:()=>u,Q:()=>p});var n=i(40099),a=i(26456),s=i(49057),o=i(48615),r=i(4725),l=i(60484),d=i(71281),c=function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function r(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((n=n.apply(e,t||[])).next())}))};function u(){var e,t;const{language:l="en"}=null!==(e=(0,s.W)((()=>["language"]),[]))&&void 0!==e?e:{},{dateFmtLocale:d}=null!==(t=(0,o.U)((()=>["dateFmtLocale"]),[]))&&void 0!==t?t:{};(0,n.useEffect)((()=>{(0,r.Hz)("on-load",{from:"message"})}),[]),(0,n.useEffect)((()=>{d?a.Ay.setLocaleConfig(d):(()=>{c(this,void 0,void 0,(function*(){try{const{localeConfig:e}=yield i(27988)(`./${(0,a.wA)(l)}/index.es.js`);a.Ay.setLocaleConfig(e)}catch(e){try{const{localeConfig:e}=yield i.e(4563).then(i.bind(i,10914));a.Ay.setLocaleConfig(e)}catch(e){console.error("Failed to load default locale:",e)}}}))})()}),[d,l])}function p(){var e,t,i,n,a;const o=(0,l.L$)((0,s.W)((()=>["abTestVersion"]),[])),r=null!==(e=(0,d.qt)(null==o?void 0:o.abTestVersion,"web_dm_multimedia_msg"))&&void 0!==e?e:"v1",c=null!==(t=(0,d.qt)(null==o?void 0:o.abTestVersion,"web_dm_sticker_msg_display"))&&void 0!==t?t:"v1",u=null!==(i=(0,d.qt)(null==o?void 0:o.abTestVersion,"web_dm_group_chat"))&&void 0!==i?i:"v1",p=null===(a=null===(n=null==o?void 0:o.abTestVersion)||void 0===n?void 0:n.parameters)||void 0===a?void 0:a.web_dm_multimedia_msg,{video_limit:g=15,image_limit:h=10}=null!=p?p:{};return{enableMultimediaMessage:"v2"===r,enableStickerMessageDisplay:"v2"===c,enableGroupChat:"v2"===u,videoFileSizeLimit:g,imageFileSizeLimit:h}}},22568:(e,t,i)=>{"use strict";i.d(t,{U:()=>p});var n=i(24643),a=i(40099),s=i(90159),o=i(62186),r=i(72153);const l=(0,o.default)("div",{target:"e1b4u1n0"})({position:"absolute",padding:"0 4px",top:"0",transformOrigin:"right top",transition:"opacity .5s",opacity:0},(({theme:{direction:e}})=>{const t=(0,r.t7)(e,"end");return[(0,r.mp)({direction:e,end:"0"}),{transformOrigin:`${t} top`}]}),"label:DivScrollBar;"),d=(0,o.default)("div",{target:"e1b4u1n1"})({overflowX:"hidden",overflowY:"auto",overscrollBehaviorY:"contain",perspective:"1px",transformStyle:"preserve-3d","::-webkit-scrollbar":{width:0,height:0},[`:hover ${l}`]:{opacity:1}},(({theme:{direction:e}})=>{const t=(0,r.t7)(e,"end");return[(0,r.mp)({direction:e,paddingEnd:"12px"}),{perspectiveOrigin:`${t} top`}]}),"label:DivScrollContainer;"),c=(0,o.default)("div",{target:"e1b4u1n2"})("label:DivScrollWrapper;"),u=(0,o.default)("div",{target:"e1b4u1n3"})((({theme:{colors:e}})=>({width:"6px",height:"100%",borderRadius:"3px",background:e.BGPlaceholderDefault})),"label:DivScrollBarThumb;"),p=(0,a.memo)((0,a.forwardRef)((function({children:e,Wrapper:t=c,onScroll:i,onScrollBottom:o,bottomThreshold:r=100,className:p,style:g,wrapperStyle:h},m){const v=(0,a.useRef)(null),[f,b]=(0,a.useState)(0),[_,y]=(0,a.useState)(0),x=(0,a.useMemo)((()=>{const e=f>=_?0:Math.pow(f,2)/_,t=(f-e)/(_-f);return{height:e,transform:`matrix3d(${[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,-1].join(",")}) scale(${1/t}) translateZ(${1-1/t}px) translateZ(-2px)`}}),[f,_]);(0,a.useImperativeHandle)(m,(()=>({get scrollTop(){var e,t;return null!==(t=null===(e=v.current)||void 0===e?void 0:e.scrollTop)&&void 0!==t?t:0},get dom(){return v.current}})),[]);const k=(0,s._g)((()=>{if(!v.current)return;const{current:e}=v,{height:t}=e.getBoundingClientRect(),{scrollHeight:i}=e;b(t),y(i)}),[],300),w=(0,a.useCallback)((()=>{if(!v.current||!o)return;const{scrollTop:e}=v.current;null==i||i({scrollTop:e}),f+e+r>=_&&o()}),[o,i,f,r,_]);return(0,a.useEffect)((()=>{const e=new window.MutationObserver((function(e){e.length&&k()}));return v.current&&e.observe(v.current,{childList:!0,subtree:!0}),window.addEventListener("resize",k),()=>{window.removeEventListener("resize",k),e.disconnect()}}),[k]),(0,n.jsxs)(d,{ref:v,onScroll:w,className:p,style:g,children:[(0,n.jsx)(t,{style:h,children:e}),(0,n.jsx)(l,{style:x,children:(0,n.jsx)(u,{})})]})})))},34178:(e,t,i)=>{"use strict";i.d(t,{_:()=>F});var n,a=i(58632),s=i(64162),o=i(4126),r=i(93995),l=i(340),d=i(46657),c=i(23999),u=i(82970),p=i(26324),g=i(72916),h=i(24451),m=i(74690),v=i(80339),f=i(8536),b=i(35572),_=i(62564),y=i(95719),x=i(20259),k=i(11983),w=i(55322),C=i(64356),S=i(79983),M=i(52333),j=i(17953),T=i(60212),I=i(54888),L=i(25754);!function(e){e.Friends="friends",e.Strangers="strangers"}(n||(n={}));let F=class extends s.E{constructor(e,t,i,n,a,s){super(),this.service=e,this.slardar=t,this.itemList=i,this.item=n,this.bizContext=a,this.t=s,this.defaultState={friends:{},strangers:{},selectedConversation:void 0,currentMessage:{list:[],hasMore:!0},isLoadingMoreMessage:!1,failedMessageMap:{},hasFeedbackMap:{},failedVideoCodeMap:{},itemListByMessageId:[],recordedFocusOrigin:"",moderationResultMap:{},sendingProgressMap:{},lastUpdatedMap:{}}}multiSetConversation(e,t){const{list:i,isStranger:n}=t,a={};return i.forEach((e=>{a[e.id]=e})),n?Object.assign(Object.assign({},e),{strangers:Object.assign(Object.assign({},e.strangers),a)}):Object.assign(Object.assign({},e),{friends:Object.assign(Object.assign({},e.friends),a)})}setUser(e,t){const{item:i,isStranger:n}=t;return n?Object.assign(Object.assign({},e),{strangers:Object.assign(Object.assign({},e.strangers),{[i.id]:i})}):Object.assign(Object.assign({},e),{friends:Object.assign(Object.assign({},e.friends),{[i.id]:i})})}addFailedMessage(e,t){e.failedMessageMap=Object.assign(Object.assign({},e.failedMessageMap),t)}setModerationResult(e,t){e.moderationResultMap=Object.assign(Object.assign({},e.moderationResultMap),t)}setLastUpdated(e,t){e.lastUpdatedMap=Object.assign(Object.assign({},e.lastUpdatedMap),t)}setSelectedConversation(e,t){e.selectedConversation=t}setMessageListAction(e,t){e.currentMessage.list=null!=t?t:[]}setRecordedFocusOrigin(e,t){e.recordedFocusOrigin=t}setMessageHasMore(e,t){e.currentMessage.hasMore=t}setIsLoadingMoreMessage(e,t){e.isLoadingMoreMessage=t}setHasFeedbackMap(e,t){e.hasFeedbackMap=Object.assign(Object.assign({},e.hasFeedbackMap),{[t]:!0})}setFailedVideoCodeMap(e,t){e.failedVideoCodeMap=Object.assign(Object.assign({},e.failedVideoCodeMap),t)}setItemListByMessageId(e,t){e.itemListByMessageId=t}setSendingProgress(e,t){const{messageId:i,sendingProgress:n}=t,a=e.sendingProgressMap[i],s=Object.assign(Object.assign({},a),n);e.sendingProgressMap=Object.assign(Object.assign({},e.sendingProgressMap),{[i]:s})}loadMoreMessage(e){return e.pipe((0,g.n)((({conversation:e,abTestVersion:t})=>this.service.getMessagesByConversation({conversation:e}).pipe((0,h.E)(this.state$),(0,g.n)((([{hasMore:i},{selectedConversation:n}])=>{if((null==n?void 0:n.id)!==e.id)return d.w;const a=e.getMessageList();return(0,c.of)(this.getActions().setMessageHasMore(i),this.getActions().setMessageList({list:a,abTestVersion:t}))})),(0,m.Z)(this.getActions().setIsLoadingMoreMessage(!0)),(0,v.q)(this.getActions().setIsLoadingMoreMessage(!1))))))}setConversationSettingInfo(e){return e.pipe((0,h.E)(this.state$),(0,f.Z)((([{id:e,mute:t,stickOnTop:i},{friends:n,strangers:a}])=>{var s,o;const r=null!==(o=null!==(s=n[e])&&void 0!==s?s:a[e])&&void 0!==o?o:{};return this.service.setConversationSettingInfo({conversation:r,mute:t,stickOnTop:i}),d.w})))}deleteConversation(e){return e.pipe((0,h.E)(this.state$),(0,f.Z)((([{id:e},{friends:t}])=>{var i;const n=null!==(i=t[e])&&void 0!==i?i:{};return this.service.deleteConversation({conversation:n}),(0,c.of)(this.getActions().setSelectedConversation(void 0))})))}markConversationRead(e){return e.pipe((0,h.E)(this.state$),(0,f.Z)((([{id:e},{friends:t}])=>{var i;const n=null!==(i=t[e])&&void 0!==i?i:{};return this.service.markConversationRead({conversation:n}),d.w})))}markStrangerConversationRead(e){return e.pipe((0,h.E)(this.state$),(0,f.Z)((([{id:e},{strangers:t}])=>{var i;const n=null!==(i=t[e])&&void 0!==i?i:{};return this.service.markStrangerConversationRead({conversation:n}),d.w})))}handleMessageSend(e){return e.pipe((0,h.E)(this.state$),(0,f.Z)((([e,{selectedConversation:t}])=>{if(!t)return d.w;const i=8===e.type;return(0,c.of)(this.getActions().getMessageList({id:null==t?void 0:t.id,shouldHandleVideoMessage:i,abTestVersion:e.abTestVersion}))})))}handleReceiveNewMessage(e){return e.pipe((0,h.E)(this.state$),(0,f.Z)((([e,{selectedConversation:t}])=>{if(!t)return d.w;const i=8===e.type;return(0,c.of)(this.getActions().getMessageList({id:null==t?void 0:t.id,shouldHandleVideoMessage:i,abTestVersion:e.abTestVersion}))})))}handleMessageDelete(e){return e.pipe((0,h.E)(this.state$),(0,f.Z)((([e,{selectedConversation:t}])=>{if(!t)return d.w;const i=8===e.type;return(0,c.of)(this.getActions().getMessageList({id:null==t?void 0:t.id,shouldHandleVideoMessage:i,abTestVersion:e.abTestVersion}))})))}handleMessageUpsert(e){return e.pipe((0,h.E)(this.state$),(0,f.Z)((([{message:e,abTestVersion:t},{selectedConversation:i}])=>i&&[1802,1803].includes(e.type)&&7===e.source?(0,c.of)(this.getActions().getMessageList({id:null==i?void 0:i.id,shouldHandleVideoMessage:!1,abTestVersion:t})):d.w)))}getMessageList(e){return e.pipe((0,h.E)(this.state$),(0,g.n)((([{id:e,shouldHandleVideoMessage:t,abTestVersion:i},{friends:n,strangers:a}])=>{var s;const o=a[e],r=n[e],l=Boolean(o);if(!o&&!r)return d.w;if(l)return(0,c.of)(this.getActions().getStrangerMessageList({id:e,shouldHandleVideoMessage:t,abTestVersion:i}));const u=null!==(s=null==r?void 0:r.getMessageList())&&void 0!==s?s:[];return(0,c.of)(this.getActions().setMessageList({list:u,shouldHandleVideoMessage:t,abTestVersion:i}))})),(0,w.n)({}))}getStrangerMessageList(e){return e.pipe((0,h.E)(this.state$),(0,g.n)((([{id:e,shouldHandleVideoMessage:t,abTestVersion:i},{strangers:n}])=>{const a=n[e];return a?this.service.getStrangerConversationMessage({conversation:a}).pipe((0,g.n)((e=>(0,c.of)(this.getActions().setMessageList({list:e,shouldHandleVideoMessage:t,abTestVersion:i}))))):d.w})),(0,w.n)({}))}setMessageList(e){return e.pipe((0,h.E)(this.state$,this.item.state$),(0,f.Z)((([{list:e,shouldHandleVideoMessage:t=!0,abTestVersion:i},{failedVideoCodeMap:n},a])=>{if(!t)return(0,c.of)(this.getActions().setMessageListAction(e));const s=[],o=[],r=[];return e.forEach((e=>{const{type:t,content:i,clientId:l}=e;if(8!==t)return;let d={};try{d=JSON.parse(i)}catch(e){return null}const c=null==d?void 0:d.itemId;n[c]||(o.push(c),r.push(l),a[c]||s.push(c))})),(0,c.of)(this.getActions().setMessageListAction(e),this.getActions().getVideoList({needRequestList:s,allList:o,allListByMessageId:r,abTestVersion:i}))})))}getVideoList(e){return e.pipe((0,h.E)(this.bizContext.state$),(0,g.n)((([{needRequestList:e,allList:t,allListByMessageId:i},n])=>{if(!e.length)return(0,c.of)(this.itemList.getActions().setItemListById({key:"messages",list:t}),this.getActions().setItemListByMessageId(i));const a=e.map((e=>{var t,i;return this.service.getItemInfo(e,null===(i=null===(t=n.bizContext)||void 0===t?void 0:t.videoCoverSettings)||void 0===i?void 0:i.format)}));return(0,u.z)(a).pipe((0,g.n)((n=>{const a={},s=[];return n.forEach((({statusCode:n,itemInfo:o},r)=>{const l=e[r];if(0!==n){a[l]=n;const e=t.indexOf(l);e>-1&&(t.splice(e,1),i.splice(e,1))}else s.push(null==o?void 0:o.itemStruct)})),(0,c.of)(this.getActions().setFailedVideoCodeMap(a),...this.item.addItems(s),this.itemList.getActions().setItemListById({key:"messages",list:t}),this.getActions().setItemListByMessageId(i))})),(0,w.n)({}))})))}deleteMessage(e){return e.pipe((0,b.p)((({message:e})=>(this.service.deleteMessage({message:e}),d.w))))}likeMessage(e){return e.pipe((0,b.p)((({message:e,isLiked:t})=>(this.service.modifyMessageProperty({message:e,isLiked:t}),d.w))))}handleMessagePropertyUpsert(e){return e.pipe((0,h.E)(this.state$),(0,f.Z)((([e,{friends:t,strangers:i,selectedConversation:n}])=>{var a,s,o;const r=null!==(a=e.uid)&&void 0!==a?a:"",l=e.conversationId,u=null!==(o=null!==(s=t[l])&&void 0!==s?s:i[l])&&void 0!==o?o:{};if(e.property["e:love"]){const{sender:t}=e;if(t!==r)return d.w;const i=e.property["e:love"],{length:a}=i;for(let e=0;e<a;e++){const t=i[e];if(t.userId!==r){const e=n===u;return u.customLocalLike={like:!0,date:t.createTime,hasRead:e},(0,c.of)(this.getActions().multiSetConversation({list:[u],isStranger:u.isStrangerConversation}))}}}else u.customLocalLike=null;return d.w})))}handleRefreshMessage(e){return e.pipe((0,h.E)(this.state$),(0,f.Z)((([e])=>{let t=Number(e.ext["a:moderation_result"]);if("true"===e.ext["a:is_violative"]&&(t=3),t>1){const{content:i}=e,n=i.match(/"server_message_id":(\d+)/);if(!n)return d.w;const a=n[1];return(0,c.of)(this.getActions().setModerationResult({[a]:t}))}return d.w})))}updateMessageFromServer(e){return e.pipe((0,f.Z)((e=>this.service.getConversationByMessage({message:e}).pipe((0,_.T)((t=>({message:e,conversation:t})))))),(0,f.Z)((({message:e,conversation:t})=>this.service.getMessages({messages:[e],conversation:t,upsert:!0}).pipe((0,_.T)((t=>({message:e,messages:t})))))),(0,f.Z)((({message:e,messages:t})=>(0,c.of)(this.getActions().setLastUpdated({[e.clientId]:{timestamp:Date.now(),success:Boolean(t&&t.length>0)}})))))}feedbackMessage(e){return e.pipe((0,h.E)(this.state$),(0,b.p)((([{shortId:e,uid:t,content:i,messageId:n,messageType:a,contentPb:s,senderUid:o,serverMsgId:r},{hasFeedbackMap:l}])=>{const c=this.t("direct_meaasge_sending_ban_feedback_again"),u=this.t("Sorry, something wrong with the server, please try again.");return l[n]?(k.F.open({content:c,duration:3,widthType:"half"}),d.w):this.service.feedbackMessage({shortId:e,uid:t,content:i,messageId:n,messageType:a,contentPb:s,senderUid:o,serverMsgId:r}).pipe((0,y.M)((({status_code:e})=>{0===e?k.F.open({content:c,duration:3,widthType:"half"}):k.F.open({content:u,duration:3,widthType:"half"})})),(0,_.T)((({status_code:e})=>0===e?this.getActions().setHasFeedbackMap(n):this.noop())),(0,x.W)((()=>(k.F.open({content:u,duration:3,widthType:"half"}),d.w))))})))}handleLoadMediaFail(e){return e.pipe((0,f.Z)((({message:e,mediaType:t,mediaUrl:i,error:n,scene:a})=>(this.slardar.handleLoadMediaFail({media_type:t,media_url:i,moderation_result:e.ext["a:moderation_result"]||"",conversation_id:e.conversationId,message_server_id:e.serverId,error:`${n}`,scene:a}),L.w.handleMediaMessageShowFail({media_type:t,scene:a}),d.w))))}handleMediaModerationTimeout(e){return e.pipe((0,f.Z)((({message:e,mediaType:t,mediaUrl:i})=>(this.slardar.handleMediaModerationTimeout({media_type:t,media_url:i,conversation_id:e.conversationId,message_server_id:e.serverId}),d.w))))}};(0,a.__decorate)([(0,o.HI)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Object]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"multiSetConversation",null),(0,a.__decorate)([(0,o.HI)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Object]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"setUser",null),(0,a.__decorate)([(0,o.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Object]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"addFailedMessage",null),(0,a.__decorate)([(0,o.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Object]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"setModerationResult",null),(0,a.__decorate)([(0,o.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Object]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"setLastUpdated",null),(0,a.__decorate)([(0,o.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Object]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"setSelectedConversation",null),(0,a.__decorate)([(0,o.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Object]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"setMessageListAction",null),(0,a.__decorate)([(0,o.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,String]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"setRecordedFocusOrigin",null),(0,a.__decorate)([(0,o.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Boolean]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"setMessageHasMore",null),(0,a.__decorate)([(0,o.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Boolean]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"setIsLoadingMoreMessage",null),(0,a.__decorate)([(0,o.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,String]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"setHasFeedbackMap",null),(0,a.__decorate)([(0,o.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Object]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"setFailedVideoCodeMap",null),(0,a.__decorate)([(0,o.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Array]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"setItemListByMessageId",null),(0,a.__decorate)([(0,o.h5)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Object]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"setSendingProgress",null),(0,a.__decorate)([(0,o.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[p.c]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"loadMoreMessage",null),(0,a.__decorate)([(0,o.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[p.c]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"setConversationSettingInfo",null),(0,a.__decorate)([(0,o.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[p.c]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"deleteConversation",null),(0,a.__decorate)([(0,o.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[p.c]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"markConversationRead",null),(0,a.__decorate)([(0,o.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[p.c]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"markStrangerConversationRead",null),(0,a.__decorate)([(0,o.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[p.c]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"handleMessageSend",null),(0,a.__decorate)([(0,o.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[p.c]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"handleReceiveNewMessage",null),(0,a.__decorate)([(0,o.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[p.c]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"handleMessageDelete",null),(0,a.__decorate)([(0,o.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[p.c]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"handleMessageUpsert",null),(0,a.__decorate)([(0,o.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[p.c]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"getMessageList",null),(0,a.__decorate)([(0,o.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[p.c]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"getStrangerMessageList",null),(0,a.__decorate)([(0,o.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[p.c]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"setMessageList",null),(0,a.__decorate)([(0,o.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[p.c]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"getVideoList",null),(0,a.__decorate)([(0,o.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[p.c]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"deleteMessage",null),(0,a.__decorate)([(0,o.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[p.c]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"likeMessage",null),(0,a.__decorate)([(0,o.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[p.c]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"handleMessagePropertyUpsert",null),(0,a.__decorate)([(0,o.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[p.c]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"handleRefreshMessage",null),(0,a.__decorate)([(0,o.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[p.c]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"updateMessageFromServer",null),(0,a.__decorate)([(0,o.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[p.c]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"feedbackMessage",null),(0,a.__decorate)([(0,o.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[p.c]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"handleLoadMediaFail",null),(0,a.__decorate)([(0,o.Mj)(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[p.c]),(0,a.__metadata)("design:returntype",void 0)],F.prototype,"handleMediaModerationTimeout",null),F=(0,a.__decorate)([(0,r.n)("ConversationModule"),(0,a.__param)(5,(0,l.y)(C.hp)),(0,a.__metadata)("design:paramtypes",[j.b,T.Z,S.O,M.k,I.$,Function])],F)},17953:(e,t,i)=>{"use strict";i.d(t,{b:()=>b});var n,a=i(58632),s=i(7672),o=i(4474),r=i(69239),l=i(68628),d=i(23999),c=i(2668),u=i(82970),p=i(9543),g=i(35572),h=i(8536),m=i(27042),v=i(55099),f=i(26325);!function(e){e[e.NotAvailable=0]="NotAvailable",e[e.Start=1]="Start",e[e.Error=2]="Error",e[e.Succeeded=3]="Succeeded"}(n||(n={}));let b=class{constructor(e){this.fetch=e,this.retryTime=0,this.hasMore$=new r.B,this.options$=new r.B,this.init$=this.options$.pipe((0,g.p)((e=>{let t,n;return(0,l.H)(Promise.all([i.e(4563),i.e(3305),i.e(6706),i.e(8904),i.e(1960),i.e(4835),i.e(6483),i.e(759),i.e(4685),i.e(694),i.e(4714),i.e(1377),i.e(1798)]).then(i.bind(i,15226)).then((i=>{const{im_proto:a,ExtensionPlugin:s,StrangerPlugin:o,MultimediaPlugin:r,MetricsPlugin:l}=i;return e.authType=a.AuthType.SESSION_AUTH,n=i,t=new n.BytedIM(e,[s,o,r,l]),this.instance=t,this.sdk=n,t.init()})).then((i=>({result:i,instance:t,sdk:n,options:e}))).catch((i=>(console.error(`[IM SDK] init failed, e=${i}`),{result:2,instance:t,sdk:n,options:e}))))})),(0,h.Z)((({result:e,instance:t,sdk:i,options:n})=>{const a=[i.IMEvent.ConversationChange,i.IMEvent.MessageSend,i.IMEvent.ReceiveNewMessage,i.IMEvent.MessageDelete,i.IMEvent.MessagePropertyUpsert,i.IMEvent.RefreshMessage,i.IMEvent.MessageUpsert];return t?(a.forEach((e=>{t.event.subscribe(e,(t=>{var a;n.eventListener({event:e,params:t,sdk:i,uid:null!==(a=n.userId)&&void 0!==a?a:""})}))})),(0,d.of)({instance:t,sdk:i,options:n})):(0,c.$)((()=>new Error(`[IM SDK] init failed with initResult=${e}`)))}))),this.refreshMessage$=(0,u.z)([this.init$,(0,p.Y)(360)]).pipe((0,h.Z)((([{instance:e,sdk:t,options:i}])=>(0,l.H)(e.getMessagesByUserInit({inboxType:0,cursor:this.cursor}).then((({hasMore:e,cursor:n=0})=>{var a;return this.cursor=n.toString(),0===this.refreshTime&&i.eventListener({event:t.IMEvent.ConversationChange,params:{},sdk:t,uid:null!==(a=null==i?void 0:i.userId)&&void 0!==a?a:""}),this.refreshTime++,e})).catch((e=>(console.error(e),!(this.retryTime++>5))))))),(0,m.v)((e=>e))),this.cursor="0",this.refreshTime=0,this.instance={},this.sdk={}}getMessageToken(){return this.fetch.get("/api/im/reboot/misc/",{query:{aid:1988,im_token:1},baseUrlType:2})}getConversationListOnline(e){var t,i;return(0,l.H)(null===(i=(t=this.instance).getConversationListOnline)||void 0===i?void 0:i.call(t,{filter:e}))}getStrangerConversationList({cursor:e,limit:t}){var i,n;return(0,l.H)(null===(n=(i=this.instance).getStrangerConversationList)||void 0===n?void 0:n.call(i,{cursor:e,limit:t}))}createConversation({uid:e}){var t,i;return(0,l.H)(null===(i=(t=this.instance).createConversation)||void 0===i?void 0:i.call(t,{participants:e}))}createMessage({type:e,content:t,conversation:i,fileInfo:n}){var a,s,o,r;let d;if(n){const{fileType:t,fileHandler:o,width:r,height:l,onUploadProcess:c,onUploadComplete:u,onUploadError:p}=n,g=t.startsWith("image");d=null===(s=(a=this.instance).createFileMessage)||void 0===s?void 0:s.call(a,{conversation:i,type:e,content:'{"hack":"1"}',fileInfo:{type:g?"image":"video",fileHandler:o,displayType:"media",encrypt:!0,imagePreviewWidth:r,imagePreviewHeight:l,ext:g?{}:{"s:file_ext_key_video_width":`${r||0}`,"s:file_ext_key_video_height":`${l||0}`},onUploadProcess:e=>{d.then((t=>{null==c||c(t.clientId,e)}))},onUploadComplete:e=>{d.then((t=>{null==u||u(t.clientId,e)}))},onUploadError:e=>{d.then((t=>{null==p||p(t.clientId,e)}))}},scene:"private_"+(g?"image":"video")})}else d=null===(r=(o=this.instance).createMessage)||void 0===r?void 0:r.call(o,{conversation:i,type:e,content:t});return(0,l.H)(d)}sendMessage({message:e}){var t,i;return(0,l.H)(null===(i=(t=this.instance).sendMessage)||void 0===i?void 0:i.call(t,{message:e}))}setConversationSettingInfo({conversation:e,mute:t,stickOnTop:i}){var n,a;return(0,l.H)(null===(a=(n=this.instance).setConversationSettingInfo)||void 0===a?void 0:a.call(n,{conversation:e,mute:t,stickOnTop:i}))}deleteConversation({conversation:e}){var t,i;return(0,l.H)(null===(i=(t=this.instance).deleteConversation)||void 0===i?void 0:i.call(t,{conversation:e}))}deleteStrangerConversation({conversation:e}){var t,i;return(0,l.H)(null===(i=(t=this.instance).deleteStrangerConversation)||void 0===i?void 0:i.call(t,{conversation:e}))}markConversationRead({conversation:e}){var t,i;return(0,l.H)(null===(i=(t=this.instance).markConversationRead)||void 0===i?void 0:i.call(t,{conversation:e}))}markStrangerConversationRead({conversation:e}){var t,i;return(0,l.H)(null===(i=(t=this.instance).markStrangerConversationRead)||void 0===i?void 0:i.call(t,{conversation:e}))}getStrangerPreview(){var e,t;return(0,l.H)(null===(t=(e=this.instance).getStrangerPreview)||void 0===t?void 0:t.call(e,{}))}getMessagesByConversation({conversation:e}){var t,i;return(0,l.H)(null===(i=(t=this.instance).getMessagesByConversation)||void 0===i?void 0:i.call(t,{conversation:e}))}getStrangerConversationMessage({conversation:e}){var t,i;return(0,l.H)(null===(i=(t=this.instance).getStrangerConversationMessage)||void 0===i?void 0:i.call(t,{conversation:e}))}deleteMessage({message:e}){var t,i;return(0,l.H)(null===(i=(t=this.instance).deleteMessage)||void 0===i?void 0:i.call(t,{message:e}))}modifyMessageProperty({message:e,isLiked:t}){var i,n;return(0,l.H)(null===(n=(i=this.instance).modifyMessageProperty)||void 0===n?void 0:n.call(i,{message:e,modifyContent:[{operation:t?this.sdk.im_proto.OPERATION_TYPE.REMOVE_PROPERTY_ITEM:this.sdk.im_proto.OPERATION_TYPE.ADD_PROPERTY_ITEM,key:"e:love"}]}))}getMultiUsersByUids(e){return this.fetch.get("/api/im/multi_user/",{query:{aid:1988,uids:e},baseUrlType:2})}getFollowingUserListWithCanShare(e){const{minCursor:t=0,count:i=30}=e;return this.fetch.get("/api/im/spotlight/relation/",{query:{source:"web",with_fstatus:1,device_platform:"webapp_pc",count:i,max_time:t,min_time:0},baseUrlType:2})}getMultiUsersRelation({to_user_id:e,userId:t}){return this.fetch.get("/api/im/spotlight/multi_relation/",{query:{to_user_id:e,userId:t},baseUrlType:2})}feedbackMessage({shortId:e,uid:t,content:i,messageId:n,messageType:a}){const s=o.stringify({con_short_id:e,receiver_uid:t,content:i,msg_type:`${a}`,scene:"sending_ban",msg_id:n});return this.fetch.post("/aweme/v1/im/msg/feedback/",{query:{report_type:"im",appId:1233},headers:{"Content-Type":f.Ty.FORM_ENCODE},body:s})}getItemInfo(e,t){return this.fetch.get("/api/im/item_detail/",{query:{itemId:e,coverFormat:t},baseUrlType:2})}decryptMedia({message:e,fetchIndex:t}){var i,n;return(0,l.H)(null===(n=(i=this.instance).decryptMedia)||void 0===n?void 0:n.call(i,{message:e,fetchIndex:t}))}getConversationByMessage({message:e}){return(0,d.of)(this.instance.getConversation({conversationId:e.conversationId}))}getMessages({messages:e,conversation:t,upsert:i}){return(0,l.H)(this.instance.getMessages({messages:e,conversation:t,upsert:i}))}};b=(0,a.__decorate)([(0,s._)(),(0,a.__metadata)("design:paramtypes",[v.p])],b)},60212:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var n,a=i(58632),s=i(7672),o=i(11654);!function(e){e.SendMediaFail="send_media_fail",e.LoadMediaFail="load_media_fail",e.ModerationTimeout="moderation_timeout"}(n||(n={}));let r=class{constructor(e){this._defaultMetrics={count:1},this.handleSendMediaFail=e=>{this._service.emitEvent(n.SendMediaFail,this._defaultMetrics,Object.assign(Object.assign({},e),{relation_tag:`${e.relation_tag}`,status_code:`${e.status_code}`}))},this.handleLoadMediaFail=e=>{this._service.emitEvent(n.LoadMediaFail,this._defaultMetrics,Object.assign(Object.assign({},e),{media_type:`${e.media_type}`}))},this.handleMediaModerationTimeout=e=>{this._service.emitEvent(n.ModerationTimeout,this._defaultMetrics,Object.assign(Object.assign({},e),{media_type:`${e.media_type}`}))},this._service=e}};r=(0,a.__decorate)([(0,s._)(),(0,a.__metadata)("design:paramtypes",[o.V$])],r)},38597:(e,t,i)=>{"use strict";i.d(t,{h:()=>a});var n=i(93608);const a={handleBlockShow:e=>{n.f.sendEvent("tns_webapp_block_show",{type:e?"block":"unblock"})},handleBlockClick:e=>{n.f.sendEvent("tns_webapp_block_click",{type:e?"block":"unblock"})},handleBlock:(e,t)=>{n.f.sendEvent(t?"block":"unblock",e)}}},27988:(e,t,i)=>{var n={"./af/index.es.js":[49990,4563],"./ar/index.es.js":[70338,4563],"./az/index.es.js":[20525,4563],"./bg/index.es.js":[81326,4563],"./bn/index.es.js":[74607,4563],"./ca/index.es.js":[1751,4563],"./ceb/index.es.js":[45443,4563],"./cs/index.es.js":[55953,4563],"./da/index.es.js":[50174,4563],"./de/index.es.js":[82474,4563],"./el/index.es.js":[45460,4563],"./en-GB/index.es.js":[36508,4563],"./en/index.es.js":[10914,4563],"./es-419/index.es.js":[33166,4563],"./es/index.es.js":[62903,4563],"./et/index.es.js":[18108,4563],"./fi/index.es.js":[87184,4563],"./fil/index.es.js":[60740,4563],"./fr-CA/index.es.js":[18876,4563],"./fr/index.es.js":[65471,4563],"./ga/index.es.js":[46787,4563],"./gu/index.es.js":[57303,4563],"./he/index.es.js":[31886,4563],"./hi/index.es.js":[39778,4563],"./hr/index.es.js":[7373,4563],"./hu/index.es.js":[3774,4563],"./id/index.es.js":[54048,4563],"./is/index.es.js":[42947,4563],"./it/index.es.js":[81648,4563],"./ja/index.es.js":[85988,4563],"./jv/index.es.js":[86031,4563],"./kk/index.es.js":[42865,4563],"./km/index.es.js":[49859,4563],"./kn/index.es.js":[86732,4563],"./ko/index.es.js":[82621,4563],"./lt/index.es.js":[62152,4563],"./lv/index.es.js":[49301,4563],"./ml/index.es.js":[29532,4563],"./mr/index.es.js":[42550,4563],"./ms/index.es.js":[64143,4563],"./my/index.es.js":[28529,4563],"./nb/index.es.js":[53959,4563],"./nl/index.es.js":[29829,4563],"./or/index.es.js":[96436,4563],"./pa/index.es.js":[53458,4563],"./pl/index.es.js":[40535,4563],"./pt-BR/index.es.js":[1744,4563],"./pt-PT/index.es.js":[98216,4563],"./pt/index.es.js":[23951,4563],"./ro/index.es.js":[26534,4563],"./ru/index.es.js":[53456,4563],"./sk/index.es.js":[16953,4563],"./sl/index.es.js":[39810,4563],"./sq/index.es.js":[7223,4563],"./sv/index.es.js":[48156,4563],"./sw/index.es.js":[19533,4563],"./ta/index.es.js":[81806,4563],"./te/index.es.js":[83802,4563],"./th/index.es.js":[89916,4563],"./tr/index.es.js":[52801,4563],"./uk/index.es.js":[9855,4563],"./ur/index.es.js":[15118,4563],"./uz/index.es.js":[50678,4563],"./vi/index.es.js":[48480,4563],"./zh-Hans/index.es.js":[24850,4563],"./zh-Hant/index.es.js":[49065,4563]};function a(e){if(!i.o(n,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],a=t[0];return i.e(t[1]).then((()=>i(a)))}a.keys=()=>Object.keys(n),a.id=27988,e.exports=a}}]);